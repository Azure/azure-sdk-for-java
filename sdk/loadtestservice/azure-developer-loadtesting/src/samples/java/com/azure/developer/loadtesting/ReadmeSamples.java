// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.developer.loadtesting;

import java.io.File;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

import com.azure.core.http.rest.Response;
import com.azure.core.util.BinaryData;
import com.azure.identity.DefaultAzureCredentialBuilder;

public final class ReadmeSamples {
    public void createTest() {
        // BEGIN: java-readme-sample-createTest
        LoadTestingClient client = new LoadTestingClientBuilder()
            .credential(new DefaultAzureCredentialBuilder().build())
            .endpoint("<endpoint>")
            .buildClient();

        Map<String, Object> testMap = new HashMap<String, Object>();
        testMap.put("displayName", "Sample Display Name");
        testMap.put("description", "Sample Description");

        Map<String, Object> loadTestConfigMap = new HashMap<String, Object>();
        loadTestConfigMap.put("engineInstances", 1);
        testMap.put("loadTestConfig", loadTestConfigMap);

        Map<String, Object> envVarMap = new HashMap<String, Object>();
        envVarMap.put("a", "b");
        envVarMap.put("x", "y");
        testMap.put("environmentVariables", envVarMap);

        BinaryData test = BinaryData.fromObject(testMap);

        Response<BinaryData> testOutResponse = client.getAdministration().createOrUpdateTestWithResponse("test12345", test, null);
        System.out.println(testOutResponse.getValue().toString());
        // END: java-readme-sample-createTest
    }

    public void uploadTestFile() throws IOException {
        // BEGIN: java-readme-sample-uploadTestFile
        LoadTestingClient client = new LoadTestingClientBuilder()
            .credential(new DefaultAzureCredentialBuilder().build())
            .endpoint("<endpoint>")
            .buildClient();

        BinaryData fileData = BinaryData.fromFile(new File("path/to/file").toPath());
        Response<BinaryData> fileUrlOut = client.getAdministration().uploadTestFileWithResponse("test12345", "file12345", "sample-file.jmx", fileData, null);
        System.out.println(fileUrlOut.getValue().toString());
        // END: java-readme-sample-uploadTestFile
    }

    public void runTest() {
        // BEGIN: java-readme-sample-runTest
        LoadTestingClient client = new LoadTestingClientBuilder()
            .credential(new DefaultAzureCredentialBuilder().build())
            .endpoint("<endpoint>")
            .buildClient();

        Map<String, Object> testRunMap = new HashMap<String, Object>();
        testRunMap.put("testId", "test12345");
        testRunMap.put("displayName", "SDK-Created-TestRun");

        Map<String, Object> loadTestConfigMap = new HashMap<String, Object>();
        loadTestConfigMap.put("engineInstances", 2);
        testRunMap.put("loadTestConfig", loadTestConfigMap);

        BinaryData testRun = BinaryData.fromObject(testRunMap);

        Response<BinaryData> testRunOut = client.getTestRun().createAndUpdateTestRunWithResponse("testrun12345", testRun, null);
        System.out.println(testRunOut.getValue().toString());
        // END: java-readme-sample-runTest
    }
}
