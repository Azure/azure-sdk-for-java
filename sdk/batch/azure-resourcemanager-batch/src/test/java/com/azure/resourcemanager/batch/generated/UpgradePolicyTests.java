// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.batch.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.batch.models.AutomaticOSUpgradePolicy;
import com.azure.resourcemanager.batch.models.RollingUpgradePolicy;
import com.azure.resourcemanager.batch.models.UpgradeMode;
import com.azure.resourcemanager.batch.models.UpgradePolicy;
import org.junit.jupiter.api.Assertions;

public final class UpgradePolicyTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        UpgradePolicy model = BinaryData.fromString(
            "{\"mode\":\"automatic\",\"automaticOSUpgradePolicy\":{\"disableAutomaticRollback\":false,\"enableAutomaticOSUpgrade\":false,\"useRollingUpgradePolicy\":false,\"osRollingUpgradeDeferral\":false},\"rollingUpgradePolicy\":{\"enableCrossZoneUpgrade\":false,\"maxBatchInstancePercent\":1764475997,\"maxUnhealthyInstancePercent\":1174017685,\"maxUnhealthyUpgradedInstancePercent\":1680525224,\"pauseTimeBetweenBatches\":\"hqamvdkf\",\"prioritizeUnhealthyInstances\":true,\"rollbackFailedInstancesOnPolicyBreach\":false}}")
            .toObject(UpgradePolicy.class);
        Assertions.assertEquals(UpgradeMode.AUTOMATIC, model.mode());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().disableAutomaticRollback());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().enableAutomaticOSUpgrade());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().useRollingUpgradePolicy());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().osRollingUpgradeDeferral());
        Assertions.assertFalse(model.rollingUpgradePolicy().enableCrossZoneUpgrade());
        Assertions.assertEquals(1764475997, model.rollingUpgradePolicy().maxBatchInstancePercent());
        Assertions.assertEquals(1174017685, model.rollingUpgradePolicy().maxUnhealthyInstancePercent());
        Assertions.assertEquals(1680525224, model.rollingUpgradePolicy().maxUnhealthyUpgradedInstancePercent());
        Assertions.assertEquals("hqamvdkf", model.rollingUpgradePolicy().pauseTimeBetweenBatches());
        Assertions.assertTrue(model.rollingUpgradePolicy().prioritizeUnhealthyInstances());
        Assertions.assertFalse(model.rollingUpgradePolicy().rollbackFailedInstancesOnPolicyBreach());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        UpgradePolicy model = new UpgradePolicy().withMode(UpgradeMode.AUTOMATIC)
            .withAutomaticOSUpgradePolicy(new AutomaticOSUpgradePolicy().withDisableAutomaticRollback(false)
                .withEnableAutomaticOSUpgrade(false)
                .withUseRollingUpgradePolicy(false)
                .withOsRollingUpgradeDeferral(false))
            .withRollingUpgradePolicy(new RollingUpgradePolicy().withEnableCrossZoneUpgrade(false)
                .withMaxBatchInstancePercent(1764475997)
                .withMaxUnhealthyInstancePercent(1174017685)
                .withMaxUnhealthyUpgradedInstancePercent(1680525224)
                .withPauseTimeBetweenBatches("hqamvdkf")
                .withPrioritizeUnhealthyInstances(true)
                .withRollbackFailedInstancesOnPolicyBreach(false));
        model = BinaryData.fromObject(model).toObject(UpgradePolicy.class);
        Assertions.assertEquals(UpgradeMode.AUTOMATIC, model.mode());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().disableAutomaticRollback());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().enableAutomaticOSUpgrade());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().useRollingUpgradePolicy());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().osRollingUpgradeDeferral());
        Assertions.assertFalse(model.rollingUpgradePolicy().enableCrossZoneUpgrade());
        Assertions.assertEquals(1764475997, model.rollingUpgradePolicy().maxBatchInstancePercent());
        Assertions.assertEquals(1174017685, model.rollingUpgradePolicy().maxUnhealthyInstancePercent());
        Assertions.assertEquals(1680525224, model.rollingUpgradePolicy().maxUnhealthyUpgradedInstancePercent());
        Assertions.assertEquals("hqamvdkf", model.rollingUpgradePolicy().pauseTimeBetweenBatches());
        Assertions.assertTrue(model.rollingUpgradePolicy().prioritizeUnhealthyInstances());
        Assertions.assertFalse(model.rollingUpgradePolicy().rollbackFailedInstancesOnPolicyBreach());
    }
}
