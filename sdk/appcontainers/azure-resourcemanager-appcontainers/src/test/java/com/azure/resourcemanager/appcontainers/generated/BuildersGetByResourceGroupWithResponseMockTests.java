// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.appcontainers.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.appcontainers.ContainerAppsApiManager;
import com.azure.resourcemanager.appcontainers.models.BuilderResource;
import com.azure.resourcemanager.appcontainers.models.ManagedServiceIdentityType;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class BuildersGetByResourceGroupWithResponseMockTests {
    @Test
    public void testGetByResourceGroupWithResponse() throws Exception {
        String responseStr
            = "{\"properties\":{\"provisioningState\":\"Failed\",\"environmentId\":\"mmdqgmihzpimc\",\"containerRegistries\":[{\"containerRegistryServer\":\"nxtminklog\",\"identityResourceId\":\"svtzarhzv\"},{\"containerRegistryServer\":\"nsqktc\",\"identityResourceId\":\"bjwzzos\"}]},\"identity\":{\"principalId\":\"ecbafe51-5827-42fa-803e-a2a601daca48\",\"tenantId\":\"2385d766-3557-4f60-ab1d-2a310e25758f\",\"type\":\"SystemAssigned,UserAssigned\",\"userAssignedIdentities\":{\"kzpgaj\":{\"principalId\":\"7bf2593e-4857-4036-9980-3d3e1610b95b\",\"clientId\":\"898a5c3c-9b19-4c0f-b9c2-1ace3214e886\"},\"cemqbmfuvqarwz\":{\"principalId\":\"60849fea-dfe8-444c-9689-6c84785be827\",\"clientId\":\"6de53dcc-2ec1-4498-b925-1f410b0ac3e0\"},\"rebluimmbwxsf\":{\"principalId\":\"0efebb13-9413-433a-8f55-506bf6ec83ef\",\"clientId\":\"e8f467ae-401d-4f07-851b-fa138c836fcf\"}}},\"location\":\"dmbvxekraok\",\"tags\":{\"twaokb\":\"ud\",\"sm\":\"vlyttaaknwfrke\"},\"id\":\"p\",\"name\":\"ujd\",\"type\":\"gatolekscbctnan\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        ContainerAppsApiManager manager = ContainerAppsApiManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        BuilderResource response = manager.builders()
            .getByResourceGroupWithResponse("rlhgenuze", "gvkvebaqszll", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("dmbvxekraok", response.location());
        Assertions.assertEquals("ud", response.tags().get("twaokb"));
        Assertions.assertEquals(ManagedServiceIdentityType.SYSTEM_ASSIGNED_USER_ASSIGNED, response.identity().type());
        Assertions.assertEquals("mmdqgmihzpimc", response.environmentId());
        Assertions.assertEquals("nxtminklog", response.containerRegistries().get(0).containerRegistryServer());
        Assertions.assertEquals("svtzarhzv", response.containerRegistries().get(0).identityResourceId());
    }
}
