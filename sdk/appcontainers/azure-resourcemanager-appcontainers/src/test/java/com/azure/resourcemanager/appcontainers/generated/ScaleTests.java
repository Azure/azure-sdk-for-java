// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.appcontainers.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.appcontainers.models.CustomScaleRule;
import com.azure.resourcemanager.appcontainers.models.HttpScaleRule;
import com.azure.resourcemanager.appcontainers.models.QueueScaleRule;
import com.azure.resourcemanager.appcontainers.models.Scale;
import com.azure.resourcemanager.appcontainers.models.ScaleRule;
import com.azure.resourcemanager.appcontainers.models.TcpScaleRule;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public final class ScaleTests {
    @Test
    public void testDeserialize() {
        Scale model =
            BinaryData
                .fromString(
                    "{\"minReplicas\":277220596,\"maxReplicas\":1475802306,\"rules\":[{\"name\":\"pxllrx\",\"azureQueue\":{\"queueName\":\"moadsuvarmy\",\"queueLength\":1450729079,\"auth\":[]},\"custom\":{\"type\":\"q\",\"metadata\":{},\"auth\":[]},\"http\":{\"metadata\":{},\"auth\":[]},\"tcp\":{\"metadata\":{},\"auth\":[]}},{\"name\":\"yc\",\"azureQueue\":{\"queueName\":\"hp\",\"queueLength\":1622537719,\"auth\":[]},\"custom\":{\"type\":\"areqna\",\"metadata\":{},\"auth\":[]},\"http\":{\"metadata\":{},\"auth\":[]},\"tcp\":{\"metadata\":{},\"auth\":[]}}]}")
                .toObject(Scale.class);
        Assertions.assertEquals(277220596, model.minReplicas());
        Assertions.assertEquals(1475802306, model.maxReplicas());
        Assertions.assertEquals("pxllrx", model.rules().get(0).name());
        Assertions.assertEquals("moadsuvarmy", model.rules().get(0).azureQueue().queueName());
        Assertions.assertEquals(1450729079, model.rules().get(0).azureQueue().queueLength());
        Assertions.assertEquals("q", model.rules().get(0).custom().type());
    }

    @Test
    public void testSerialize() {
        Scale model =
            new Scale()
                .withMinReplicas(277220596)
                .withMaxReplicas(1475802306)
                .withRules(
                    Arrays
                        .asList(
                            new ScaleRule()
                                .withName("pxllrx")
                                .withAzureQueue(
                                    new QueueScaleRule()
                                        .withQueueName("moadsuvarmy")
                                        .withQueueLength(1450729079)
                                        .withAuth(Arrays.asList()))
                                .withCustom(
                                    new CustomScaleRule().withType("q").withMetadata(mapOf()).withAuth(Arrays.asList()))
                                .withHttp(new HttpScaleRule().withMetadata(mapOf()).withAuth(Arrays.asList()))
                                .withTcp(new TcpScaleRule().withMetadata(mapOf()).withAuth(Arrays.asList())),
                            new ScaleRule()
                                .withName("yc")
                                .withAzureQueue(
                                    new QueueScaleRule()
                                        .withQueueName("hp")
                                        .withQueueLength(1622537719)
                                        .withAuth(Arrays.asList()))
                                .withCustom(
                                    new CustomScaleRule()
                                        .withType("areqna")
                                        .withMetadata(mapOf())
                                        .withAuth(Arrays.asList()))
                                .withHttp(new HttpScaleRule().withMetadata(mapOf()).withAuth(Arrays.asList()))
                                .withTcp(new TcpScaleRule().withMetadata(mapOf()).withAuth(Arrays.asList()))));
        model = BinaryData.fromObject(model).toObject(Scale.class);
        Assertions.assertEquals(277220596, model.minReplicas());
        Assertions.assertEquals(1475802306, model.maxReplicas());
        Assertions.assertEquals("pxllrx", model.rules().get(0).name());
        Assertions.assertEquals("moadsuvarmy", model.rules().get(0).azureQueue().queueName());
        Assertions.assertEquals(1450729079, model.rules().get(0).azureQueue().queueLength());
        Assertions.assertEquals("q", model.rules().get(0).custom().type());
    }

    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
