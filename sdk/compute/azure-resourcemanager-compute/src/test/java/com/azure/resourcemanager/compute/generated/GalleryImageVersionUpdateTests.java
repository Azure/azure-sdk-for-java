// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.compute.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.compute.models.AdditionalReplicaSet;
import com.azure.resourcemanager.compute.models.DataDiskImageEncryption;
import com.azure.resourcemanager.compute.models.EdgeZoneStorageAccountType;
import com.azure.resourcemanager.compute.models.EncryptionImages;
import com.azure.resourcemanager.compute.models.GalleryArtifactVersionFullSource;
import com.azure.resourcemanager.compute.models.GalleryDataDiskImage;
import com.azure.resourcemanager.compute.models.GalleryDiskImageSource;
import com.azure.resourcemanager.compute.models.GalleryExtendedLocation;
import com.azure.resourcemanager.compute.models.GalleryExtendedLocationType;
import com.azure.resourcemanager.compute.models.GalleryImageVersionPublishingProfile;
import com.azure.resourcemanager.compute.models.GalleryImageVersionSafetyProfile;
import com.azure.resourcemanager.compute.models.GalleryImageVersionStorageProfile;
import com.azure.resourcemanager.compute.models.GalleryImageVersionUefiSettings;
import com.azure.resourcemanager.compute.models.GalleryImageVersionUpdate;
import com.azure.resourcemanager.compute.models.GalleryOSDiskImage;
import com.azure.resourcemanager.compute.models.GalleryTargetExtendedLocation;
import com.azure.resourcemanager.compute.models.HostCaching;
import com.azure.resourcemanager.compute.models.ImageVersionSecurityProfile;
import com.azure.resourcemanager.compute.models.OSDiskImageEncryption;
import com.azure.resourcemanager.compute.models.ReplicationMode;
import com.azure.resourcemanager.compute.models.StorageAccountStrategy;
import com.azure.resourcemanager.compute.models.StorageAccountType;
import com.azure.resourcemanager.compute.models.TargetRegion;
import com.azure.resourcemanager.compute.models.UefiKey;
import com.azure.resourcemanager.compute.models.UefiKeySignatures;
import com.azure.resourcemanager.compute.models.UefiKeyType;
import com.azure.resourcemanager.compute.models.UefiSignatureTemplateName;
import java.time.OffsetDateTime;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import org.junit.jupiter.api.Assertions;

public final class GalleryImageVersionUpdateTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        GalleryImageVersionUpdate model = BinaryData.fromString(
            "{\"properties\":{\"publishingProfile\":{\"targetRegions\":[{\"name\":\"aqpqifdbm\",\"regionalReplicaCount\":947190230,\"storageAccountType\":\"PremiumV2_LRS\",\"encryption\":{\"osDiskImage\":{},\"dataDiskImages\":[{\"lun\":1638013744},{\"lun\":552181148},{\"lun\":1210507560}]},\"excludeFromLatest\":true,\"additionalReplicaSets\":[{}]},{\"name\":\"niz\",\"regionalReplicaCount\":8718366,\"storageAccountType\":\"PremiumV2_LRS\",\"encryption\":{\"osDiskImage\":{},\"dataDiskImages\":[{\"lun\":926112265},{\"lun\":508548602},{\"lun\":1289621459}]},\"excludeFromLatest\":true,\"additionalReplicaSets\":[{},{},{},{}]}],\"replicaCount\":80016871,\"excludeFromLatest\":true,\"publishedDate\":\"2021-05-18T13:05:41Z\",\"endOfLifeDate\":\"2021-04-25T04:01:32Z\",\"storageAccountType\":\"Standard_LRS\",\"replicationMode\":\"Shallow\",\"targetExtendedLocations\":[{\"name\":\"iceovxgzw\",\"extendedLocation\":{\"name\":\"yrujm\",\"type\":\"EdgeZone\"},\"extendedLocationReplicaCount\":239861604,\"storageAccountType\":\"Standard_LRS\",\"encryption\":{\"osDiskImage\":{},\"dataDiskImages\":[{\"lun\":699381711},{\"lun\":373062326},{\"lun\":1395773905}]}},{\"name\":\"qhfnkvycqqqds\",\"extendedLocation\":{\"name\":\"nquwzxhrptyodl\",\"type\":\"EdgeZone\"},\"extendedLocationReplicaCount\":2096879897,\"storageAccountType\":\"Standard_LRS\",\"encryption\":{\"osDiskImage\":{},\"dataDiskImages\":[{\"lun\":936776493},{\"lun\":1009463394}]}},{\"name\":\"pnouhbqezkqx\",\"extendedLocation\":{\"name\":\"uzyigfcvcewbwqhd\",\"type\":\"EdgeZone\"},\"extendedLocationReplicaCount\":593860057,\"storageAccountType\":\"Standard_ZRS\",\"encryption\":{\"osDiskImage\":{},\"dataDiskImages\":[{\"lun\":1383836844},{\"lun\":561691289},{\"lun\":1384544279}]}}],\"storageAccountStrategy\":\"PreferStandard_ZRS\"},\"provisioningState\":\"Deleting\",\"storageProfile\":{\"source\":{\"communityGalleryImageId\":\"qmr\",\"virtualMachineId\":\"parn\",\"id\":\"grszrbwtdrcwg\"},\"osDiskImage\":{\"sizeInGB\":819698,\"hostCaching\":\"None\",\"source\":{\"uri\":\"hfixa\",\"storageAccountId\":\"c\",\"id\":\"zjrmhpfywvyld\"}},\"dataDiskImages\":[{\"lun\":1707361059,\"sizeInGB\":1307569483,\"hostCaching\":\"ReadOnly\",\"source\":{\"uri\":\"nunjlzkdr\",\"storageAccountId\":\"qsxytqqtcmiw\",\"id\":\"is\"}},{\"lun\":1763763526,\"sizeInGB\":1548486628,\"hostCaching\":\"ReadWrite\",\"source\":{\"uri\":\"amcajyhftpzcrryk\",\"storageAccountId\":\"eynq\",\"id\":\"hkigglclwalhvub\"}},{\"lun\":1989222315,\"sizeInGB\":1884703702,\"hostCaching\":\"ReadWrite\",\"source\":{\"uri\":\"dqcmyctaj\",\"storageAccountId\":\"jvalecxbibiw\",\"id\":\"degyxsbfpzvo\"}},{\"lun\":103195865,\"sizeInGB\":1243506179,\"hostCaching\":\"None\",\"source\":{\"uri\":\"fzwush\",\"storageAccountId\":\"xpblalh\",\"id\":\"zpfkis\"}}]},\"safetyProfile\":{\"reportedForPolicyViolation\":true,\"policyViolations\":[{\"category\":\"ImageFlaggedUnsafe\",\"details\":\"oqdsg\"},{\"category\":\"IpTheft\",\"details\":\"xjqfiafcnlrtbfi\"},{\"category\":\"Other\",\"details\":\"aoijolb\"},{\"category\":\"IpTheft\",\"details\":\"twieopexelxqdwr\"}],\"blockDeletionBeforeEndOfLife\":false,\"allowDeletionOfReplicatedLocations\":true},\"replicationStatus\":{\"aggregatedState\":\"Completed\",\"summary\":[{\"region\":\"xyxyaux\",\"state\":\"Failed\",\"details\":\"obmc\",\"progress\":1238631626},{\"region\":\"wytkujsqy\",\"state\":\"Replicating\",\"details\":\"xfabl\",\"progress\":115043021},{\"region\":\"bmwhrialiwr\",\"state\":\"Replicating\",\"details\":\"wplrrbphc\",\"progress\":520649620}]},\"securityProfile\":{\"uefiSettings\":{\"signatureTemplateNames\":[\"MicrosoftWindowsTemplate\",\"MicrosoftWindowsTemplate\",\"MicrosoftWindowsTemplate\"],\"additionalSignatures\":{\"pk\":{\"type\":\"x509\",\"value\":[\"pbfs\",\"eqbbewfcuqfpy\",\"xmzrmtmvwitu\",\"eyyjshcybwfuppox\"]},\"kek\":[{},{},{},{}],\"db\":[{}],\"dbx\":[{},{}]}}},\"restore\":true,\"validationsProfile\":{\"validationEtag\":\"iikmoxrezsvavlrx\",\"executedValidations\":[{\"type\":\"oywlunpipcwyb\",\"status\":\"Failed\",\"version\":\"cnpatpft\",\"executionTime\":\"2021-04-06T00:18:18Z\"},{\"type\":\"wf\",\"status\":\"Unknown\",\"version\":\"rpwa\",\"executionTime\":\"2021-06-16T08:15:31Z\"},{\"type\":\"ugexojfccylht\",\"status\":\"Succeeded\",\"version\":\"vazjpwexcd\",\"executionTime\":\"2021-01-15T06:48:17Z\"},{\"type\":\"o\",\"status\":\"Unknown\",\"version\":\"ezmnrkjgpjeuxsph\",\"executionTime\":\"2021-08-21T01:30:20Z\"}],\"platformAttributes\":[{\"name\":\"ijpdvzvfbhwbdquf\",\"value\":\"gnrglaqrwyamb\"},{\"name\":\"afebzxfkjq\",\"value\":\"ibhlenntrv\"}]}},\"id\":\"psabdu\",\"name\":\"zmlghny\",\"type\":\"lpyeu\",\"tags\":{\"hyqqegatxgr\":\"pdixqbolxv\"}}")
            .toObject(GalleryImageVersionUpdate.class);
        Assertions.assertEquals("pdixqbolxv", model.tags().get("hyqqegatxgr"));
        Assertions.assertEquals("aqpqifdbm", model.publishingProfile().targetRegions().get(0).name());
        Assertions.assertEquals(947190230, model.publishingProfile().targetRegions().get(0).regionalReplicaCount());
        Assertions.assertEquals(StorageAccountType.PREMIUM_V2_LRS,
            model.publishingProfile().targetRegions().get(0).storageAccountType());
        Assertions.assertEquals(1638013744,
            model.publishingProfile().targetRegions().get(0).encryption().dataDiskImages().get(0).lun());
        Assertions.assertTrue(model.publishingProfile().targetRegions().get(0).excludeFromLatest());
        Assertions.assertEquals(80016871, model.publishingProfile().replicaCount());
        Assertions.assertTrue(model.publishingProfile().excludeFromLatest());
        Assertions.assertEquals(OffsetDateTime.parse("2021-04-25T04:01:32Z"),
            model.publishingProfile().endOfLifeDate());
        Assertions.assertEquals(StorageAccountType.STANDARD_LRS, model.publishingProfile().storageAccountType());
        Assertions.assertEquals(ReplicationMode.SHALLOW, model.publishingProfile().replicationMode());
        Assertions.assertEquals("iceovxgzw", model.publishingProfile().targetExtendedLocations().get(0).name());
        Assertions.assertEquals("yrujm",
            model.publishingProfile().targetExtendedLocations().get(0).extendedLocation().name());
        Assertions.assertEquals(GalleryExtendedLocationType.EDGE_ZONE,
            model.publishingProfile().targetExtendedLocations().get(0).extendedLocation().type());
        Assertions.assertEquals(239861604,
            model.publishingProfile().targetExtendedLocations().get(0).extendedLocationReplicaCount());
        Assertions.assertEquals(EdgeZoneStorageAccountType.STANDARD_LRS,
            model.publishingProfile().targetExtendedLocations().get(0).storageAccountType());
        Assertions.assertEquals(699381711,
            model.publishingProfile().targetExtendedLocations().get(0).encryption().dataDiskImages().get(0).lun());
        Assertions.assertEquals(StorageAccountStrategy.PREFER_STANDARD_ZRS,
            model.publishingProfile().storageAccountStrategy());
        Assertions.assertEquals("grszrbwtdrcwg", model.storageProfile().source().id());
        Assertions.assertEquals("qmr", model.storageProfile().source().communityGalleryImageId());
        Assertions.assertEquals("parn", model.storageProfile().source().virtualMachineId());
        Assertions.assertEquals(HostCaching.NONE, model.storageProfile().osDiskImage().hostCaching());
        Assertions.assertEquals("zjrmhpfywvyld", model.storageProfile().osDiskImage().source().id());
        Assertions.assertEquals("hfixa", model.storageProfile().osDiskImage().source().uri());
        Assertions.assertEquals("c", model.storageProfile().osDiskImage().source().storageAccountId());
        Assertions.assertEquals(HostCaching.READ_ONLY, model.storageProfile().dataDiskImages().get(0).hostCaching());
        Assertions.assertEquals("is", model.storageProfile().dataDiskImages().get(0).source().id());
        Assertions.assertEquals("nunjlzkdr", model.storageProfile().dataDiskImages().get(0).source().uri());
        Assertions.assertEquals("qsxytqqtcmiw",
            model.storageProfile().dataDiskImages().get(0).source().storageAccountId());
        Assertions.assertEquals(1707361059, model.storageProfile().dataDiskImages().get(0).lun());
        Assertions.assertTrue(model.safetyProfile().allowDeletionOfReplicatedLocations());
        Assertions.assertFalse(model.safetyProfile().blockDeletionBeforeEndOfLife());
        Assertions.assertEquals(UefiSignatureTemplateName.MICROSOFT_WINDOWS_TEMPLATE,
            model.securityProfile().uefiSettings().signatureTemplateNames().get(0));
        Assertions.assertEquals(UefiKeyType.X509,
            model.securityProfile().uefiSettings().additionalSignatures().pk().type());
        Assertions.assertEquals("pbfs",
            model.securityProfile().uefiSettings().additionalSignatures().pk().value().get(0));
        Assertions.assertTrue(model.restore());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        GalleryImageVersionUpdate model = new GalleryImageVersionUpdate().withTags(mapOf("hyqqegatxgr", "pdixqbolxv"))
            .withPublishingProfile(new GalleryImageVersionPublishingProfile()
                .withTargetRegions(Arrays.asList(
                    new TargetRegion().withName("aqpqifdbm")
                        .withRegionalReplicaCount(947190230)
                        .withStorageAccountType(StorageAccountType.PREMIUM_V2_LRS)
                        .withEncryption(new EncryptionImages().withOsDiskImage(new OSDiskImageEncryption())
                            .withDataDiskImages(Arrays.asList(new DataDiskImageEncryption().withLun(1638013744),
                                new DataDiskImageEncryption().withLun(552181148),
                                new DataDiskImageEncryption().withLun(1210507560))))
                        .withExcludeFromLatest(true)
                        .withAdditionalReplicaSets(Arrays.asList(new AdditionalReplicaSet())),
                    new TargetRegion().withName("niz")
                        .withRegionalReplicaCount(8718366)
                        .withStorageAccountType(StorageAccountType.PREMIUM_V2_LRS)
                        .withEncryption(new EncryptionImages().withOsDiskImage(new OSDiskImageEncryption())
                            .withDataDiskImages(Arrays.asList(new DataDiskImageEncryption().withLun(926112265),
                                new DataDiskImageEncryption().withLun(508548602),
                                new DataDiskImageEncryption().withLun(1289621459))))
                        .withExcludeFromLatest(true)
                        .withAdditionalReplicaSets(Arrays.asList(new AdditionalReplicaSet(), new AdditionalReplicaSet(),
                            new AdditionalReplicaSet(), new AdditionalReplicaSet()))))
                .withReplicaCount(80016871)
                .withExcludeFromLatest(true)
                .withEndOfLifeDate(OffsetDateTime.parse("2021-04-25T04:01:32Z"))
                .withStorageAccountType(StorageAccountType.STANDARD_LRS)
                .withReplicationMode(ReplicationMode.SHALLOW)
                .withTargetExtendedLocations(Arrays.asList(
                    new GalleryTargetExtendedLocation().withName("iceovxgzw")
                        .withExtendedLocation(new GalleryExtendedLocation().withName("yrujm")
                            .withType(GalleryExtendedLocationType.EDGE_ZONE))
                        .withExtendedLocationReplicaCount(239861604)
                        .withStorageAccountType(EdgeZoneStorageAccountType.STANDARD_LRS)
                        .withEncryption(new EncryptionImages().withOsDiskImage(new OSDiskImageEncryption())
                            .withDataDiskImages(Arrays.asList(new DataDiskImageEncryption().withLun(699381711),
                                new DataDiskImageEncryption().withLun(373062326),
                                new DataDiskImageEncryption().withLun(1395773905)))),
                    new GalleryTargetExtendedLocation().withName("qhfnkvycqqqds")
                        .withExtendedLocation(new GalleryExtendedLocation().withName("nquwzxhrptyodl")
                            .withType(GalleryExtendedLocationType.EDGE_ZONE))
                        .withExtendedLocationReplicaCount(2096879897)
                        .withStorageAccountType(EdgeZoneStorageAccountType.STANDARD_LRS)
                        .withEncryption(new EncryptionImages().withOsDiskImage(new OSDiskImageEncryption())
                            .withDataDiskImages(Arrays.asList(new DataDiskImageEncryption().withLun(936776493),
                                new DataDiskImageEncryption().withLun(1009463394)))),
                    new GalleryTargetExtendedLocation().withName("pnouhbqezkqx")
                        .withExtendedLocation(new GalleryExtendedLocation().withName("uzyigfcvcewbwqhd")
                            .withType(GalleryExtendedLocationType.EDGE_ZONE))
                        .withExtendedLocationReplicaCount(593860057)
                        .withStorageAccountType(EdgeZoneStorageAccountType.STANDARD_ZRS)
                        .withEncryption(new EncryptionImages().withOsDiskImage(new OSDiskImageEncryption())
                            .withDataDiskImages(Arrays.asList(new DataDiskImageEncryption().withLun(1383836844),
                                new DataDiskImageEncryption().withLun(561691289),
                                new DataDiskImageEncryption().withLun(1384544279))))))
                .withStorageAccountStrategy(StorageAccountStrategy.PREFER_STANDARD_ZRS))
            .withStorageProfile(new GalleryImageVersionStorageProfile()
                .withSource(new GalleryArtifactVersionFullSource().withId("grszrbwtdrcwg")
                    .withCommunityGalleryImageId("qmr")
                    .withVirtualMachineId("parn"))
                .withOsDiskImage(new GalleryOSDiskImage().withHostCaching(HostCaching.NONE)
                    .withSource(new GalleryDiskImageSource().withId("zjrmhpfywvyld")
                        .withUri("hfixa")
                        .withStorageAccountId("c")))
                .withDataDiskImages(Arrays.asList(
                    new GalleryDataDiskImage().withHostCaching(HostCaching.READ_ONLY)
                        .withSource(new GalleryDiskImageSource().withId("is")
                            .withUri("nunjlzkdr")
                            .withStorageAccountId("qsxytqqtcmiw"))
                        .withLun(1707361059),
                    new GalleryDataDiskImage().withHostCaching(HostCaching.READ_WRITE)
                        .withSource(new GalleryDiskImageSource().withId("hkigglclwalhvub")
                            .withUri("amcajyhftpzcrryk")
                            .withStorageAccountId("eynq"))
                        .withLun(1763763526),
                    new GalleryDataDiskImage().withHostCaching(HostCaching.READ_WRITE)
                        .withSource(new GalleryDiskImageSource().withId("degyxsbfpzvo")
                            .withUri("dqcmyctaj")
                            .withStorageAccountId("jvalecxbibiw"))
                        .withLun(1989222315),
                    new GalleryDataDiskImage().withHostCaching(HostCaching.NONE)
                        .withSource(new GalleryDiskImageSource().withId("zpfkis")
                            .withUri("fzwush")
                            .withStorageAccountId("xpblalh"))
                        .withLun(103195865))))
            .withSafetyProfile(new GalleryImageVersionSafetyProfile().withAllowDeletionOfReplicatedLocations(true)
                .withBlockDeletionBeforeEndOfLife(false))
            .withSecurityProfile(
                new ImageVersionSecurityProfile()
                    .withUefiSettings(
                        new GalleryImageVersionUefiSettings()
                            .withSignatureTemplateNames(Arrays.asList(
                                UefiSignatureTemplateName.MICROSOFT_WINDOWS_TEMPLATE,
                                UefiSignatureTemplateName.MICROSOFT_WINDOWS_TEMPLATE,
                                UefiSignatureTemplateName.MICROSOFT_WINDOWS_TEMPLATE))
                            .withAdditionalSignatures(
                                new UefiKeySignatures()
                                    .withPk(
                                        new UefiKey().withType(UefiKeyType.X509)
                                            .withValue(Arrays.asList("pbfs", "eqbbewfcuqfpy", "xmzrmtmvwitu",
                                                "eyyjshcybwfuppox")))
                                    .withKek(Arrays.asList(new UefiKey(), new UefiKey(), new UefiKey(), new UefiKey()))
                                    .withDb(Arrays.asList(new UefiKey()))
                                    .withDbx(Arrays.asList(new UefiKey(), new UefiKey())))))
            .withRestore(true);
        model = BinaryData.fromObject(model).toObject(GalleryImageVersionUpdate.class);
        Assertions.assertEquals("pdixqbolxv", model.tags().get("hyqqegatxgr"));
        Assertions.assertEquals("aqpqifdbm", model.publishingProfile().targetRegions().get(0).name());
        Assertions.assertEquals(947190230, model.publishingProfile().targetRegions().get(0).regionalReplicaCount());
        Assertions.assertEquals(StorageAccountType.PREMIUM_V2_LRS,
            model.publishingProfile().targetRegions().get(0).storageAccountType());
        Assertions.assertEquals(1638013744,
            model.publishingProfile().targetRegions().get(0).encryption().dataDiskImages().get(0).lun());
        Assertions.assertTrue(model.publishingProfile().targetRegions().get(0).excludeFromLatest());
        Assertions.assertEquals(80016871, model.publishingProfile().replicaCount());
        Assertions.assertTrue(model.publishingProfile().excludeFromLatest());
        Assertions.assertEquals(OffsetDateTime.parse("2021-04-25T04:01:32Z"),
            model.publishingProfile().endOfLifeDate());
        Assertions.assertEquals(StorageAccountType.STANDARD_LRS, model.publishingProfile().storageAccountType());
        Assertions.assertEquals(ReplicationMode.SHALLOW, model.publishingProfile().replicationMode());
        Assertions.assertEquals("iceovxgzw", model.publishingProfile().targetExtendedLocations().get(0).name());
        Assertions.assertEquals("yrujm",
            model.publishingProfile().targetExtendedLocations().get(0).extendedLocation().name());
        Assertions.assertEquals(GalleryExtendedLocationType.EDGE_ZONE,
            model.publishingProfile().targetExtendedLocations().get(0).extendedLocation().type());
        Assertions.assertEquals(239861604,
            model.publishingProfile().targetExtendedLocations().get(0).extendedLocationReplicaCount());
        Assertions.assertEquals(EdgeZoneStorageAccountType.STANDARD_LRS,
            model.publishingProfile().targetExtendedLocations().get(0).storageAccountType());
        Assertions.assertEquals(699381711,
            model.publishingProfile().targetExtendedLocations().get(0).encryption().dataDiskImages().get(0).lun());
        Assertions.assertEquals(StorageAccountStrategy.PREFER_STANDARD_ZRS,
            model.publishingProfile().storageAccountStrategy());
        Assertions.assertEquals("grszrbwtdrcwg", model.storageProfile().source().id());
        Assertions.assertEquals("qmr", model.storageProfile().source().communityGalleryImageId());
        Assertions.assertEquals("parn", model.storageProfile().source().virtualMachineId());
        Assertions.assertEquals(HostCaching.NONE, model.storageProfile().osDiskImage().hostCaching());
        Assertions.assertEquals("zjrmhpfywvyld", model.storageProfile().osDiskImage().source().id());
        Assertions.assertEquals("hfixa", model.storageProfile().osDiskImage().source().uri());
        Assertions.assertEquals("c", model.storageProfile().osDiskImage().source().storageAccountId());
        Assertions.assertEquals(HostCaching.READ_ONLY, model.storageProfile().dataDiskImages().get(0).hostCaching());
        Assertions.assertEquals("is", model.storageProfile().dataDiskImages().get(0).source().id());
        Assertions.assertEquals("nunjlzkdr", model.storageProfile().dataDiskImages().get(0).source().uri());
        Assertions.assertEquals("qsxytqqtcmiw",
            model.storageProfile().dataDiskImages().get(0).source().storageAccountId());
        Assertions.assertEquals(1707361059, model.storageProfile().dataDiskImages().get(0).lun());
        Assertions.assertTrue(model.safetyProfile().allowDeletionOfReplicatedLocations());
        Assertions.assertFalse(model.safetyProfile().blockDeletionBeforeEndOfLife());
        Assertions.assertEquals(UefiSignatureTemplateName.MICROSOFT_WINDOWS_TEMPLATE,
            model.securityProfile().uefiSettings().signatureTemplateNames().get(0));
        Assertions.assertEquals(UefiKeyType.X509,
            model.securityProfile().uefiSettings().additionalSignatures().pk().type());
        Assertions.assertEquals("pbfs",
            model.securityProfile().uefiSettings().additionalSignatures().pk().value().get(0));
        Assertions.assertTrue(model.restore());
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
