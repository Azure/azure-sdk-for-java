// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.compute.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.compute.models.AutomaticOSUpgradePolicy;
import com.azure.resourcemanager.compute.models.RollingUpgradePolicy;
import com.azure.resourcemanager.compute.models.UpgradeMode;
import com.azure.resourcemanager.compute.models.UpgradePolicy;
import org.junit.jupiter.api.Assertions;

public final class UpgradePolicyTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        UpgradePolicy model = BinaryData.fromString(
            "{\"mode\":\"Rolling\",\"rollingUpgradePolicy\":{\"maxBatchInstancePercent\":21740307,\"maxUnhealthyInstancePercent\":718519788,\"maxUnhealthyUpgradedInstancePercent\":1079537419,\"pauseTimeBetweenBatches\":\"crzevdphlx\",\"enableCrossZoneUpgrade\":true,\"prioritizeUnhealthyInstances\":true,\"rollbackFailedInstancesOnPolicyBreach\":false,\"maxSurge\":true},\"automaticOSUpgradePolicy\":{\"enableAutomaticOSUpgrade\":false,\"disableAutomaticRollback\":false,\"useRollingUpgradePolicy\":true,\"osRollingUpgradeDeferral\":false}}")
            .toObject(UpgradePolicy.class);
        Assertions.assertEquals(UpgradeMode.ROLLING, model.mode());
        Assertions.assertEquals(21740307, model.rollingUpgradePolicy().maxBatchInstancePercent());
        Assertions.assertEquals(718519788, model.rollingUpgradePolicy().maxUnhealthyInstancePercent());
        Assertions.assertEquals(1079537419, model.rollingUpgradePolicy().maxUnhealthyUpgradedInstancePercent());
        Assertions.assertEquals("crzevdphlx", model.rollingUpgradePolicy().pauseTimeBetweenBatches());
        Assertions.assertTrue(model.rollingUpgradePolicy().enableCrossZoneUpgrade());
        Assertions.assertTrue(model.rollingUpgradePolicy().prioritizeUnhealthyInstances());
        Assertions.assertFalse(model.rollingUpgradePolicy().rollbackFailedInstancesOnPolicyBreach());
        Assertions.assertTrue(model.rollingUpgradePolicy().maxSurge());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().enableAutomaticOSUpgrade());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().disableAutomaticRollback());
        Assertions.assertTrue(model.automaticOSUpgradePolicy().useRollingUpgradePolicy());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().osRollingUpgradeDeferral());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        UpgradePolicy model = new UpgradePolicy().withMode(UpgradeMode.ROLLING)
            .withRollingUpgradePolicy(new RollingUpgradePolicy().withMaxBatchInstancePercent(21740307)
                .withMaxUnhealthyInstancePercent(718519788)
                .withMaxUnhealthyUpgradedInstancePercent(1079537419)
                .withPauseTimeBetweenBatches("crzevdphlx")
                .withEnableCrossZoneUpgrade(true)
                .withPrioritizeUnhealthyInstances(true)
                .withRollbackFailedInstancesOnPolicyBreach(false)
                .withMaxSurge(true))
            .withAutomaticOSUpgradePolicy(new AutomaticOSUpgradePolicy().withEnableAutomaticOSUpgrade(false)
                .withDisableAutomaticRollback(false)
                .withUseRollingUpgradePolicy(true)
                .withOsRollingUpgradeDeferral(false));
        model = BinaryData.fromObject(model).toObject(UpgradePolicy.class);
        Assertions.assertEquals(UpgradeMode.ROLLING, model.mode());
        Assertions.assertEquals(21740307, model.rollingUpgradePolicy().maxBatchInstancePercent());
        Assertions.assertEquals(718519788, model.rollingUpgradePolicy().maxUnhealthyInstancePercent());
        Assertions.assertEquals(1079537419, model.rollingUpgradePolicy().maxUnhealthyUpgradedInstancePercent());
        Assertions.assertEquals("crzevdphlx", model.rollingUpgradePolicy().pauseTimeBetweenBatches());
        Assertions.assertTrue(model.rollingUpgradePolicy().enableCrossZoneUpgrade());
        Assertions.assertTrue(model.rollingUpgradePolicy().prioritizeUnhealthyInstances());
        Assertions.assertFalse(model.rollingUpgradePolicy().rollbackFailedInstancesOnPolicyBreach());
        Assertions.assertTrue(model.rollingUpgradePolicy().maxSurge());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().enableAutomaticOSUpgrade());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().disableAutomaticRollback());
        Assertions.assertTrue(model.automaticOSUpgradePolicy().useRollingUpgradePolicy());
        Assertions.assertFalse(model.automaticOSUpgradePolicy().osRollingUpgradeDeferral());
    }
}
