// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.compute.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.compute.models.GalleryImageVersionUefiSettings;
import com.azure.resourcemanager.compute.models.ImageVersionSecurityProfile;
import com.azure.resourcemanager.compute.models.UefiKey;
import com.azure.resourcemanager.compute.models.UefiKeySignatures;
import com.azure.resourcemanager.compute.models.UefiKeyType;
import com.azure.resourcemanager.compute.models.UefiSignatureTemplateName;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class ImageVersionSecurityProfileTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        ImageVersionSecurityProfile model = BinaryData.fromString(
            "{\"uefiSettings\":{\"signatureTemplateNames\":[\"MicrosoftUefiCertificateAuthorityTemplate\"],\"additionalSignatures\":{\"pk\":{\"type\":\"sha256\",\"value\":[\"uz\"]},\"kek\":[{\"type\":\"x509\",\"value\":[\"zangprbfaxyxzlbc\",\"phmsexroq\",\"ndktxfv\"]},{\"type\":\"x509\",\"value\":[\"qgpkrie\"]}],\"db\":[{\"type\":\"sha256\",\"value\":[\"owwzkyfwnwpi\"]},{\"type\":\"x509\",\"value\":[\"crmpepk\",\"dm\",\"xxij\",\"skwsdgkj\"]},{\"type\":\"sha256\",\"value\":[\"rasek\",\"efcvo\"]},{\"type\":\"sha256\",\"value\":[\"artwyxqic\",\"advatdavuqmcb\"]}],\"dbx\":[{\"type\":\"sha256\",\"value\":[\"lquvjezcjumvp\",\"imioyo\"]},{\"type\":\"sha256\",\"value\":[\"iqwnnraclibbfq\",\"spkladydgnhau\",\"wuk\"]}]}}}")
            .toObject(ImageVersionSecurityProfile.class);
        Assertions.assertEquals(UefiSignatureTemplateName.MICROSOFT_UEFI_CERTIFICATE_AUTHORITY_TEMPLATE,
            model.uefiSettings().signatureTemplateNames().get(0));
        Assertions.assertEquals(UefiKeyType.SHA256, model.uefiSettings().additionalSignatures().pk().type());
        Assertions.assertEquals("uz", model.uefiSettings().additionalSignatures().pk().value().get(0));
        Assertions.assertEquals(UefiKeyType.X509, model.uefiSettings().additionalSignatures().kek().get(0).type());
        Assertions.assertEquals("zangprbfaxyxzlbc",
            model.uefiSettings().additionalSignatures().kek().get(0).value().get(0));
        Assertions.assertEquals(UefiKeyType.SHA256, model.uefiSettings().additionalSignatures().db().get(0).type());
        Assertions.assertEquals("owwzkyfwnwpi", model.uefiSettings().additionalSignatures().db().get(0).value().get(0));
        Assertions.assertEquals(UefiKeyType.SHA256, model.uefiSettings().additionalSignatures().dbx().get(0).type());
        Assertions.assertEquals("lquvjezcjumvp",
            model.uefiSettings().additionalSignatures().dbx().get(0).value().get(0));
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        ImageVersionSecurityProfile model
            = new ImageVersionSecurityProfile().withUefiSettings(new GalleryImageVersionUefiSettings()
                .withSignatureTemplateNames(
                    Arrays.asList(UefiSignatureTemplateName.MICROSOFT_UEFI_CERTIFICATE_AUTHORITY_TEMPLATE))
                .withAdditionalSignatures(new UefiKeySignatures()
                    .withPk(new UefiKey().withType(UefiKeyType.SHA256).withValue(Arrays.asList("uz")))
                    .withKek(Arrays.asList(
                        new UefiKey().withType(UefiKeyType.X509)
                            .withValue(Arrays.asList("zangprbfaxyxzlbc", "phmsexroq", "ndktxfv")),
                        new UefiKey().withType(UefiKeyType.X509).withValue(Arrays.asList("qgpkrie"))))
                    .withDb(Arrays.asList(
                        new UefiKey().withType(UefiKeyType.SHA256).withValue(Arrays.asList("owwzkyfwnwpi")),
                        new UefiKey().withType(UefiKeyType.X509)
                            .withValue(Arrays.asList("crmpepk", "dm", "xxij", "skwsdgkj")),
                        new UefiKey().withType(UefiKeyType.SHA256).withValue(Arrays.asList("rasek", "efcvo")),
                        new UefiKey().withType(UefiKeyType.SHA256)
                            .withValue(Arrays.asList("artwyxqic", "advatdavuqmcb"))))
                    .withDbx(Arrays.asList(
                        new UefiKey().withType(UefiKeyType.SHA256).withValue(Arrays.asList("lquvjezcjumvp", "imioyo")),
                        new UefiKey().withType(UefiKeyType.SHA256)
                            .withValue(Arrays.asList("iqwnnraclibbfq", "spkladydgnhau", "wuk"))))));
        model = BinaryData.fromObject(model).toObject(ImageVersionSecurityProfile.class);
        Assertions.assertEquals(UefiSignatureTemplateName.MICROSOFT_UEFI_CERTIFICATE_AUTHORITY_TEMPLATE,
            model.uefiSettings().signatureTemplateNames().get(0));
        Assertions.assertEquals(UefiKeyType.SHA256, model.uefiSettings().additionalSignatures().pk().type());
        Assertions.assertEquals("uz", model.uefiSettings().additionalSignatures().pk().value().get(0));
        Assertions.assertEquals(UefiKeyType.X509, model.uefiSettings().additionalSignatures().kek().get(0).type());
        Assertions.assertEquals("zangprbfaxyxzlbc",
            model.uefiSettings().additionalSignatures().kek().get(0).value().get(0));
        Assertions.assertEquals(UefiKeyType.SHA256, model.uefiSettings().additionalSignatures().db().get(0).type());
        Assertions.assertEquals("owwzkyfwnwpi", model.uefiSettings().additionalSignatures().db().get(0).value().get(0));
        Assertions.assertEquals(UefiKeyType.SHA256, model.uefiSettings().additionalSignatures().dbx().get(0).type());
        Assertions.assertEquals("lquvjezcjumvp",
            model.uefiSettings().additionalSignatures().dbx().get(0).value().get(0));
    }
}
