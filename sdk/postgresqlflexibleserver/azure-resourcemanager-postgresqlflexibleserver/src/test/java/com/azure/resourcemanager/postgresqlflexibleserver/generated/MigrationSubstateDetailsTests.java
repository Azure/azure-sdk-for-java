// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.postgresqlflexibleserver.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.postgresqlflexibleserver.models.DatabaseMigrationState;
import com.azure.resourcemanager.postgresqlflexibleserver.models.DbLevelValidationStatus;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationDatabaseState;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationSubstateDetails;
import com.azure.resourcemanager.postgresqlflexibleserver.models.ValidationDetails;
import com.azure.resourcemanager.postgresqlflexibleserver.models.ValidationMessage;
import com.azure.resourcemanager.postgresqlflexibleserver.models.ValidationState;
import com.azure.resourcemanager.postgresqlflexibleserver.models.ValidationSummaryItem;
import java.time.OffsetDateTime;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import org.junit.jupiter.api.Assertions;

public final class MigrationSubstateDetailsTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        MigrationSubstateDetails model = BinaryData.fromString(
            "{\"currentSubState\":\"MigratingData\",\"dbDetails\":{\"cqqudf\":{\"databaseName\":\"yxxrwlycoduh\",\"migrationState\":\"Failed\",\"migrationOperation\":\"gymare\",\"startedOn\":\"2021-03-16T20:45:43Z\",\"endedOn\":\"2021-11-23T08:29:11Z\",\"fullLoadQueuedTables\":1568573740,\"fullLoadErroredTables\":1691251601,\"fullLoadLoadingTables\":432489630,\"fullLoadCompletedTables\":1068546777,\"cdcUpdateCounter\":314169873,\"cdcDeleteCounter\":642347272,\"cdcInsertCounter\":1615439443,\"appliedChanges\":2056337569,\"incomingChanges\":1063119881,\"latency\":1853639964,\"message\":\"zqalkrmnjijpx\"},\"aytdwkqbrq\":{\"databaseName\":\"yxbaaabjyvayf\",\"migrationState\":\"InProgress\",\"migrationOperation\":\"zrtuzq\",\"startedOn\":\"2021-05-14T21:16:38Z\",\"endedOn\":\"2021-10-01T08:47:38Z\",\"fullLoadQueuedTables\":218306871,\"fullLoadErroredTables\":850324011,\"fullLoadLoadingTables\":1536688095,\"fullLoadCompletedTables\":512160368,\"cdcUpdateCounter\":2059840008,\"cdcDeleteCounter\":377160768,\"cdcInsertCounter\":1440499034,\"appliedChanges\":10547913,\"incomingChanges\":1475196585,\"latency\":1576556557,\"message\":\"oibjudpfrxtrthz\"}},\"validationDetails\":{\"status\":\"Failed\",\"validationStartTimeInUtc\":\"2021-06-19T07:52:19Z\",\"validationEndTimeInUtc\":\"2021-08-03T15:35:30Z\",\"serverLevelValidationDetails\":[{\"type\":\"ivpdtiir\",\"state\":\"Failed\",\"messages\":[{\"state\":\"Failed\",\"message\":\"r\"},{\"state\":\"Succeeded\",\"message\":\"squyfxrxxlep\"},{\"state\":\"Succeeded\",\"message\":\"xje\"}]}],\"dbLevelValidationDetails\":[{\"databaseName\":\"nwxuqlcvydyp\",\"startedOn\":\"2021-03-01T02:46:01Z\",\"endedOn\":\"2021-08-27T20:00:04Z\",\"summary\":[{\"type\":\"kniod\",\"state\":\"Warning\",\"messages\":[{}]},{\"type\":\"nuj\",\"state\":\"Failed\",\"messages\":[{},{},{},{}]}]},{\"databaseName\":\"vdkcrodtj\",\"startedOn\":\"2021-03-09T18:26:05Z\",\"endedOn\":\"2021-03-22T21:04:29Z\",\"summary\":[{\"type\":\"kacjvefkdlfo\",\"state\":\"Warning\",\"messages\":[{},{}]}]},{\"databaseName\":\"pagao\",\"startedOn\":\"2021-02-23T21:26:17Z\",\"endedOn\":\"2021-11-09T20:51:35Z\",\"summary\":[{\"type\":\"ylsyxkqjnsje\",\"state\":\"Warning\",\"messages\":[{},{},{}]},{\"type\":\"xsdszuempsb\",\"state\":\"Failed\",\"messages\":[{},{},{},{}]},{\"type\":\"yvpnqicvinvkjj\",\"state\":\"Warning\",\"messages\":[{},{},{},{}]},{\"type\":\"ukzclewyhmlwpaz\",\"state\":\"Failed\",\"messages\":[{}]}]},{\"databaseName\":\"cckwyfzqwhxxbu\",\"startedOn\":\"2021-05-27T03:07:24Z\",\"endedOn\":\"2020-12-30T00:37:41Z\",\"summary\":[{\"type\":\"ztppriolxorjalto\",\"state\":\"Succeeded\",\"messages\":[{},{},{}]}]}]}}")
            .toObject(MigrationSubstateDetails.class);
        Assertions.assertEquals("yxxrwlycoduh", model.dbDetails().get("cqqudf").databaseName());
        Assertions.assertEquals(MigrationDatabaseState.FAILED, model.dbDetails().get("cqqudf").migrationState());
        Assertions.assertEquals("gymare", model.dbDetails().get("cqqudf").migrationOperation());
        Assertions.assertEquals(OffsetDateTime.parse("2021-03-16T20:45:43Z"),
            model.dbDetails().get("cqqudf").startedOn());
        Assertions.assertEquals(OffsetDateTime.parse("2021-11-23T08:29:11Z"),
            model.dbDetails().get("cqqudf").endedOn());
        Assertions.assertEquals(1568573740, model.dbDetails().get("cqqudf").fullLoadQueuedTables());
        Assertions.assertEquals(1691251601, model.dbDetails().get("cqqudf").fullLoadErroredTables());
        Assertions.assertEquals(432489630, model.dbDetails().get("cqqudf").fullLoadLoadingTables());
        Assertions.assertEquals(1068546777, model.dbDetails().get("cqqudf").fullLoadCompletedTables());
        Assertions.assertEquals(314169873, model.dbDetails().get("cqqudf").cdcUpdateCounter());
        Assertions.assertEquals(642347272, model.dbDetails().get("cqqudf").cdcDeleteCounter());
        Assertions.assertEquals(1615439443, model.dbDetails().get("cqqudf").cdcInsertCounter());
        Assertions.assertEquals(2056337569, model.dbDetails().get("cqqudf").appliedChanges());
        Assertions.assertEquals(1063119881, model.dbDetails().get("cqqudf").incomingChanges());
        Assertions.assertEquals(1853639964, model.dbDetails().get("cqqudf").latency());
        Assertions.assertEquals("zqalkrmnjijpx", model.dbDetails().get("cqqudf").message());
        Assertions.assertEquals(ValidationState.FAILED, model.validationDetails().status());
        Assertions.assertEquals(OffsetDateTime.parse("2021-06-19T07:52:19Z"),
            model.validationDetails().validationStartTimeInUtc());
        Assertions.assertEquals(OffsetDateTime.parse("2021-08-03T15:35:30Z"),
            model.validationDetails().validationEndTimeInUtc());
        Assertions.assertEquals("ivpdtiir", model.validationDetails().serverLevelValidationDetails().get(0).type());
        Assertions.assertEquals(ValidationState.FAILED,
            model.validationDetails().serverLevelValidationDetails().get(0).state());
        Assertions.assertEquals(ValidationState.FAILED,
            model.validationDetails().serverLevelValidationDetails().get(0).messages().get(0).state());
        Assertions.assertEquals("r",
            model.validationDetails().serverLevelValidationDetails().get(0).messages().get(0).message());
        Assertions.assertEquals("nwxuqlcvydyp",
            model.validationDetails().dbLevelValidationDetails().get(0).databaseName());
        Assertions.assertEquals(OffsetDateTime.parse("2021-03-01T02:46:01Z"),
            model.validationDetails().dbLevelValidationDetails().get(0).startedOn());
        Assertions.assertEquals(OffsetDateTime.parse("2021-08-27T20:00:04Z"),
            model.validationDetails().dbLevelValidationDetails().get(0).endedOn());
        Assertions.assertEquals("kniod",
            model.validationDetails().dbLevelValidationDetails().get(0).summary().get(0).type());
        Assertions.assertEquals(ValidationState.WARNING,
            model.validationDetails().dbLevelValidationDetails().get(0).summary().get(0).state());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        MigrationSubstateDetails model
            = new MigrationSubstateDetails()
                .withDbDetails(mapOf("cqqudf",
                    new DatabaseMigrationState().withDatabaseName("yxxrwlycoduh")
                        .withMigrationState(MigrationDatabaseState.FAILED)
                        .withMigrationOperation("gymare")
                        .withStartedOn(OffsetDateTime.parse("2021-03-16T20:45:43Z"))
                        .withEndedOn(OffsetDateTime.parse("2021-11-23T08:29:11Z"))
                        .withFullLoadQueuedTables(1568573740)
                        .withFullLoadErroredTables(1691251601)
                        .withFullLoadLoadingTables(432489630)
                        .withFullLoadCompletedTables(1068546777)
                        .withCdcUpdateCounter(314169873)
                        .withCdcDeleteCounter(642347272)
                        .withCdcInsertCounter(1615439443)
                        .withAppliedChanges(2056337569)
                        .withIncomingChanges(1063119881)
                        .withLatency(1853639964)
                        .withMessage("zqalkrmnjijpx"),
                    "aytdwkqbrq",
                    new DatabaseMigrationState().withDatabaseName("yxbaaabjyvayf")
                        .withMigrationState(MigrationDatabaseState.IN_PROGRESS)
                        .withMigrationOperation("zrtuzq")
                        .withStartedOn(OffsetDateTime.parse("2021-05-14T21:16:38Z"))
                        .withEndedOn(OffsetDateTime.parse("2021-10-01T08:47:38Z"))
                        .withFullLoadQueuedTables(218306871)
                        .withFullLoadErroredTables(850324011)
                        .withFullLoadLoadingTables(1536688095)
                        .withFullLoadCompletedTables(512160368)
                        .withCdcUpdateCounter(2059840008)
                        .withCdcDeleteCounter(377160768)
                        .withCdcInsertCounter(1440499034)
                        .withAppliedChanges(10547913)
                        .withIncomingChanges(1475196585)
                        .withLatency(1576556557)
                        .withMessage("oibjudpfrxtrthz")))
                .withValidationDetails(
                    new ValidationDetails().withStatus(ValidationState.FAILED)
                        .withValidationStartTimeInUtc(OffsetDateTime.parse("2021-06-19T07:52:19Z"))
                        .withValidationEndTimeInUtc(OffsetDateTime.parse("2021-08-03T15:35:30Z"))
                        .withServerLevelValidationDetails(Arrays.asList(new ValidationSummaryItem().withType("ivpdtiir")
                            .withState(ValidationState.FAILED)
                            .withMessages(Arrays.asList(
                                new ValidationMessage().withState(ValidationState.FAILED).withMessage("r"),
                                new ValidationMessage().withState(ValidationState.SUCCEEDED)
                                    .withMessage("squyfxrxxlep"),
                                new ValidationMessage().withState(ValidationState.SUCCEEDED).withMessage("xje")))))
                        .withDbLevelValidationDetails(Arrays.asList(
                            new DbLevelValidationStatus().withDatabaseName("nwxuqlcvydyp")
                                .withStartedOn(OffsetDateTime.parse("2021-03-01T02:46:01Z"))
                                .withEndedOn(OffsetDateTime.parse("2021-08-27T20:00:04Z"))
                                .withSummary(Arrays.asList(
                                    new ValidationSummaryItem().withType("kniod")
                                        .withState(ValidationState.WARNING)
                                        .withMessages(Arrays.asList(new ValidationMessage())),
                                    new ValidationSummaryItem().withType("nuj")
                                        .withState(ValidationState.FAILED)
                                        .withMessages(Arrays.asList(new ValidationMessage(), new ValidationMessage(),
                                            new ValidationMessage(), new ValidationMessage())))),
                            new DbLevelValidationStatus().withDatabaseName("vdkcrodtj")
                                .withStartedOn(OffsetDateTime.parse("2021-03-09T18:26:05Z"))
                                .withEndedOn(OffsetDateTime.parse("2021-03-22T21:04:29Z"))
                                .withSummary(Arrays.asList(new ValidationSummaryItem().withType("kacjvefkdlfo")
                                    .withState(ValidationState.WARNING)
                                    .withMessages(Arrays.asList(new ValidationMessage(), new ValidationMessage())))),
                            new DbLevelValidationStatus().withDatabaseName("pagao")
                                .withStartedOn(OffsetDateTime.parse("2021-02-23T21:26:17Z"))
                                .withEndedOn(OffsetDateTime.parse("2021-11-09T20:51:35Z"))
                                .withSummary(Arrays.asList(
                                    new ValidationSummaryItem().withType("ylsyxkqjnsje")
                                        .withState(ValidationState.WARNING)
                                        .withMessages(Arrays.asList(new ValidationMessage(), new ValidationMessage(),
                                            new ValidationMessage())),
                                    new ValidationSummaryItem().withType("xsdszuempsb")
                                        .withState(ValidationState.FAILED)
                                        .withMessages(Arrays.asList(new ValidationMessage(), new ValidationMessage(),
                                            new ValidationMessage(), new ValidationMessage())),
                                    new ValidationSummaryItem().withType("yvpnqicvinvkjj")
                                        .withState(ValidationState.WARNING)
                                        .withMessages(Arrays.asList(new ValidationMessage(), new ValidationMessage(),
                                            new ValidationMessage(), new ValidationMessage())),
                                    new ValidationSummaryItem().withType("ukzclewyhmlwpaz")
                                        .withState(ValidationState.FAILED)
                                        .withMessages(Arrays.asList(new ValidationMessage())))),
                            new DbLevelValidationStatus().withDatabaseName("cckwyfzqwhxxbu")
                                .withStartedOn(OffsetDateTime.parse("2021-05-27T03:07:24Z"))
                                .withEndedOn(OffsetDateTime.parse("2020-12-30T00:37:41Z"))
                                .withSummary(Arrays.asList(new ValidationSummaryItem().withType("ztppriolxorjalto")
                                    .withState(ValidationState.SUCCEEDED)
                                    .withMessages(Arrays.asList(new ValidationMessage(), new ValidationMessage(),
                                        new ValidationMessage())))))));
        model = BinaryData.fromObject(model).toObject(MigrationSubstateDetails.class);
        Assertions.assertEquals("yxxrwlycoduh", model.dbDetails().get("cqqudf").databaseName());
        Assertions.assertEquals(MigrationDatabaseState.FAILED, model.dbDetails().get("cqqudf").migrationState());
        Assertions.assertEquals("gymare", model.dbDetails().get("cqqudf").migrationOperation());
        Assertions.assertEquals(OffsetDateTime.parse("2021-03-16T20:45:43Z"),
            model.dbDetails().get("cqqudf").startedOn());
        Assertions.assertEquals(OffsetDateTime.parse("2021-11-23T08:29:11Z"),
            model.dbDetails().get("cqqudf").endedOn());
        Assertions.assertEquals(1568573740, model.dbDetails().get("cqqudf").fullLoadQueuedTables());
        Assertions.assertEquals(1691251601, model.dbDetails().get("cqqudf").fullLoadErroredTables());
        Assertions.assertEquals(432489630, model.dbDetails().get("cqqudf").fullLoadLoadingTables());
        Assertions.assertEquals(1068546777, model.dbDetails().get("cqqudf").fullLoadCompletedTables());
        Assertions.assertEquals(314169873, model.dbDetails().get("cqqudf").cdcUpdateCounter());
        Assertions.assertEquals(642347272, model.dbDetails().get("cqqudf").cdcDeleteCounter());
        Assertions.assertEquals(1615439443, model.dbDetails().get("cqqudf").cdcInsertCounter());
        Assertions.assertEquals(2056337569, model.dbDetails().get("cqqudf").appliedChanges());
        Assertions.assertEquals(1063119881, model.dbDetails().get("cqqudf").incomingChanges());
        Assertions.assertEquals(1853639964, model.dbDetails().get("cqqudf").latency());
        Assertions.assertEquals("zqalkrmnjijpx", model.dbDetails().get("cqqudf").message());
        Assertions.assertEquals(ValidationState.FAILED, model.validationDetails().status());
        Assertions.assertEquals(OffsetDateTime.parse("2021-06-19T07:52:19Z"),
            model.validationDetails().validationStartTimeInUtc());
        Assertions.assertEquals(OffsetDateTime.parse("2021-08-03T15:35:30Z"),
            model.validationDetails().validationEndTimeInUtc());
        Assertions.assertEquals("ivpdtiir", model.validationDetails().serverLevelValidationDetails().get(0).type());
        Assertions.assertEquals(ValidationState.FAILED,
            model.validationDetails().serverLevelValidationDetails().get(0).state());
        Assertions.assertEquals(ValidationState.FAILED,
            model.validationDetails().serverLevelValidationDetails().get(0).messages().get(0).state());
        Assertions.assertEquals("r",
            model.validationDetails().serverLevelValidationDetails().get(0).messages().get(0).message());
        Assertions.assertEquals("nwxuqlcvydyp",
            model.validationDetails().dbLevelValidationDetails().get(0).databaseName());
        Assertions.assertEquals(OffsetDateTime.parse("2021-03-01T02:46:01Z"),
            model.validationDetails().dbLevelValidationDetails().get(0).startedOn());
        Assertions.assertEquals(OffsetDateTime.parse("2021-08-27T20:00:04Z"),
            model.validationDetails().dbLevelValidationDetails().get(0).endedOn());
        Assertions.assertEquals("kniod",
            model.validationDetails().dbLevelValidationDetails().get(0).summary().get(0).type());
        Assertions.assertEquals(ValidationState.WARNING,
            model.validationDetails().dbLevelValidationDetails().get(0).summary().get(0).state());
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
