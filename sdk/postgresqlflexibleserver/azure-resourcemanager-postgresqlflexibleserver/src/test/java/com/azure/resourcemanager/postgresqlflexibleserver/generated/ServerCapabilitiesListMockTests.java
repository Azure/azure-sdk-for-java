// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.postgresqlflexibleserver.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager;
import com.azure.resourcemanager.postgresqlflexibleserver.models.FlexibleServerCapability;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class ServerCapabilitiesListMockTests {
    @Test
    public void testList() throws Exception {
        String responseStr
            = "{\"value\":[{\"name\":\"ylnio\",\"supportedServerEditions\":[{\"name\":\"bzjedmstk\",\"defaultSkuName\":\"l\",\"supportedStorageEditions\":[{\"name\":\"uiiznktwfansnvpd\",\"defaultStorageSizeMb\":2885516766254746853,\"supportedStorageMb\":[{},{},{}],\"status\":\"Disabled\",\"reason\":\"z\"},{\"name\":\"iwbuqny\",\"defaultStorageSizeMb\":5628376431700848630,\"supportedStorageMb\":[{}],\"status\":\"Disabled\",\"reason\":\"crpfbcunez\"}],\"supportedServerSkus\":[{\"name\":\"elfwy\",\"vCores\":2072196821,\"supportedIops\":1173398556,\"supportedMemoryPerVcoreMb\":989271166878506268,\"supportedZones\":[\"psihcla\",\"zvaylptrsqqw\",\"tcmwqkchc\"],\"supportedHaMode\":[\"SameZone\"],\"supportedFeatures\":[{},{},{}],\"securityProfile\":\"zjkjexfdeqv\",\"status\":\"Available\",\"reason\":\"lkkshkbffmbmx\"}],\"status\":\"Available\",\"reason\":\"ywwpgjxsnptfuj\"}],\"supportedServerVersions\":[{\"name\":\"aaoepttaqut\",\"supportedVersionsToUpgrade\":[\"emxswvruu\",\"zzjgehkfki\",\"rtixokff\",\"yinljqe\"],\"supportedFeatures\":[{\"name\":\"ixmonstshiyxg\",\"status\":\"Enabled\"},{\"name\":\"clduc\",\"status\":\"Disabled\"},{\"name\":\"ds\",\"status\":\"Enabled\"}],\"status\":\"Visible\",\"reason\":\"iegstm\"}],\"supportedFeatures\":[{\"name\":\"jizcilnghgs\",\"status\":\"Disabled\"},{\"name\":\"tbxqmuluxlxq\",\"status\":\"Enabled\"},{\"name\":\"rsbycucrwn\",\"status\":\"Enabled\"},{\"name\":\"ze\",\"status\":\"Enabled\"}],\"fastProvisioningSupported\":\"Disabled\",\"supportedFastProvisioningEditions\":[{\"supportedTier\":\"ziqgfuh\",\"supportedSku\":\"zruswh\",\"supportedStorageGb\":1276166311,\"supportedServerVersions\":\"znvfbycjsxjww\",\"serverCount\":184999250,\"status\":\"Default\",\"reason\":\"wmxqhndvnoamlds\"},{\"supportedTier\":\"aohdjh\",\"supportedSku\":\"lzok\",\"supportedStorageGb\":434777672,\"supportedServerVersions\":\"pelnjetag\",\"serverCount\":1066573650,\"status\":\"Disabled\",\"reason\":\"tft\"}],\"geoBackupSupported\":\"Disabled\",\"zoneRedundantHaSupported\":\"Disabled\",\"zoneRedundantHaAndGeoBackupSupported\":\"Disabled\",\"storageAutoGrowthSupported\":\"Disabled\",\"onlineResizeSupported\":\"Disabled\",\"restricted\":\"Enabled\",\"status\":\"Visible\",\"reason\":\"rmozihmipgawt\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        PostgreSqlManager manager = PostgreSqlManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        PagedIterable<FlexibleServerCapability> response
            = manager.serverCapabilities().list("cyrcmjdmspo", "apvu", com.azure.core.util.Context.NONE);

        Assertions.assertEquals("ylnio", response.iterator().next().name());
    }
}
