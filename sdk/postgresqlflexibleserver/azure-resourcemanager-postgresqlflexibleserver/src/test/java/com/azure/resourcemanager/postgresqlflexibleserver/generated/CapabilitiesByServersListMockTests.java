// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.postgresqlflexibleserver.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager;
import com.azure.resourcemanager.postgresqlflexibleserver.models.Capability;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class CapabilitiesByServersListMockTests {
    @Test
    public void testList() throws Exception {
        String responseStr
            = "{\"value\":[{\"name\":\"yrmfsvbpav\",\"supportedServerEditions\":[{\"name\":\"ppdbwnupgahxkum\",\"defaultSkuName\":\"jcaacfdmmcpugm\",\"supportedStorageEditions\":[{\"name\":\"pvufhbze\",\"defaultStorageSizeMb\":7906850882794610088,\"supportedStorageMb\":[{},{},{}],\"status\":\"Disabled\",\"reason\":\"bqnbl\"},{\"name\":\"eaclgschorimk\",\"defaultStorageSizeMb\":413479750820054458,\"supportedStorageMb\":[{}],\"status\":\"Visible\",\"reason\":\"ofldpuviyfcaa\"},{\"name\":\"olhbhlvb\",\"defaultStorageSizeMb\":1413963806220016584,\"supportedStorageMb\":[{},{},{},{}],\"status\":\"Default\",\"reason\":\"kcudfbsfarfsiowl\"}],\"supportedServerSkus\":[{\"name\":\"qpvwgfst\",\"vCores\":970859098,\"supportedIops\":1391395953,\"supportedMemoryPerVcoreMb\":3478446740045620391,\"supportedZones\":[\"saoafcluqvox\",\"ycjimryvwgcwwpbm\",\"gwe\",\"ydsx\"],\"supportedHaMode\":[\"SameZone\"],\"supportedFeatures\":[{}],\"securityProfile\":\"bvopwndyqle\",\"status\":\"Default\",\"reason\":\"lmtkhlowkxx\"}],\"status\":\"Visible\",\"reason\":\"dfjmzsyzfhotlh\"},{\"name\":\"cyychunsjlp\",\"defaultSkuName\":\"twszhvvuic\",\"supportedStorageEditions\":[{\"name\":\"rrmhwrbfdp\",\"defaultStorageSizeMb\":7297695340259006779,\"supportedStorageMb\":[{}],\"status\":\"Visible\",\"reason\":\"lrocuyzlwh\"},{\"name\":\"emhooclutnpq\",\"defaultStorageSizeMb\":6782325678224210492,\"supportedStorageMb\":[{}],\"status\":\"Available\",\"reason\":\"ykyujxsg\"},{\"name\":\"srrryejylmbkzu\",\"defaultStorageSizeMb\":4326085874673408153,\"supportedStorageMb\":[{},{}],\"status\":\"Visible\",\"reason\":\"tjewlpxuzzj\"},{\"name\":\"refqy\",\"defaultStorageSizeMb\":9207554581349131081,\"supportedStorageMb\":[{},{},{}],\"status\":\"Default\",\"reason\":\"akydiwfbrkwpz\"}],\"supportedServerSkus\":[{\"name\":\"hcspo\",\"vCores\":1827970432,\"supportedIops\":574197780,\"supportedMemoryPerVcoreMb\":8531751667081948425,\"supportedZones\":[\"tgbebj\",\"ulbmoichdlp\",\"fpubntnbatz\"],\"supportedHaMode\":[\"Disabled\"],\"supportedFeatures\":[{},{}],\"securityProfile\":\"aaelcattc\",\"status\":\"Disabled\",\"reason\":\"lrvkmjc\"},{\"name\":\"jvlgfggcvkyyliz\",\"vCores\":1675094486,\"supportedIops\":1460311079,\"supportedMemoryPerVcoreMb\":4287701652301675834,\"supportedZones\":[\"uztlvtmva\"],\"supportedHaMode\":[\"Disabled\"],\"supportedFeatures\":[{}],\"securityProfile\":\"vhuk\",\"status\":\"Available\",\"reason\":\"fizr\"}],\"status\":\"Visible\",\"reason\":\"mjm\"}],\"supportedServerVersions\":[{\"name\":\"z\",\"supportedVersionsToUpgrade\":[\"lkujrllfojui\",\"jpu\",\"yjucejikzoeo\",\"vtzejetjklnti\"],\"supportedFeatures\":[{\"name\":\"zkdbqzolx\",\"status\":\"Disabled\"},{\"name\":\"qjwt\",\"status\":\"Enabled\"}],\"status\":\"Disabled\",\"reason\":\"zpcrrkolawj\"},{\"name\":\"smwr\",\"supportedVersionsToUpgrade\":[\"dxfzzzwyjaf\",\"tlhguynuchl\",\"mltx\",\"whmozusgzvlnsnnj\"],\"supportedFeatures\":[{\"name\":\"folpymwamxqzra\",\"status\":\"Disabled\"},{\"name\":\"phtvdu\",\"status\":\"Enabled\"}],\"status\":\"Available\",\"reason\":\"jchcsrlzknmzla\"},{\"name\":\"updwv\",\"supportedVersionsToUpgrade\":[\"cnzqtpjhmqr\",\"v\"],\"supportedFeatures\":[{\"name\":\"iwdcxsmlzzhzd\",\"status\":\"Disabled\"},{\"name\":\"lgyd\",\"status\":\"Disabled\"},{\"name\":\"lnnpx\",\"status\":\"Disabled\"},{\"name\":\"iqge\",\"status\":\"Disabled\"}],\"status\":\"Default\",\"reason\":\"ekglklb\"}],\"supportedFeatures\":[{\"name\":\"dw\",\"status\":\"Enabled\"},{\"name\":\"zegjonfhjirwgdn\",\"status\":\"Enabled\"},{\"name\":\"fkspzhzmtksjci\",\"status\":\"Disabled\"},{\"name\":\"sxcdgljplkeuach\",\"status\":\"Disabled\"}],\"fastProvisioningSupported\":\"Enabled\",\"supportedFastProvisioningEditions\":[{\"supportedTier\":\"swfpfmd\",\"supportedSku\":\"cxnmskwhqjjyslu\",\"supportedStorageGb\":1686230726,\"supportedServerVersions\":\"hhkvpedwqs\",\"serverCount\":510077945,\"status\":\"Available\",\"reason\":\"qvwwsko\"},{\"supportedTier\":\"cbrwi\",\"supportedSku\":\"vqejosovy\",\"supportedStorageGb\":1522744634,\"supportedServerVersions\":\"a\",\"serverCount\":1998880245,\"status\":\"Default\",\"reason\":\"tljqobbpih\"}],\"geoBackupSupported\":\"Disabled\",\"zoneRedundantHaSupported\":\"Enabled\",\"zoneRedundantHaAndGeoBackupSupported\":\"Disabled\",\"storageAutoGrowthSupported\":\"Disabled\",\"onlineResizeSupported\":\"Disabled\",\"restricted\":\"Enabled\",\"status\":\"Disabled\",\"reason\":\"pxdlv\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        PostgreSqlManager manager = PostgreSqlManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        PagedIterable<Capability> response
            = manager.capabilitiesByServers().list("aimmoiroqb", "shbraga", com.azure.core.util.Context.NONE);

        Assertions.assertEquals("yrmfsvbpav", response.iterator().next().name());
    }
}
