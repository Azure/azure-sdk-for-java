// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.postgresqlflexibleserver.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager;
import com.azure.resourcemanager.postgresqlflexibleserver.models.Capability;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class CapabilitiesByServersListMockTests {
    @Test
    public void testList() throws Exception {
        String responseStr
            = "{\"value\":[{\"name\":\"inljqepqwhixmo\",\"supportedServerEditions\":[{\"name\":\"hiyxgvelfclduc\",\"defaultSkuName\":\"irdsvuwcob\",\"supportedStorageEditions\":[{\"name\":\"tmninw\",\"defaultStorageSizeMb\":9022679316760749990,\"supportedStorageMb\":[{},{},{},{}],\"status\":\"Disabled\",\"reason\":\"gshejjtbxqmulux\"},{\"name\":\"qzvnersbycucr\",\"defaultStorageSizeMb\":4313993225236997368,\"supportedStorageMb\":[{},{},{}],\"status\":\"Disabled\",\"reason\":\"rqbsmswziq\"},{\"name\":\"uhok\",\"defaultStorageSizeMb\":8103562899959904004,\"supportedStorageMb\":[{},{}],\"status\":\"Available\",\"reason\":\"zznvfbyc\"},{\"name\":\"xjww\",\"defaultStorageSizeMb\":794565730593140555,\"supportedStorageMb\":[{},{},{},{}],\"status\":\"Disabled\",\"reason\":\"qhndvnoam\"}],\"supportedServerSkus\":[{\"name\":\"haohdjhhflzokxc\",\"vCores\":94741475,\"supportedIops\":220709617,\"supportedMemoryPerVcoreMb\":5958311403338730339,\"supportedZones\":[\"gltsxoat\",\"tgzpnpb\"],\"supportedHaMode\":[\"ZoneRedundant\",\"SameZone\",\"SameZone\",\"ZoneRedundant\"],\"supportedFeatures\":[{}],\"securityProfile\":\"rmozihmipgawt\",\"status\":\"Disabled\",\"reason\":\"y\"},{\"name\":\"xcjxgrytfmpcy\",\"vCores\":1979879685,\"supportedIops\":1106517654,\"supportedMemoryPerVcoreMb\":659478827292314568,\"supportedZones\":[\"gnoxuztrksx\"],\"supportedHaMode\":[\"ZoneRedundant\",\"SameZone\"],\"supportedFeatures\":[{},{},{}],\"securityProfile\":\"nznthjtw\",\"status\":\"Available\",\"reason\":\"srxuzvoam\"},{\"name\":\"cqiosmgbza\",\"vCores\":1221237045,\"supportedIops\":348009513,\"supportedMemoryPerVcoreMb\":7353682627301565777,\"supportedZones\":[\"tlaprltzkatb\",\"jm\",\"nnbsoqeqa\",\"arvlagunbt\"],\"supportedHaMode\":[\"ZoneRedundant\",\"ZoneRedundant\",\"ZoneRedundant\",\"ZoneRedundant\"],\"supportedFeatures\":[{},{},{}],\"securityProfile\":\"yreeudz\",\"status\":\"Disabled\",\"reason\":\"pdqmjxlyyzglgouw\"},{\"name\":\"mjjyuojq\",\"vCores\":816836256,\"supportedIops\":856009937,\"supportedMemoryPerVcoreMb\":287770145708812927,\"supportedZones\":[\"unlbfjkwr\"],\"supportedHaMode\":[\"ZoneRedundant\",\"ZoneRedundant\",\"ZoneRedundant\"],\"supportedFeatures\":[{}],\"securityProfile\":\"rqunjq\",\"status\":\"Visible\",\"reason\":\"xaulkpakdkifmjnn\"}],\"status\":\"Default\",\"reason\":\"abpxuc\"}],\"supportedServerVersions\":[{\"name\":\"qoweyirdhl\",\"supportedVersionsToUpgrade\":[\"gwflq\",\"mpizru\",\"n\",\"qxpxiwfcngjsaa\"],\"supportedFeatures\":[{\"name\":\"tmkzjvkviirhgfgr\",\"status\":\"Enabled\"},{\"name\":\"gratzvzbglbyvict\",\"status\":\"Enabled\"},{\"name\":\"xkjzwrgxffm\",\"status\":\"Enabled\"},{\"name\":\"fbkgozxwopdby\",\"status\":\"Disabled\"}],\"status\":\"Default\",\"reason\":\"clnapxbiygnugjkn\"},{\"name\":\"mfcttux\",\"supportedVersionsToUpgrade\":[\"i\",\"flqo\",\"quvre\",\"mrnjh\"],\"supportedFeatures\":[{\"name\":\"ztczytq\",\"status\":\"Enabled\"},{\"name\":\"auunfprnjletlx\",\"status\":\"Disabled\"}],\"status\":\"Available\",\"reason\":\"ou\"}],\"supportedFeatures\":[{\"name\":\"owa\",\"status\":\"Enabled\"},{\"name\":\"knlqwzdvpiwhxqsz\",\"status\":\"Disabled\"},{\"name\":\"ajquhuxylrjvmtyg\",\"status\":\"Disabled\"},{\"name\":\"yospspshc\",\"status\":\"Disabled\"}],\"fastProvisioningSupported\":\"Disabled\",\"supportedFastProvisioningEditions\":[{\"supportedTier\":\"pbpssdfpp\",\"supportedSku\":\"gt\",\"supportedStorageGb\":857144221,\"supportedServerVersions\":\"jtvczkcnyxrxmun\",\"serverCount\":630868038,\"status\":\"Default\",\"reason\":\"nkvxlxpaglqi\"},{\"supportedTier\":\"gkcvkhpzvuq\",\"supportedSku\":\"lvoniy\",\"supportedStorageGb\":1712367838,\"supportedServerVersions\":\"bcpzgpxtivh\",\"serverCount\":281745669,\"status\":\"Disabled\",\"reason\":\"bgqjxgpnrhgo\"},{\"supportedTier\":\"gpikqmh\",\"supportedSku\":\"owjrmzvuporqz\",\"supportedStorageGb\":1356794202,\"supportedServerVersions\":\"dzvkfvxcnqmxq\",\"serverCount\":714588328,\"status\":\"Available\",\"reason\":\"vkhlggdhbemz\"}],\"geoBackupSupported\":\"Disabled\",\"zoneRedundantHaSupported\":\"Enabled\",\"zoneRedundantHaAndGeoBackupSupported\":\"Disabled\",\"storageAutoGrowthSupported\":\"Enabled\",\"onlineResizeSupported\":\"Disabled\",\"restricted\":\"Disabled\",\"status\":\"Available\",\"reason\":\"jfpgpicrmn\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        PostgreSqlManager manager = PostgreSqlManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        PagedIterable<Capability> response = manager.capabilitiesByServers()
            .list("wemxswvruunzz", "gehkfkimrtixokff", com.azure.core.util.Context.NONE);

        Assertions.assertEquals("inljqepqwhixmo", response.iterator().next().name());
    }
}
