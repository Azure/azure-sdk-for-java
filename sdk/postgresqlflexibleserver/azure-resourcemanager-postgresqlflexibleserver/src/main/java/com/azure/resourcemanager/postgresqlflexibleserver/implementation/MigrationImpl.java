// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.postgresqlflexibleserver.implementation;

import com.azure.core.management.Region;
import com.azure.core.management.SystemData;
import com.azure.core.util.Context;
import com.azure.resourcemanager.postgresqlflexibleserver.fluent.models.MigrationInner;
import com.azure.resourcemanager.postgresqlflexibleserver.models.Cancel;
import com.azure.resourcemanager.postgresqlflexibleserver.models.DbServerMetadata;
import com.azure.resourcemanager.postgresqlflexibleserver.models.LogicalReplicationOnSourceServer;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrateRolesAndPermissions;
import com.azure.resourcemanager.postgresqlflexibleserver.models.Migration;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationMode;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationOption;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationResourceForPatch;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationSecretParameters;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationSecretParametersForPatch;
import com.azure.resourcemanager.postgresqlflexibleserver.models.MigrationStatus;
import com.azure.resourcemanager.postgresqlflexibleserver.models.OverwriteDatabasesOnTargetServer;
import com.azure.resourcemanager.postgresqlflexibleserver.models.SourceType;
import com.azure.resourcemanager.postgresqlflexibleserver.models.SslMode;
import com.azure.resourcemanager.postgresqlflexibleserver.models.StartDataMigration;
import com.azure.resourcemanager.postgresqlflexibleserver.models.TriggerCutover;
import java.time.OffsetDateTime;
import java.util.Collections;
import java.util.List;
import java.util.Map;

public final class MigrationImpl implements Migration, Migration.Definition, Migration.Update {
    private MigrationInner innerObject;

    private final com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager serviceManager;

    public String id() {
        return this.innerModel().id();
    }

    public String name() {
        return this.innerModel().name();
    }

    public String type() {
        return this.innerModel().type();
    }

    public String location() {
        return this.innerModel().location();
    }

    public Map<String, String> tags() {
        Map<String, String> inner = this.innerModel().tags();
        if (inner != null) {
            return Collections.unmodifiableMap(inner);
        } else {
            return Collections.emptyMap();
        }
    }

    public SystemData systemData() {
        return this.innerModel().systemData();
    }

    public String migrationId() {
        return this.innerModel().migrationId();
    }

    public MigrationStatus currentStatus() {
        return this.innerModel().currentStatus();
    }

    public String migrationInstanceResourceId() {
        return this.innerModel().migrationInstanceResourceId();
    }

    public MigrationMode migrationMode() {
        return this.innerModel().migrationMode();
    }

    public MigrationOption migrationOption() {
        return this.innerModel().migrationOption();
    }

    public SourceType sourceType() {
        return this.innerModel().sourceType();
    }

    public SslMode sslMode() {
        return this.innerModel().sslMode();
    }

    public DbServerMetadata sourceDbServerMetadata() {
        return this.innerModel().sourceDbServerMetadata();
    }

    public DbServerMetadata targetDbServerMetadata() {
        return this.innerModel().targetDbServerMetadata();
    }

    public String sourceDbServerResourceId() {
        return this.innerModel().sourceDbServerResourceId();
    }

    public String sourceDbServerFullyQualifiedDomainName() {
        return this.innerModel().sourceDbServerFullyQualifiedDomainName();
    }

    public String targetDbServerResourceId() {
        return this.innerModel().targetDbServerResourceId();
    }

    public String targetDbServerFullyQualifiedDomainName() {
        return this.innerModel().targetDbServerFullyQualifiedDomainName();
    }

    public MigrationSecretParameters secretParameters() {
        return this.innerModel().secretParameters();
    }

    public List<String> dbsToMigrate() {
        List<String> inner = this.innerModel().dbsToMigrate();
        if (inner != null) {
            return Collections.unmodifiableList(inner);
        } else {
            return Collections.emptyList();
        }
    }

    public LogicalReplicationOnSourceServer setupLogicalReplicationOnSourceDbIfNeeded() {
        return this.innerModel().setupLogicalReplicationOnSourceDbIfNeeded();
    }

    public OverwriteDatabasesOnTargetServer overwriteDbsInTarget() {
        return this.innerModel().overwriteDbsInTarget();
    }

    public OffsetDateTime migrationWindowStartTimeInUtc() {
        return this.innerModel().migrationWindowStartTimeInUtc();
    }

    public OffsetDateTime migrationWindowEndTimeInUtc() {
        return this.innerModel().migrationWindowEndTimeInUtc();
    }

    public MigrateRolesAndPermissions migrateRoles() {
        return this.innerModel().migrateRoles();
    }

    public StartDataMigration startDataMigration() {
        return this.innerModel().startDataMigration();
    }

    public TriggerCutover triggerCutover() {
        return this.innerModel().triggerCutover();
    }

    public List<String> dbsToTriggerCutoverOn() {
        List<String> inner = this.innerModel().dbsToTriggerCutoverOn();
        if (inner != null) {
            return Collections.unmodifiableList(inner);
        } else {
            return Collections.emptyList();
        }
    }

    public Cancel cancel() {
        return this.innerModel().cancel();
    }

    public List<String> dbsToCancelMigrationOn() {
        List<String> inner = this.innerModel().dbsToCancelMigrationOn();
        if (inner != null) {
            return Collections.unmodifiableList(inner);
        } else {
            return Collections.emptyList();
        }
    }

    public Region region() {
        return Region.fromName(this.regionName());
    }

    public String regionName() {
        return this.location();
    }

    public String resourceGroupName() {
        return resourceGroupName;
    }

    public MigrationInner innerModel() {
        return this.innerObject;
    }

    private com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager manager() {
        return this.serviceManager;
    }

    private String resourceGroupName;

    private String serverName;

    private String migrationName;

    private MigrationResourceForPatch updateParameters;

    public MigrationImpl withExistingFlexibleServer(String resourceGroupName, String serverName) {
        this.resourceGroupName = resourceGroupName;
        this.serverName = serverName;
        return this;
    }

    public Migration create() {
        this.innerObject = serviceManager.serviceClient()
            .getMigrations()
            .createWithResponse(resourceGroupName, serverName, migrationName, this.innerModel(), Context.NONE)
            .getValue();
        return this;
    }

    public Migration create(Context context) {
        this.innerObject = serviceManager.serviceClient()
            .getMigrations()
            .createWithResponse(resourceGroupName, serverName, migrationName, this.innerModel(), context)
            .getValue();
        return this;
    }

    MigrationImpl(String name, com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager serviceManager) {
        this.innerObject = new MigrationInner();
        this.serviceManager = serviceManager;
        this.migrationName = name;
    }

    public MigrationImpl update() {
        this.updateParameters = new MigrationResourceForPatch();
        return this;
    }

    public Migration apply() {
        this.innerObject = serviceManager.serviceClient()
            .getMigrations()
            .updateWithResponse(resourceGroupName, serverName, migrationName, updateParameters, Context.NONE)
            .getValue();
        return this;
    }

    public Migration apply(Context context) {
        this.innerObject = serviceManager.serviceClient()
            .getMigrations()
            .updateWithResponse(resourceGroupName, serverName, migrationName, updateParameters, context)
            .getValue();
        return this;
    }

    MigrationImpl(MigrationInner innerObject,
        com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager serviceManager) {
        this.innerObject = innerObject;
        this.serviceManager = serviceManager;
        this.resourceGroupName = ResourceManagerUtils.getValueFromIdByName(innerObject.id(), "resourceGroups");
        this.serverName = ResourceManagerUtils.getValueFromIdByName(innerObject.id(), "flexibleServers");
        this.migrationName = ResourceManagerUtils.getValueFromIdByName(innerObject.id(), "migrations");
    }

    public Migration refresh() {
        this.innerObject = serviceManager.serviceClient()
            .getMigrations()
            .getWithResponse(resourceGroupName, serverName, migrationName, Context.NONE)
            .getValue();
        return this;
    }

    public Migration refresh(Context context) {
        this.innerObject = serviceManager.serviceClient()
            .getMigrations()
            .getWithResponse(resourceGroupName, serverName, migrationName, context)
            .getValue();
        return this;
    }

    public MigrationImpl withRegion(Region location) {
        this.innerModel().withLocation(location.toString());
        return this;
    }

    public MigrationImpl withRegion(String location) {
        this.innerModel().withLocation(location);
        return this;
    }

    public MigrationImpl withTags(Map<String, String> tags) {
        if (isInCreateMode()) {
            this.innerModel().withTags(tags);
            return this;
        } else {
            this.updateParameters.withTags(tags);
            return this;
        }
    }

    public MigrationImpl withMigrationInstanceResourceId(String migrationInstanceResourceId) {
        this.innerModel().withMigrationInstanceResourceId(migrationInstanceResourceId);
        return this;
    }

    public MigrationImpl withMigrationMode(MigrationMode migrationMode) {
        if (isInCreateMode()) {
            this.innerModel().withMigrationMode(migrationMode);
            return this;
        } else {
            this.updateParameters.withMigrationMode(migrationMode);
            return this;
        }
    }

    public MigrationImpl withMigrationOption(MigrationOption migrationOption) {
        this.innerModel().withMigrationOption(migrationOption);
        return this;
    }

    public MigrationImpl withSourceType(SourceType sourceType) {
        this.innerModel().withSourceType(sourceType);
        return this;
    }

    public MigrationImpl withSslMode(SslMode sslMode) {
        this.innerModel().withSslMode(sslMode);
        return this;
    }

    public MigrationImpl withSourceDbServerResourceId(String sourceDbServerResourceId) {
        if (isInCreateMode()) {
            this.innerModel().withSourceDbServerResourceId(sourceDbServerResourceId);
            return this;
        } else {
            this.updateParameters.withSourceDbServerResourceId(sourceDbServerResourceId);
            return this;
        }
    }

    public MigrationImpl withSourceDbServerFullyQualifiedDomainName(String sourceDbServerFullyQualifiedDomainName) {
        if (isInCreateMode()) {
            this.innerModel().withSourceDbServerFullyQualifiedDomainName(sourceDbServerFullyQualifiedDomainName);
            return this;
        } else {
            this.updateParameters.withSourceDbServerFullyQualifiedDomainName(sourceDbServerFullyQualifiedDomainName);
            return this;
        }
    }

    public MigrationImpl withTargetDbServerFullyQualifiedDomainName(String targetDbServerFullyQualifiedDomainName) {
        if (isInCreateMode()) {
            this.innerModel().withTargetDbServerFullyQualifiedDomainName(targetDbServerFullyQualifiedDomainName);
            return this;
        } else {
            this.updateParameters.withTargetDbServerFullyQualifiedDomainName(targetDbServerFullyQualifiedDomainName);
            return this;
        }
    }

    public MigrationImpl withSecretParameters(MigrationSecretParameters secretParameters) {
        this.innerModel().withSecretParameters(secretParameters);
        return this;
    }

    public MigrationImpl withDbsToMigrate(List<String> dbsToMigrate) {
        if (isInCreateMode()) {
            this.innerModel().withDbsToMigrate(dbsToMigrate);
            return this;
        } else {
            this.updateParameters.withDbsToMigrate(dbsToMigrate);
            return this;
        }
    }

    public MigrationImpl withSetupLogicalReplicationOnSourceDbIfNeeded(
        LogicalReplicationOnSourceServer setupLogicalReplicationOnSourceDbIfNeeded) {
        if (isInCreateMode()) {
            this.innerModel().withSetupLogicalReplicationOnSourceDbIfNeeded(setupLogicalReplicationOnSourceDbIfNeeded);
            return this;
        } else {
            this.updateParameters
                .withSetupLogicalReplicationOnSourceDbIfNeeded(setupLogicalReplicationOnSourceDbIfNeeded);
            return this;
        }
    }

    public MigrationImpl withOverwriteDbsInTarget(OverwriteDatabasesOnTargetServer overwriteDbsInTarget) {
        if (isInCreateMode()) {
            this.innerModel().withOverwriteDbsInTarget(overwriteDbsInTarget);
            return this;
        } else {
            this.updateParameters.withOverwriteDbsInTarget(overwriteDbsInTarget);
            return this;
        }
    }

    public MigrationImpl withMigrationWindowStartTimeInUtc(OffsetDateTime migrationWindowStartTimeInUtc) {
        if (isInCreateMode()) {
            this.innerModel().withMigrationWindowStartTimeInUtc(migrationWindowStartTimeInUtc);
            return this;
        } else {
            this.updateParameters.withMigrationWindowStartTimeInUtc(migrationWindowStartTimeInUtc);
            return this;
        }
    }

    public MigrationImpl withMigrationWindowEndTimeInUtc(OffsetDateTime migrationWindowEndTimeInUtc) {
        this.innerModel().withMigrationWindowEndTimeInUtc(migrationWindowEndTimeInUtc);
        return this;
    }

    public MigrationImpl withMigrateRoles(MigrateRolesAndPermissions migrateRoles) {
        if (isInCreateMode()) {
            this.innerModel().withMigrateRoles(migrateRoles);
            return this;
        } else {
            this.updateParameters.withMigrateRoles(migrateRoles);
            return this;
        }
    }

    public MigrationImpl withStartDataMigration(StartDataMigration startDataMigration) {
        if (isInCreateMode()) {
            this.innerModel().withStartDataMigration(startDataMigration);
            return this;
        } else {
            this.updateParameters.withStartDataMigration(startDataMigration);
            return this;
        }
    }

    public MigrationImpl withTriggerCutover(TriggerCutover triggerCutover) {
        if (isInCreateMode()) {
            this.innerModel().withTriggerCutover(triggerCutover);
            return this;
        } else {
            this.updateParameters.withTriggerCutover(triggerCutover);
            return this;
        }
    }

    public MigrationImpl withDbsToTriggerCutoverOn(List<String> dbsToTriggerCutoverOn) {
        if (isInCreateMode()) {
            this.innerModel().withDbsToTriggerCutoverOn(dbsToTriggerCutoverOn);
            return this;
        } else {
            this.updateParameters.withDbsToTriggerCutoverOn(dbsToTriggerCutoverOn);
            return this;
        }
    }

    public MigrationImpl withCancel(Cancel cancel) {
        if (isInCreateMode()) {
            this.innerModel().withCancel(cancel);
            return this;
        } else {
            this.updateParameters.withCancel(cancel);
            return this;
        }
    }

    public MigrationImpl withDbsToCancelMigrationOn(List<String> dbsToCancelMigrationOn) {
        if (isInCreateMode()) {
            this.innerModel().withDbsToCancelMigrationOn(dbsToCancelMigrationOn);
            return this;
        } else {
            this.updateParameters.withDbsToCancelMigrationOn(dbsToCancelMigrationOn);
            return this;
        }
    }

    public MigrationImpl withSecretParameters(MigrationSecretParametersForPatch secretParameters) {
        this.updateParameters.withSecretParameters(secretParameters);
        return this;
    }

    private boolean isInCreateMode() {
        return this.innerModel() == null || this.innerModel().id() == null;
    }
}
