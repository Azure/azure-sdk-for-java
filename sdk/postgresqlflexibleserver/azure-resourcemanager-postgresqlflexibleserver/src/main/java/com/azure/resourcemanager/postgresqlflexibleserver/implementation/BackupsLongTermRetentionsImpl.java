// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.postgresqlflexibleserver.implementation;

import com.azure.core.http.rest.PagedIterable;
import com.azure.core.http.rest.Response;
import com.azure.core.http.rest.SimpleResponse;
import com.azure.core.util.Context;
import com.azure.core.util.logging.ClientLogger;
import com.azure.resourcemanager.postgresqlflexibleserver.fluent.BackupsLongTermRetentionsClient;
import com.azure.resourcemanager.postgresqlflexibleserver.fluent.models.BackupsLongTermRetentionOperationInner;
import com.azure.resourcemanager.postgresqlflexibleserver.fluent.models.BackupsLongTermRetentionResponseInner;
import com.azure.resourcemanager.postgresqlflexibleserver.fluent.models.LtrPreBackupResponseInner;
import com.azure.resourcemanager.postgresqlflexibleserver.models.BackupsLongTermRetentionOperation;
import com.azure.resourcemanager.postgresqlflexibleserver.models.BackupsLongTermRetentionRequest;
import com.azure.resourcemanager.postgresqlflexibleserver.models.BackupsLongTermRetentionResponse;
import com.azure.resourcemanager.postgresqlflexibleserver.models.BackupsLongTermRetentions;
import com.azure.resourcemanager.postgresqlflexibleserver.models.BackupsLongTermRetentionsCheckPrerequisitesResponse;
import com.azure.resourcemanager.postgresqlflexibleserver.models.LtrPreBackupRequest;
import com.azure.resourcemanager.postgresqlflexibleserver.models.LtrPreBackupResponse;

public final class BackupsLongTermRetentionsImpl implements BackupsLongTermRetentions {
    private static final ClientLogger LOGGER = new ClientLogger(BackupsLongTermRetentionsImpl.class);

    private final BackupsLongTermRetentionsClient innerClient;

    private final com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager serviceManager;

    public BackupsLongTermRetentionsImpl(BackupsLongTermRetentionsClient innerClient,
        com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager serviceManager) {
        this.innerClient = innerClient;
        this.serviceManager = serviceManager;
    }

    public Response<LtrPreBackupResponse> checkPrerequisitesWithResponse(String resourceGroupName, String serverName,
        LtrPreBackupRequest parameters, Context context) {
        BackupsLongTermRetentionsCheckPrerequisitesResponse inner
            = this.serviceClient().checkPrerequisitesWithResponse(resourceGroupName, serverName, parameters, context);
        if (inner != null) {
            return new SimpleResponse<>(inner.getRequest(), inner.getStatusCode(), inner.getHeaders(),
                new LtrPreBackupResponseImpl(inner.getValue(), this.manager()));
        } else {
            return null;
        }
    }

    public LtrPreBackupResponse checkPrerequisites(String resourceGroupName, String serverName,
        LtrPreBackupRequest parameters) {
        LtrPreBackupResponseInner inner
            = this.serviceClient().checkPrerequisites(resourceGroupName, serverName, parameters);
        if (inner != null) {
            return new LtrPreBackupResponseImpl(inner, this.manager());
        } else {
            return null;
        }
    }

    public BackupsLongTermRetentionResponse start(String resourceGroupName, String serverName,
        BackupsLongTermRetentionRequest parameters) {
        BackupsLongTermRetentionResponseInner inner
            = this.serviceClient().start(resourceGroupName, serverName, parameters);
        if (inner != null) {
            return new BackupsLongTermRetentionResponseImpl(inner, this.manager());
        } else {
            return null;
        }
    }

    public BackupsLongTermRetentionResponse start(String resourceGroupName, String serverName,
        BackupsLongTermRetentionRequest parameters, Context context) {
        BackupsLongTermRetentionResponseInner inner
            = this.serviceClient().start(resourceGroupName, serverName, parameters, context);
        if (inner != null) {
            return new BackupsLongTermRetentionResponseImpl(inner, this.manager());
        } else {
            return null;
        }
    }

    public Response<BackupsLongTermRetentionOperation> getWithResponse(String resourceGroupName, String serverName,
        String backupName, Context context) {
        Response<BackupsLongTermRetentionOperationInner> inner
            = this.serviceClient().getWithResponse(resourceGroupName, serverName, backupName, context);
        if (inner != null) {
            return new SimpleResponse<>(inner.getRequest(), inner.getStatusCode(), inner.getHeaders(),
                new BackupsLongTermRetentionOperationImpl(inner.getValue(), this.manager()));
        } else {
            return null;
        }
    }

    public BackupsLongTermRetentionOperation get(String resourceGroupName, String serverName, String backupName) {
        BackupsLongTermRetentionOperationInner inner
            = this.serviceClient().get(resourceGroupName, serverName, backupName);
        if (inner != null) {
            return new BackupsLongTermRetentionOperationImpl(inner, this.manager());
        } else {
            return null;
        }
    }

    public PagedIterable<BackupsLongTermRetentionOperation> listByServer(String resourceGroupName, String serverName) {
        PagedIterable<BackupsLongTermRetentionOperationInner> inner
            = this.serviceClient().listByServer(resourceGroupName, serverName);
        return ResourceManagerUtils.mapPage(inner,
            inner1 -> new BackupsLongTermRetentionOperationImpl(inner1, this.manager()));
    }

    public PagedIterable<BackupsLongTermRetentionOperation> listByServer(String resourceGroupName, String serverName,
        Context context) {
        PagedIterable<BackupsLongTermRetentionOperationInner> inner
            = this.serviceClient().listByServer(resourceGroupName, serverName, context);
        return ResourceManagerUtils.mapPage(inner,
            inner1 -> new BackupsLongTermRetentionOperationImpl(inner1, this.manager()));
    }

    private BackupsLongTermRetentionsClient serviceClient() {
        return this.innerClient;
    }

    private com.azure.resourcemanager.postgresqlflexibleserver.PostgreSqlManager manager() {
        return this.serviceManager;
    }
}
