// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.automation.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.automation.AutomationManager;
import com.azure.resourcemanager.automation.models.SoftwareUpdateConfigurationRunListResult;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class SoftwareUpdateConfigurationRunsListWithResponseMockTests {
    @Test
    public void testListWithResponse() throws Exception {
        String responseStr
            = "{\"value\":[{\"name\":\"nrpb\",\"id\":\"mvgoqpleh\",\"properties\":{\"softwareUpdateConfiguration\":{\"name\":\"zdllczdprwnhkgqg\"},\"status\":\"xs\",\"configuredDuration\":\"civrakfrrynjcwmh\",\"osType\":\"mgnukxrke\",\"startTime\":\"2021-07-04T04:39:51Z\",\"endTime\":\"2021-02-20T07:55:04Z\",\"computerCount\":290323401,\"failedCount\":1457582447,\"creationTime\":\"2021-07-03T18:52:43Z\",\"createdBy\":\"dgjtfbcla\",\"lastModifiedTime\":\"2021-10-28T21:42:56Z\",\"lastModifiedBy\":\"ddwnhczb\",\"tasks\":{\"preTask\":{},\"postTask\":{}}}},{\"name\":\"gjtirjwayhic\",\"id\":\"wwvg\",\"properties\":{\"softwareUpdateConfiguration\":{\"name\":\"vlizedvb\"},\"status\":\"bvn\",\"configuredDuration\":\"ge\",\"osType\":\"yqxadyfhbmw\",\"startTime\":\"2021-10-20T23:06:09Z\",\"endTime\":\"2021-08-06T03:45:23Z\",\"computerCount\":1234932882,\"failedCount\":1444830951,\"creationTime\":\"2020-12-28T15:45:25Z\",\"createdBy\":\"hg\",\"lastModifiedTime\":\"2021-11-13T03:48:24Z\",\"lastModifiedBy\":\"sgyzstujrzxr\",\"tasks\":{\"preTask\":{},\"postTask\":{}}}},{\"name\":\"rlduyehiiittugy\",\"id\":\"wrldax\",\"properties\":{\"softwareUpdateConfiguration\":{\"name\":\"azcsozjvx\"},\"status\":\"ciggbnvtxof\",\"configuredDuration\":\"lzy\",\"osType\":\"hoeamoeobdo\",\"startTime\":\"2021-11-20T03:42:02Z\",\"endTime\":\"2021-04-03T18:48:17Z\",\"computerCount\":26863827,\"failedCount\":743272869,\"creationTime\":\"2021-11-09T21:19:56Z\",\"createdBy\":\"hau\",\"lastModifiedTime\":\"2021-06-16T01:35:38Z\",\"lastModifiedBy\":\"wmnfeubtzjyrkwfu\",\"tasks\":{\"preTask\":{},\"postTask\":{}}}},{\"name\":\"rkuumn\",\"id\":\"urhzzf\",\"properties\":{\"softwareUpdateConfiguration\":{\"name\":\"oqusvwlu\"},\"status\":\"pwnibittozt\",\"configuredDuration\":\"qumqvfmwcaddt\",\"osType\":\"txegtvgwyurbelfn\",\"startTime\":\"2021-02-22T08:09:57Z\",\"endTime\":\"2021-10-28T02:39:02Z\",\"computerCount\":1643463354,\"failedCount\":1806208510,\"creationTime\":\"2021-08-25T22:27:24Z\",\"createdBy\":\"bxlayunomirhpf\",\"lastModifiedTime\":\"2021-08-03T15:09:33Z\",\"lastModifiedBy\":\"qlamwmgewayxfl\",\"tasks\":{\"preTask\":{},\"postTask\":{}}}}],\"nextLink\":\"stbh\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AutomationManager manager = AutomationManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        SoftwareUpdateConfigurationRunListResult response = manager.softwareUpdateConfigurationRuns()
            .listWithResponse("bfi", "lhxfnsmycj", "wlyeyz", "udsqcmhnx", "zbuw", "dmac",
                com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("stbh", response.nextLink());
    }
}
