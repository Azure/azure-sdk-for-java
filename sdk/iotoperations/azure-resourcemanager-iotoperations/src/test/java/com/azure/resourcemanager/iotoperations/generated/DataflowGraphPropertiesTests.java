// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.iotoperations.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.iotoperations.models.DataflowGraphConnectionInput;
import com.azure.resourcemanager.iotoperations.models.DataflowGraphConnectionOutput;
import com.azure.resourcemanager.iotoperations.models.DataflowGraphConnectionSchemaSerializationFormat;
import com.azure.resourcemanager.iotoperations.models.DataflowGraphConnectionSchemaSettings;
import com.azure.resourcemanager.iotoperations.models.DataflowGraphNode;
import com.azure.resourcemanager.iotoperations.models.DataflowGraphNodeConnection;
import com.azure.resourcemanager.iotoperations.models.DataflowGraphProperties;
import com.azure.resourcemanager.iotoperations.models.OperationalMode;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class DataflowGraphPropertiesTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        DataflowGraphProperties model = BinaryData.fromString(
            "{\"mode\":\"Enabled\",\"requestDiskPersistence\":\"Disabled\",\"nodes\":[{\"nodeType\":\"DataflowGraphNode\",\"name\":\"yf\"}],\"nodeConnections\":[{\"from\":{\"name\":\"dgqggebdu\",\"schema\":{\"serializationFormat\":\"Avro\",\"schemaRef\":\"qidbqfatpxllrxcy\"}},\"to\":{\"name\":\"moadsuvarmy\"}},{\"from\":{\"name\":\"dmjsjqb\",\"schema\":{\"serializationFormat\":\"Parquet\",\"schemaRef\":\"xrwlyc\"}},\"to\":{\"name\":\"duhpk\"}}],\"provisioningState\":\"Succeeded\",\"healthState\":\"Unknown\"}")
            .toObject(DataflowGraphProperties.class);
        Assertions.assertEquals(OperationalMode.ENABLED, model.mode());
        Assertions.assertEquals(OperationalMode.DISABLED, model.requestDiskPersistence());
        Assertions.assertEquals("yf", model.nodes().get(0).name());
        Assertions.assertEquals("dgqggebdu", model.nodeConnections().get(0).from().name());
        Assertions.assertEquals(DataflowGraphConnectionSchemaSerializationFormat.AVRO,
            model.nodeConnections().get(0).from().schema().serializationFormat());
        Assertions.assertEquals("qidbqfatpxllrxcy", model.nodeConnections().get(0).from().schema().schemaRef());
        Assertions.assertEquals("moadsuvarmy", model.nodeConnections().get(0).to().name());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        DataflowGraphProperties model
            = new DataflowGraphProperties().withMode(OperationalMode.ENABLED)
                .withRequestDiskPersistence(OperationalMode.DISABLED)
                .withNodes(Arrays.asList(new DataflowGraphNode().withName("yf")))
                .withNodeConnections(
                    Arrays
                        .asList(
                            new DataflowGraphNodeConnection()
                                .withFrom(
                                    new DataflowGraphConnectionInput().withName("dgqggebdu")
                                        .withSchema(new DataflowGraphConnectionSchemaSettings()
                                            .withSerializationFormat(
                                                DataflowGraphConnectionSchemaSerializationFormat.AVRO)
                                            .withSchemaRef("qidbqfatpxllrxcy")))
                                .withTo(new DataflowGraphConnectionOutput().withName("moadsuvarmy")),
                            new DataflowGraphNodeConnection()
                                .withFrom(new DataflowGraphConnectionInput().withName("dmjsjqb")
                                    .withSchema(new DataflowGraphConnectionSchemaSettings()
                                        .withSerializationFormat(
                                            DataflowGraphConnectionSchemaSerializationFormat.PARQUET)
                                        .withSchemaRef("xrwlyc")))
                                .withTo(new DataflowGraphConnectionOutput().withName("duhpk"))));
        model = BinaryData.fromObject(model).toObject(DataflowGraphProperties.class);
        Assertions.assertEquals(OperationalMode.ENABLED, model.mode());
        Assertions.assertEquals(OperationalMode.DISABLED, model.requestDiskPersistence());
        Assertions.assertEquals("yf", model.nodes().get(0).name());
        Assertions.assertEquals("dgqggebdu", model.nodeConnections().get(0).from().name());
        Assertions.assertEquals(DataflowGraphConnectionSchemaSerializationFormat.AVRO,
            model.nodeConnections().get(0).from().schema().serializationFormat());
        Assertions.assertEquals("qidbqfatpxllrxcy", model.nodeConnections().get(0).from().schema().schemaRef());
        Assertions.assertEquals("moadsuvarmy", model.nodeConnections().get(0).to().name());
    }
}
