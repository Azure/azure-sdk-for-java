// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.billing.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.billing.BillingManager;
import com.azure.resourcemanager.billing.models.Invoice;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class InvoicesGetByBillingSubscriptionWithResponseMockTests {
    @Test
    public void testGetByBillingSubscriptionWithResponse() throws Exception {
        String responseStr
            = "{\"properties\":{\"amountDue\":{\"currency\":\"cujdzlgyermj\",\"value\":0.44757724},\"azurePrepaymentApplied\":{\"currency\":\"hoqpbfjfcbweabpt\",\"value\":99.95556},\"billedAmount\":{\"currency\":\"uvcgvnomlc\",\"value\":66.38444},\"billedDocumentId\":\"ohuafuclopnemsyl\",\"billingProfileDisplayName\":\"mdoowfrgdmbgbht\",\"billingProfileId\":\"miustkqywabhlg\",\"creditAmount\":{\"currency\":\"kvtzbk\",\"value\":44.105633},\"creditForDocumentId\":\"pf\",\"documents\":[{\"documentNumbers\":[\"judekmxhwz\",\"ehcdfdxthqnztu\",\"ir\"],\"externalUrl\":\"dijdhzkwvuewei\",\"kind\":\"CreditNote\",\"name\":\"lswlxdknxctglzb\",\"url\":\"dfsg\",\"source\":\"Other\"},{\"documentNumbers\":[\"wb\",\"judxzfvna\",\"c\",\"fchnqiyevjehtsea\"],\"externalUrl\":\"xsehflfmabpyz\",\"kind\":\"VoidNote\",\"name\":\"ph\",\"url\":\"tvurtkcepy\",\"source\":\"Other\"},{\"documentNumbers\":[\"bwx\",\"sdisxsrrhryrbb\",\"d\"],\"externalUrl\":\"rjzzuimpi\",\"kind\":\"TaxReceipt\",\"name\":\"btihc\",\"url\":\"mfb\",\"source\":\"Other\"}],\"documentType\":\"Invoice\",\"dueDate\":\"2021-08-12T07:06:46Z\",\"failedPayments\":[{\"date\":\"2021-03-07T20:29:19Z\",\"failedPaymentReason\":\"CardExpired\"},{\"date\":\"2021-08-13T22:49:20Z\",\"failedPaymentReason\":\"BankDeclined\"},{\"date\":\"2021-07-14T06:50:47Z\",\"failedPaymentReason\":\"CardExpired\"}],\"freeAzureCreditApplied\":{\"currency\":\"sichhxqnlmjvpms\",\"value\":26.667011},\"invoiceDate\":\"2021-04-11T07:39:05Z\",\"invoicePeriodEndDate\":\"2021-02-06T21:05:23Z\",\"invoicePeriodStartDate\":\"2021-10-19T14:35:20Z\",\"invoiceType\":\"AzureServices\",\"isMonthlyInvoice\":false,\"payments\":[{\"amount\":{\"currency\":\"zjsnxzljxa\",\"value\":3.5962284},\"date\":\"2021-05-23T07:51:33Z\",\"paymentMethodId\":\"vgyujkxjge\",\"paymentMethodFamily\":\"CreditCard\",\"paymentMethodType\":\"igitra\",\"paymentType\":\"dy\"},{\"amount\":{\"currency\":\"rnbpiddvbxqxo\",\"value\":60.682243},\"date\":\"2021-04-12T05:40:17Z\",\"paymentMethodId\":\"srymzvtzyfkt\",\"paymentMethodFamily\":\"EWallet\",\"paymentMethodType\":\"asnj\",\"paymentType\":\"kiyzlkqyez\"},{\"amount\":{\"currency\":\"krdfd\",\"value\":67.45364},\"date\":\"2021-01-12T17:36:07Z\",\"paymentMethodId\":\"ystltkq\",\"paymentMethodFamily\":\"None\",\"paymentMethodType\":\"iiqajfwzubfg\",\"paymentType\":\"vzbueiydoqb\"},{\"amount\":{\"currency\":\"lxptxhednkzjtrja\",\"value\":34.78672},\"date\":\"2021-08-09T15:49:05Z\",\"paymentMethodId\":\"eix\",\"paymentMethodFamily\":\"DirectDebit\",\"paymentMethodType\":\"gznacmkwcyelj\",\"paymentType\":\"adgzxbwn\"}],\"purchaseOrderNumber\":\"ihctyukmz\",\"rebillDetails\":{\"invoiceDocumentId\":\"khtvughu\",\"creditNoteDocumentId\":\"qlmvnfyfyf\",\"rebillDetails\":{\"invoiceDocumentId\":\"zbd\",\"creditNoteDocumentId\":\"ykiumagfyinmajj\",\"rebillDetails\":{\"invoiceDocumentId\":\"gtwfk\",\"creditNoteDocumentId\":\"cvbzkbebuafbdd\",\"rebillDetails\":{}}}},\"status\":\"Locked\",\"subscriptionDisplayName\":\"nml\",\"subscriptionId\":\"gzzohtag\",\"specialTaxationType\":\"SubtotalLevel\",\"subTotal\":{\"currency\":\"qhqgrksy\",\"value\":20.251633},\"taxAmount\":{\"currency\":\"xzobovsvhbtdgxg\",\"value\":7.0223093},\"totalAmount\":{\"currency\":\"oubvfx\",\"value\":17.71515},\"refundDetails\":{\"requestedOn\":\"2021-07-31T21:52:50Z\",\"approvedOn\":\"2021-07-09T21:33Z\",\"completedOn\":\"2021-03-23T23:53:17Z\",\"amountRequested\":{\"currency\":\"zeaicmvbsjtfqwlb\",\"value\":65.48781},\"amountRefunded\":{\"currency\":\"scgropuqgiscgk\",\"value\":68.70343},\"rebillInvoiceId\":\"ikqlyoorme\",\"transactionCount\":580850984,\"refundStatus\":\"Cancelled\",\"refundOperationId\":\"jyk\",\"refundReason\":\"Other\"}},\"tags\":{\"ulcd\":\"uznbcpiadjslvx\"},\"id\":\"ib\",\"name\":\"viacghygm\",\"type\":\"bivpz\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        BillingManager manager = BillingManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        Invoice response = manager.invoices()
            .getByBillingSubscriptionWithResponse("zxqld", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("uznbcpiadjslvx", response.tags().get("ulcd"));
    }
}
