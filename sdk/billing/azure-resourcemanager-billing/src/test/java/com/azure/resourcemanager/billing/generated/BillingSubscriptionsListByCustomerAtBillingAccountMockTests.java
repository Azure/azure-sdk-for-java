// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.billing.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.billing.BillingManager;
import com.azure.resourcemanager.billing.models.AutoRenew;
import com.azure.resourcemanager.billing.models.BillingSubscription;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class BillingSubscriptionsListByCustomerAtBillingAccountMockTests {
    @Test
    public void testListByCustomerAtBillingAccount() throws Exception {
        String responseStr
            = "{\"value\":[{\"properties\":{\"autoRenew\":\"On\",\"beneficiaryTenantId\":\"sz\",\"beneficiary\":{\"tenantId\":\"ygkxrlfojlclp\",\"objectId\":\"veybodhrvykduum\"},\"billingFrequency\":\"cumjvegp\",\"billingProfileId\":\"tsaujtcoojy\",\"billingPolicies\":{\"xuptsliivmlkw\":\"q\",\"zdekfx\":\"zlinvamtykx\",\"tkdpczeohplrgcnb\":\"sqmzdoz\"},\"billingProfileDisplayName\":\"hvqpkedaxku\",\"billingProfileName\":\"rfjid\",\"consumptionCostCenter\":\"dawe\",\"customerId\":\"avfyihuzsbpw\",\"customerDisplayName\":\"fjcypazwiimd\",\"customerName\":\"gkooagr\",\"displayName\":\"pamesi\",\"enrollmentAccountId\":\"qadewhuwxk\",\"enrollmentAccountDisplayName\":\"iatfamrnaifllxcc\",\"enrollmentAccountSubscriptionDetails\":{\"enrollmentAccountStartDate\":\"2021-09-24T04:28:04Z\",\"subscriptionEnrollmentAccountStatus\":\"TransferredOut\"},\"invoiceSectionId\":\"zwhomydxgtuqbv\",\"invoiceSectionDisplayName\":\"uzihirqvvketydga\",\"invoiceSectionName\":\"ktssgvqxerxrmhr\",\"lastMonthCharges\":{\"currency\":\"gbbjl\",\"value\":34.645718},\"monthToDateCharges\":{\"currency\":\"rxsiyzsyiumtit\",\"value\":56.70846},\"nextBillingCycleDetails\":{\"billingFrequency\":\"vern\"},\"offerId\":\"qpkayqivbigdrqg\",\"productCategory\":\"tboyztgnmu\",\"productType\":\"pwp\",\"productTypeId\":\"m\",\"purchaseDate\":\"2021-06-25T04:25:07Z\",\"quantity\":2374406899966752620,\"reseller\":{\"resellerId\":\"bbdwrje\",\"description\":\"ofeiiewibdtplj\"},\"renewalTermDetails\":{\"billingFrequency\":\"ajokbxxcdk\",\"productId\":\"jwtkftgzl\",\"productTypeId\":\"epmewsjpgbmlbx\",\"skuId\":\"gv\",\"termDuration\":\"p\",\"quantity\":7983017396350517040,\"termEndDate\":\"2021-07-18T03:31:12Z\"},\"skuId\":\"akk\",\"skuDescription\":\"rnaxkczkwohdigey\",\"systemOverrides\":{\"cancellation\":\"NotAllowed\",\"cancellationAllowedEndDate\":\"2021-05-08T10:40:09Z\"},\"resourceUri\":\"modwqbaktvxero\",\"termDuration\":\"zvrnnbegra\",\"termStartDate\":\"2021-11-22T23:15:30Z\",\"termEndDate\":\"2021-05-24T09:39:31Z\",\"provisioningTenantId\":\"ojxgdofmazhk\",\"status\":\"Deleted\",\"operationStatus\":\"LockedForUpdate\",\"provisioningState\":\"Provisioning\",\"subscriptionId\":\"szbwgpmdmwi\",\"suspensionReasons\":[\"vesw\"],\"suspensionReasonDetails\":[{\"effectiveDate\":\"2021-05-15T20:01:07Z\",\"reason\":\"PastDue\"}]},\"tags\":{\"cceeeuquuwczzcuj\":\"dargkwim\",\"ajydjbjgip\":\"xvbkirgknhfwlajw\"},\"id\":\"pewyzhydtkbmtrs\",\"name\":\"plviaigarm\",\"type\":\"wokgcneviccw\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        BillingManager manager = BillingManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        PagedIterable<BillingSubscription> response = manager.billingSubscriptions()
            .listByCustomerAtBillingAccount("wxyvtkzbhiz", "pusddmw", false, "h", "ju", "uqnkushvl",
                915353011531985316L, 29455565835785630L, false, "aqnirmidt", com.azure.core.util.Context.NONE);

        Assertions.assertEquals("dargkwim", response.iterator().next().tags().get("cceeeuquuwczzcuj"));
        Assertions.assertEquals(AutoRenew.ON, response.iterator().next().autoRenew());
        Assertions.assertEquals("sz", response.iterator().next().beneficiaryTenantId());
        Assertions.assertEquals("ygkxrlfojlclp", response.iterator().next().beneficiary().tenantId());
        Assertions.assertEquals("veybodhrvykduum", response.iterator().next().beneficiary().objectId());
        Assertions.assertEquals("cumjvegp", response.iterator().next().billingFrequency());
        Assertions.assertEquals("tsaujtcoojy", response.iterator().next().billingProfileId());
        Assertions.assertEquals("dawe", response.iterator().next().consumptionCostCenter());
        Assertions.assertEquals("avfyihuzsbpw", response.iterator().next().customerId());
        Assertions.assertEquals("pamesi", response.iterator().next().displayName());
        Assertions.assertEquals("zwhomydxgtuqbv", response.iterator().next().invoiceSectionId());
        Assertions.assertEquals("m", response.iterator().next().productTypeId());
        Assertions.assertEquals(2374406899966752620L, response.iterator().next().quantity());
        Assertions.assertEquals("akk", response.iterator().next().skuId());
        Assertions.assertEquals("zvrnnbegra", response.iterator().next().termDuration());
        Assertions.assertEquals("ojxgdofmazhk", response.iterator().next().provisioningTenantId());
    }
}
