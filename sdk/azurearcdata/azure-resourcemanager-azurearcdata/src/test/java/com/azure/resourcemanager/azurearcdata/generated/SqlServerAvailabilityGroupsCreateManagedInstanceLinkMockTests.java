// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.azurearcdata.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.azurearcdata.AzureArcDataManager;
import com.azure.resourcemanager.azurearcdata.models.ArcSqlServerAvailabilityMode;
import com.azure.resourcemanager.azurearcdata.models.ArcSqlServerFailoverMode;
import com.azure.resourcemanager.azurearcdata.models.AutomatedBackupPreference;
import com.azure.resourcemanager.azurearcdata.models.AvailabilityGroupCreateUpdateConfiguration;
import com.azure.resourcemanager.azurearcdata.models.AvailabilityGroupCreateUpdateReplicaConfiguration;
import com.azure.resourcemanager.azurearcdata.models.ClusterType;
import com.azure.resourcemanager.azurearcdata.models.ConnectionAuth;
import com.azure.resourcemanager.azurearcdata.models.DbFailover;
import com.azure.resourcemanager.azurearcdata.models.DistributedAvailabilityGroupCreateUpdateAvailabilityGroupCertificateConfiguration;
import com.azure.resourcemanager.azurearcdata.models.DistributedAvailabilityGroupCreateUpdateAvailabilityGroupConfiguration;
import com.azure.resourcemanager.azurearcdata.models.DistributedAvailabilityGroupCreateUpdateConfiguration;
import com.azure.resourcemanager.azurearcdata.models.DtcSupport;
import com.azure.resourcemanager.azurearcdata.models.FailureConditionLevel;
import com.azure.resourcemanager.azurearcdata.models.ManagedInstanceLinkCreateUpdateConfiguration;
import com.azure.resourcemanager.azurearcdata.models.MiLinkCreateUpdateConfiguration;
import com.azure.resourcemanager.azurearcdata.models.PrimaryAllowConnections;
import com.azure.resourcemanager.azurearcdata.models.SecondaryAllowConnections;
import com.azure.resourcemanager.azurearcdata.models.SeedingMode;
import com.azure.resourcemanager.azurearcdata.models.SqlAvailabilityGroupIpV4AddressesAndMasksPropertiesItem;
import com.azure.resourcemanager.azurearcdata.models.SqlAvailabilityGroupStaticIpListenerProperties;
import com.azure.resourcemanager.azurearcdata.models.SqlServerAvailabilityGroupResource;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class SqlServerAvailabilityGroupsCreateManagedInstanceLinkMockTests {
    @Test
    public void testCreateManagedInstanceLink() throws Exception {
        String responseStr
            = "{\"properties\":{\"availabilityGroupId\":\"vkvebaqsz\",\"serverName\":\"rzl\",\"instanceName\":\"mdqgmihzpimcqr\",\"vmId\":\"xtminklogxsvtzar\",\"collectionTimestamp\":\"2021-09-04T21:50:57Z\",\"info\":{\"failureConditionLevel\":441788103,\"healthCheckTimeout\":371186692,\"automatedBackupPreferenceDescription\":\"cmbjwzzo\",\"version\":1633732747,\"basicFeatures\":false,\"dtcSupport\":true,\"dbFailover\":true,\"isDistributed\":false,\"clusterTypeDescription\":\"pgajsqjce\",\"requiredSynchronizedSecondariesToCommit\":818579433,\"isContained\":false,\"primaryReplica\":\"vqar\",\"primaryRecoveryHealthDescription\":\"xuqreblu\",\"secondaryRecoveryHealthDescription\":\"mbwxsfg\",\"synchronizationHealthDescription\":\"mbvx\",\"replicationPartnerType\":\"AzureSQLManagedInstance\",\"listener\":{\"dnsName\":\"k\",\"ipV4AddressesAndMasks\":[{},{}],\"ipV6Addresses\":[\"btwa\",\"kbavlyt\",\"aaknwfr\"],\"port\":820174977}},\"replicas\":{\"value\":[{\"replicaId\":\"dujdigatoleksc\",\"replicaName\":\"tnanqimwb\",\"replicaResourceId\":\"pdcldpka\",\"configure\":{},\"state\":{}},{\"replicaId\":\"laimouxwk\",\"replicaName\":\"mud\",\"replicaResourceId\":\"coibicziuswswjrk\",\"configure\":{},\"state\":{}},{\"replicaId\":\"hbtqqvyfscyrfwb\",\"replicaName\":\"qvogfuyz\",\"replicaResourceId\":\"bhli\",\"configure\":{},\"state\":{}},{\"replicaId\":\"ecr\",\"replicaName\":\"dlikcdrdaasa\",\"replicaResourceId\":\"obsmf\",\"configure\":{},\"state\":{}}],\"nextLink\":\"j\"},\"databases\":{\"value\":[{\"databaseName\":\"srnawnvzmln\",\"replicaName\":\"ywsxvjabjqqaxu\",\"isLocal\":false,\"isPrimaryReplica\":true,\"synchronizationStateDescription\":\"udndoabhjxw\",\"isCommitParticipant\":true,\"synchronizationHealthDescription\":\"uipmpvks\",\"databaseStateDescription\":\"tnsqxtlt\",\"isSuspended\":true,\"suspendReasonDescription\":\"dpqgfhyrfr\"}],\"nextLink\":\"kldgrcwfcmfc\"},\"provisioningState\":\"Succeeded\"},\"location\":\"ln\",\"tags\":{\"iprnzcalincry\":\"xxgfbbmtlpqagyn\",\"ruqg\":\"xzxaqzibmqimiym\"},\"id\":\"hfupetasvvoqsbpk\",\"name\":\"lanfkgxsya\",\"type\":\"wuzowpuoh\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AzureArcDataManager manager = AzureArcDataManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        SqlServerAvailabilityGroupResource response
            = manager.sqlServerAvailabilityGroups()
                .createManagedInstanceLink("uyld", "hmtybkcgsuthhll",
                    new ManagedInstanceLinkCreateUpdateConfiguration()
                        .withAvailabilityGroup(
                            new AvailabilityGroupCreateUpdateConfiguration().withAvailabilityGroupName("y")
                                .withReplicas(
                                    Arrays
                                        .asList(
                                            new AvailabilityGroupCreateUpdateReplicaConfiguration()
                                                .withServerInstance("exlfciatxtjrrl")
                                                .withEndpointName("dskjhhxdlaj")
                                                .withEndpointUrl("xcxscvslxlh")
                                                .withEndpointAuthenticationMode(
                                                    ConnectionAuth.CERTIFICATE_WINDOWS_KERBEROS)
                                                .withCertificateName("rmukmyjmkxett")
                                                .withEndpointConnectLogin("lojfkqidnqto")
                                                .withAvailabilityMode(ArcSqlServerAvailabilityMode.SYNCHRONOUS_COMMIT)
                                                .withFailoverMode(ArcSqlServerFailoverMode.NONE)
                                                .withSeedingMode(SeedingMode.MANUAL)
                                                .withBackupPriority(1528390277)
                                                .withSecondaryRoleAllowConnections(SecondaryAllowConnections.ALL)
                                                .withSecondaryRoleReadOnlyRoutingUrl("btnqlrngldmbiips")
                                                .withPrimaryRoleAllowConnections(PrimaryAllowConnections.ALL)
                                                .withPrimaryRoleReadOnlyRoutingList(
                                                    Arrays.asList("qkzn", "hhl", "xricctkwmuqq", "ajxeiygle"))
                                                .withSessionTimeout(465675766),
                                            new AvailabilityGroupCreateUpdateReplicaConfiguration()
                                                .withServerInstance("aexhdctrceqnk")
                                                .withEndpointName("upobehdmljz")
                                                .withEndpointUrl("vume")
                                                .withEndpointAuthenticationMode(
                                                    ConnectionAuth.CERTIFICATE_WINDOWS_NEGOTIATE)
                                                .withCertificateName("ibnzp")
                                                .withEndpointConnectLogin("epifexleqirccjc")
                                                .withAvailabilityMode(ArcSqlServerAvailabilityMode.ASYNCHRONOUS_COMMIT)
                                                .withFailoverMode(ArcSqlServerFailoverMode.MANUAL)
                                                .withSeedingMode(SeedingMode.MANUAL)
                                                .withBackupPriority(431973110)
                                                .withSecondaryRoleAllowConnections(SecondaryAllowConnections.READ_ONLY)
                                                .withSecondaryRoleReadOnlyRoutingUrl("czuod")
                                                .withPrimaryRoleAllowConnections(PrimaryAllowConnections.READ_WRITE)
                                                .withPrimaryRoleReadOnlyRoutingList(Arrays.asList("ettepdjxqe",
                                                    "koynuiylpckae", "sedveskwxegqphrg", "nzhctmjtsgh"))
                                                .withSessionTimeout(120239759),
                                            new AvailabilityGroupCreateUpdateReplicaConfiguration()
                                                .withServerInstance("cp")
                                                .withEndpointName("rpzeqac")
                                                .withEndpointUrl("dtzmpype")
                                                .withEndpointAuthenticationMode(ConnectionAuth.WINDOWS_NTLM)
                                                .withCertificateName("zshnuqndaizup")
                                                .withEndpointConnectLogin("huytuszx")
                                                .withAvailabilityMode(ArcSqlServerAvailabilityMode.SYNCHRONOUS_COMMIT)
                                                .withFailoverMode(ArcSqlServerFailoverMode.NONE)
                                                .withSeedingMode(SeedingMode.AUTOMATIC)
                                                .withBackupPriority(239385444)
                                                .withSecondaryRoleAllowConnections(SecondaryAllowConnections.NO)
                                                .withSecondaryRoleReadOnlyRoutingUrl("kvzwydw")
                                                .withPrimaryRoleAllowConnections(PrimaryAllowConnections.READ_WRITE)
                                                .withPrimaryRoleReadOnlyRoutingList(
                                                    Arrays.asList("kgkskjivbsshaj", "fukpeexpgeu", "i"))
                                                .withSessionTimeout(926167439),
                                            new AvailabilityGroupCreateUpdateReplicaConfiguration()
                                                .withServerInstance("itrdexy")
                                                .withEndpointName("nofnin")
                                                .withEndpointUrl("bzsx")
                                                .withEndpointAuthenticationMode(
                                                    ConnectionAuth.WINDOWS_NEGOTIATE_CERTIFICATE)
                                                .withCertificateName("rsmpcbbprtuga")
                                                .withEndpointConnectLogin("zbcyksiv")
                                                .withAvailabilityMode(ArcSqlServerAvailabilityMode.SYNCHRONOUS_COMMIT)
                                                .withFailoverMode(ArcSqlServerFailoverMode.AUTOMATIC)
                                                .withSeedingMode(SeedingMode.AUTOMATIC)
                                                .withBackupPriority(1295053346)
                                                .withSecondaryRoleAllowConnections(SecondaryAllowConnections.ALL)
                                                .withSecondaryRoleReadOnlyRoutingUrl("rftsjcwjjxs")
                                                .withPrimaryRoleAllowConnections(PrimaryAllowConnections.ALL)
                                                .withPrimaryRoleReadOnlyRoutingList(Arrays.asList("vifdxkecifhocjx"))
                                                .withSessionTimeout(1807892496)))
                                .withDatabases(Arrays.asList("zrvtx", "cmufunlcpxxv"))
                                .withAutomatedBackupPreference(AutomatedBackupPreference.SECONDARY_ONLY)
                                .withFailureConditionLevel(FailureConditionLevel.FIVE)
                                .withHealthCheckTimeout(1262228006)
                                .withDbFailover(DbFailover.ON)
                                .withDtcSupport(DtcSupport.PER_DB)
                                .withRequiredSynchronizedSecondariesToCommit(749074801)
                                .withClusterType(ClusterType.NONE)
                                .withListener(new SqlAvailabilityGroupStaticIpListenerProperties().withDnsName("glpm")
                                    .withIpV4AddressesAndMasks(Arrays.asList(
                                        new SqlAvailabilityGroupIpV4AddressesAndMasksPropertiesItem()
                                            .withIpAddress("ueljtiahxmfqryar")
                                            .withMask("x"),
                                        new SqlAvailabilityGroupIpV4AddressesAndMasksPropertiesItem()
                                            .withIpAddress("bglcjkayspthzodu")
                                            .withMask("lmjtg"),
                                        new SqlAvailabilityGroupIpV4AddressesAndMasksPropertiesItem()
                                            .withIpAddress("ioskkfmkmfdjxyxg")
                                            .withMask("kqvjcteoedlr"),
                                        new SqlAvailabilityGroupIpV4AddressesAndMasksPropertiesItem()
                                            .withIpAddress("skkzpxvjnzdpvo")
                                            .withMask("jhpcn")))
                                    .withIpV6Addresses(Arrays.asList("zf", "nggy", "e", "vzilmhiv"))
                                    .withPort(2062729988)))
                        .withDistributedAvailabilityGroup(new DistributedAvailabilityGroupCreateUpdateConfiguration()
                            .withAvailabilityGroupName("ncknrzdajlsk")
                            .withPrimaryAvailabilityGroup(
                                new DistributedAvailabilityGroupCreateUpdateAvailabilityGroupConfiguration()
                                    .withAvailabilityGroup("jxul")
                                    .withListenerUrl("ucyrt")
                                    .withAvailabilityMode(ArcSqlServerAvailabilityMode.ASYNCHRONOUS_COMMIT)
                                    .withFailoverMode(ArcSqlServerFailoverMode.MANUAL)
                                    .withSeedingMode(SeedingMode.MANUAL)
                                    .withCertificateConfiguration(
                                        new DistributedAvailabilityGroupCreateUpdateAvailabilityGroupCertificateConfiguration()
                                            .withCertificateName("cje")))
                            .withSecondaryAvailabilityGroup(
                                new DistributedAvailabilityGroupCreateUpdateAvailabilityGroupConfiguration()
                                    .withAvailabilityGroup("ehokamvfej")
                                    .withListenerUrl("nttmbq")
                                    .withAvailabilityMode(ArcSqlServerAvailabilityMode.SYNCHRONOUS_COMMIT)
                                    .withFailoverMode(ArcSqlServerFailoverMode.AUTOMATIC)
                                    .withSeedingMode(SeedingMode.MANUAL)
                                    .withCertificateConfiguration(
                                        new DistributedAvailabilityGroupCreateUpdateAvailabilityGroupCertificateConfiguration()
                                            .withCertificateName("kpysthhzagjf"))))
                        .withMiLinkConfiguration(
                            new MiLinkCreateUpdateConfiguration().withInstanceAvailabilityGroupName("rlhgenuze")),
                    com.azure.core.util.Context.NONE);

        Assertions.assertEquals("ln", response.location());
        Assertions.assertEquals("xxgfbbmtlpqagyn", response.tags().get("iprnzcalincry"));
        Assertions.assertEquals(441788103, response.properties().info().failureConditionLevel());
        Assertions.assertEquals(371186692, response.properties().info().healthCheckTimeout());
        Assertions.assertFalse(response.properties().info().basicFeatures());
        Assertions.assertTrue(response.properties().info().dtcSupport());
        Assertions.assertTrue(response.properties().info().dbFailover());
        Assertions.assertFalse(response.properties().info().isDistributed());
        Assertions.assertEquals(818579433, response.properties().info().requiredSynchronizedSecondariesToCommit());
        Assertions.assertFalse(response.properties().info().isContained());
        Assertions.assertEquals("k", response.properties().info().listener().dnsName());
        Assertions.assertEquals("btwa", response.properties().info().listener().ipV6Addresses().get(0));
        Assertions.assertEquals(820174977, response.properties().info().listener().port());
        Assertions.assertEquals("tnanqimwb", response.properties().replicas().value().get(0).replicaName());
        Assertions.assertEquals("pdcldpka", response.properties().replicas().value().get(0).replicaResourceId());
        Assertions.assertEquals("srnawnvzmln", response.properties().databases().value().get(0).databaseName());
    }
}
