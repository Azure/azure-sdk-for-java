// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.search.documents.generated;

import com.azure.search.documents.indexes.models.DataChangeDetectionPolicy;
import com.azure.search.documents.indexes.models.DataDeletionDetectionPolicy;
import com.azure.search.documents.indexes.models.DataSourceCredentials;
import com.azure.search.documents.indexes.models.HighWaterMarkChangeDetectionPolicy;
import com.azure.search.documents.indexes.models.IndexerPermissionOption;
import com.azure.search.documents.indexes.models.SearchIndexerDataContainer;
import com.azure.search.documents.indexes.models.SearchIndexerDataIdentity;
import com.azure.search.documents.indexes.models.SearchIndexerDataNoneIdentity;
import com.azure.search.documents.indexes.models.SearchIndexerDataSourceConnection;
import com.azure.search.documents.indexes.models.SearchIndexerDataSourceType;
import com.azure.search.documents.indexes.models.SoftDeleteColumnDeletionDetectionPolicy;
import java.util.List;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Disabled;
import org.junit.jupiter.api.Test;

@Disabled
public final class SearchServiceCreateDataSourceTests extends SearchClientTestBase {
    @Test
    @Disabled
    public void testSearchServiceCreateDataSourceTests() {
        // method invocation
        SearchIndexerDataSourceConnection response = searchIndexerClient.createDataSourceConnection(
            new SearchIndexerDataSourceConnection("tempdatasource", SearchIndexerDataSourceType.AZURE_BLOB,
                new DataSourceCredentials().setConnectionString(
                    "DefaultEndpointsProtocol=https;AccountName=myAccountName;AccountKey=myAccountKey;EndpointSuffix=core.windows.net "),
                new SearchIndexerDataContainer("doc-extraction-skillset").setQuery("E2E_Dsat"))
                    .setDescription("My Azure Blob data source.")
                    .setIdentity(new SearchIndexerDataNoneIdentity())
                    .setDataChangeDetectionPolicy(
                        new HighWaterMarkChangeDetectionPolicy("metadata_storage_last_modified"))
                    .setDataDeletionDetectionPolicy(
                        new SoftDeleteColumnDeletionDetectionPolicy().setSoftDeleteColumnName("isDeleted")
                            .setSoftDeleteMarkerValue("true")));

        // response assertion
        Assertions.assertNotNull(response);
        // verify property "name"
        Assertions.assertEquals("tempdatasource", response.getName());
        // verify property "description"
        Assertions.assertEquals("My Azure Blob data source.", response.getDescription());
        // verify property "type"
        Assertions.assertEquals(SearchIndexerDataSourceType.AZURE_BLOB, response.getType());
        // verify property "credentials"
        DataSourceCredentials responseCredentials = response.getCredentials();
        Assertions.assertNotNull(responseCredentials);
        Assertions.assertEquals(
            "DefaultEndpointsProtocol=https;AccountName=myAccountName;AccountKey=myAccountKey;EndpointSuffix=core.windows.net ",
            responseCredentials.getConnectionString());
        // verify property "container"
        SearchIndexerDataContainer responseContainer = response.getContainer();
        Assertions.assertNotNull(responseContainer);
        Assertions.assertEquals("doc-extraction-skillset", responseContainer.getName());
        Assertions.assertEquals("E2E_Dsat", responseContainer.getQuery());
        // verify property "identity"
        SearchIndexerDataIdentity responseIdentity = response.getIdentity();
        Assertions.assertNotNull(responseIdentity);
        Assertions.assertEquals("#Microsoft.Azure.Search.DataNoneIdentity", responseIdentity.getOdataType());
        // verify property "indexerPermissionOptions"
        List<IndexerPermissionOption> responseIndexerPermissionOptions = response.getIndexerPermissionOptions();
        Assertions.assertEquals(0, responseIndexerPermissionOptions.size());
        // verify property "dataChangeDetectionPolicy"
        DataChangeDetectionPolicy responseDataChangeDetectionPolicy = response.getDataChangeDetectionPolicy();
        Assertions.assertNotNull(responseDataChangeDetectionPolicy);
        Assertions.assertEquals("#Microsoft.Azure.Search.HighWaterMarkChangeDetectionPolicy",
            responseDataChangeDetectionPolicy.getOdataType());
        // verify property "dataDeletionDetectionPolicy"
        DataDeletionDetectionPolicy responseDataDeletionDetectionPolicy = response.getDataDeletionDetectionPolicy();
        Assertions.assertNotNull(responseDataDeletionDetectionPolicy);
        Assertions.assertEquals("#Microsoft.Azure.Search.SoftDeleteColumnDeletionDetectionPolicy",
            responseDataDeletionDetectionPolicy.getOdataType());
        // verify property "eTag"
        Assertions.assertEquals("0x1234568AE7E58A1", response.getETag());
    }
}
