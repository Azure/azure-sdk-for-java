// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.search.documents.generated;

import com.azure.identity.DefaultAzureCredentialBuilder;
import com.azure.search.documents.knowledgebase.KnowledgeBaseRetrievalClient;
import com.azure.search.documents.knowledgebase.KnowledgeBaseRetrievalClientBuilder;
import com.azure.search.documents.knowledgebase.models.KnowledgeBaseMessage;
import com.azure.search.documents.knowledgebase.models.KnowledgeBaseMessageTextContent;
import com.azure.search.documents.knowledgebase.models.KnowledgeBaseRetrievalRequest;
import com.azure.search.documents.knowledgebase.models.KnowledgeBaseRetrievalResponse;
import com.azure.search.documents.knowledgebase.models.KnowledgeRetrievalLowReasoningEffort;
import com.azure.search.documents.knowledgebase.models.KnowledgeRetrievalOutputMode;
import com.azure.search.documents.knowledgebase.models.SearchIndexKnowledgeSourceParams;
import java.util.Arrays;

public class KnowledgeBaseRetrieve {
    public static void main(String[] args) {
        KnowledgeBaseRetrievalClient knowledgeBaseRetrievalClient
            = new KnowledgeBaseRetrievalClientBuilder().credential(new DefaultAzureCredentialBuilder().build())
                .endpoint("https://previewexampleservice.search.windows.net")
                .buildClient();
        // BEGIN:com.azure.search.documents.generated.retrieve.knowledge-base-retrieve
        KnowledgeBaseRetrievalResponse response = knowledgeBaseRetrievalClient.retrieve("base-preview-test",
            new KnowledgeBaseRetrievalRequest()
                .setMessages(Arrays
                    .asList(new KnowledgeBaseMessage(Arrays.asList(new KnowledgeBaseMessageTextContent("hello world")))
                        .setRole("user")))
                .setMaxRuntimeInSeconds(60)
                .setMaxOutputSize(100000)
                .setRetrievalReasoningEffort(new KnowledgeRetrievalLowReasoningEffort())
                .setIncludeActivity(true)
                .setOutputMode(KnowledgeRetrievalOutputMode.ANSWER_SYNTHESIS)
                .setKnowledgeSourceParams(
                    Arrays.asList(new SearchIndexKnowledgeSourceParams("ks-preview-test").setIncludeReferences(true)
                        .setIncludeReferenceSourceData(true)
                        .setAlwaysQuerySource(false)
                        .setRerankerThreshold(2.1D)
                        .setFilterAddOn("foo eq bar"))),
            null);
        // END:com.azure.search.documents.generated.retrieve.knowledge-base-retrieve
    }
}
