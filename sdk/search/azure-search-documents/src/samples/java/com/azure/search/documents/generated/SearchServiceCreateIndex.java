// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.search.documents.generated;

import com.azure.identity.DefaultAzureCredentialBuilder;
import com.azure.search.documents.indexes.SearchIndexClient;
import com.azure.search.documents.indexes.SearchIndexClientBuilder;
import com.azure.search.documents.indexes.models.AIFoundryModelCatalogName;
import com.azure.search.documents.indexes.models.AsciiFoldingTokenFilter;
import com.azure.search.documents.indexes.models.AzureMachineLearningParameters;
import com.azure.search.documents.indexes.models.AzureMachineLearningVectorizer;
import com.azure.search.documents.indexes.models.AzureOpenAIModelName;
import com.azure.search.documents.indexes.models.AzureOpenAIVectorizer;
import com.azure.search.documents.indexes.models.AzureOpenAIVectorizerParameters;
import com.azure.search.documents.indexes.models.BM25SimilarityAlgorithm;
import com.azure.search.documents.indexes.models.BinaryQuantizationCompression;
import com.azure.search.documents.indexes.models.CharFilterName;
import com.azure.search.documents.indexes.models.CorsOptions;
import com.azure.search.documents.indexes.models.CustomAnalyzer;
import com.azure.search.documents.indexes.models.CustomNormalizer;
import com.azure.search.documents.indexes.models.HnswAlgorithmConfiguration;
import com.azure.search.documents.indexes.models.HnswParameters;
import com.azure.search.documents.indexes.models.LexicalAnalyzerName;
import com.azure.search.documents.indexes.models.LexicalTokenizerName;
import com.azure.search.documents.indexes.models.LuceneStandardTokenizerV2;
import com.azure.search.documents.indexes.models.MappingCharFilter;
import com.azure.search.documents.indexes.models.PermissionFilter;
import com.azure.search.documents.indexes.models.RankingOrder;
import com.azure.search.documents.indexes.models.RescoringOptions;
import com.azure.search.documents.indexes.models.ScalarQuantizationCompression;
import com.azure.search.documents.indexes.models.ScalarQuantizationParameters;
import com.azure.search.documents.indexes.models.ScoringProfile;
import com.azure.search.documents.indexes.models.SearchField;
import com.azure.search.documents.indexes.models.SearchFieldDataType;
import com.azure.search.documents.indexes.models.SearchIndex;
import com.azure.search.documents.indexes.models.SearchIndexPermissionFilterOption;
import com.azure.search.documents.indexes.models.SearchIndexerDataNoneIdentity;
import com.azure.search.documents.indexes.models.SearchSuggester;
import com.azure.search.documents.indexes.models.SemanticConfiguration;
import com.azure.search.documents.indexes.models.SemanticField;
import com.azure.search.documents.indexes.models.SemanticPrioritizedFields;
import com.azure.search.documents.indexes.models.SemanticSearch;
import com.azure.search.documents.indexes.models.TagScoringFunction;
import com.azure.search.documents.indexes.models.TagScoringParameters;
import com.azure.search.documents.indexes.models.TextWeights;
import com.azure.search.documents.indexes.models.TokenFilterName;
import com.azure.search.documents.indexes.models.VectorSearch;
import com.azure.search.documents.indexes.models.VectorSearchAlgorithmMetric;
import com.azure.search.documents.indexes.models.VectorSearchCompressionRescoreStorageMethod;
import com.azure.search.documents.indexes.models.VectorSearchCompressionTarget;
import com.azure.search.documents.indexes.models.VectorSearchProfile;
import com.azure.search.documents.indexes.models.WebApiVectorizer;
import com.azure.search.documents.indexes.models.WebApiVectorizerParameters;
import java.time.Duration;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;

public class SearchServiceCreateIndex {
    public static void main(String[] args) {
        SearchIndexClient searchIndexClient
            = new SearchIndexClientBuilder().credential(new DefaultAzureCredentialBuilder().build())
                .endpoint("https://previewexampleservice.search.windows.net")
                .buildClient();
        // BEGIN:com.azure.search.documents.generated.create-index.search-service-create-index
        SearchIndex response = searchIndexClient.createIndex(new SearchIndex("temp-preview-test", Arrays.asList(
            new SearchField("id", SearchFieldDataType.STRING).setKey(true).setSortable(true),
            new SearchField("vector1", SearchFieldDataType.fromString("Collection(Edm.Single)")).setRetrievable(true)
                .setSearchable(true)
                .setVectorSearchDimensions(20)
                .setVectorSearchProfileName("config1"),
            new SearchField("vector1b", SearchFieldDataType.fromString("Collection(Edm.Single)")).setRetrievable(true)
                .setSearchable(true)
                .setVectorSearchDimensions(10)
                .setVectorSearchProfileName("config2"),
            new SearchField("vector2", SearchFieldDataType.fromString("Collection(Edm.Single)")).setRetrievable(true)
                .setSearchable(true)
                .setVectorSearchDimensions(5)
                .setVectorSearchProfileName("config3"),
            new SearchField("vector3", SearchFieldDataType.fromString("Collection(Edm.Single)")).setRetrievable(true)
                .setSearchable(true)
                .setVectorSearchDimensions(5)
                .setVectorSearchProfileName("config3"),
            new SearchField("vector22", SearchFieldDataType.fromString("Collection(Edm.Single)")).setRetrievable(true)
                .setSearchable(true)
                .setVectorSearchDimensions(10)
                .setVectorSearchProfileName("config2"),
            new SearchField("vector4", SearchFieldDataType.fromString("Collection(Edm.Single)")).setRetrievable(true)
                .setSearchable(true)
                .setVectorSearchDimensions(32)
                .setVectorSearchProfileName("config4"),
            new SearchField("name", SearchFieldDataType.STRING).setRetrievable(true)
                .setSearchable(true)
                .setFilterable(true)
                .setSortable(true)
                .setFacetable(true)
                .setAnalyzerName(LexicalAnalyzerName.EN_LUCENE),
            new SearchField("description", SearchFieldDataType.STRING).setRetrievable(true)
                .setSearchable(true)
                .setFilterable(true)
                .setSortable(true)
                .setFacetable(true)
                .setAnalyzerName(LexicalAnalyzerName.STANDARD_LUCENE),
            new SearchField("category", SearchFieldDataType.STRING).setRetrievable(true)
                .setSearchable(true)
                .setFilterable(true)
                .setSortable(true)
                .setFacetable(true)
                .setAnalyzerName(LexicalAnalyzerName.EN_LUCENE),
            new SearchField("ownerId", SearchFieldDataType.STRING).setRetrievable(true)
                .setSearchable(true)
                .setFilterable(true)
                .setSortable(true)
                .setFacetable(true)
                .setAnalyzerName(LexicalAnalyzerName.EN_LUCENE),
            new SearchField("price", SearchFieldDataType.DOUBLE).setRetrievable(true)
                .setFilterable(true)
                .setSortable(true)
                .setFacetable(true),
            new SearchField("permissionFilters", SearchFieldDataType.fromString("Collection(Edm.String)"))
                .setRetrievable(true)
                .setFilterable(true)
                .setSortable(false)
                .setFacetable(true)
                .setPermissionFilter(PermissionFilter.USER_IDS),
            new SearchField("sensitivityLabels", SearchFieldDataType.fromString("Collection(Edm.String)"))
                .setRetrievable(true)
                .setFilterable(true)
                .setSortable(false)
                .setFacetable(true)
                .setSensitivityLabel(true)))
                    .setDescription("description")
                    .setScoringProfiles(Arrays.asList(new ScoringProfile("stringFieldBoost")
                        .setTextWeights(
                            new TextWeights(mapOf("name", 3.0, "description", 1.0, "category", 2.0, "ownerId", 1.0)))
                        .setFunctions(Arrays
                            .asList(new TagScoringFunction("category", 2.0, new TagScoringParameters("categoryTag"))))))
                    .setDefaultScoringProfile("stringFieldBoost")
                    .setCorsOptions(
                        new CorsOptions(Arrays.asList("https://www.example.com/foo")).setMaxAgeInSeconds(10L))
                    .setSuggesters(Arrays.asList(new SearchSuggester("sg", Arrays.asList("category", "ownerId"))))
                    .setAnalyzers(Arrays.asList(new CustomAnalyzer("tagsAnalyzer", LexicalTokenizerName.STANDARD)
                        .setTokenFilters(Arrays.asList(TokenFilterName.COMMON_GRAM))
                        .setCharFilters(Arrays.asList(CharFilterName.HTML_STRIP))))
                    .setTokenizers(Arrays.asList(new LuceneStandardTokenizerV2("my_tokenizer").setMaxTokenLength(100)))
                    .setTokenFilters(
                        Arrays.asList(new AsciiFoldingTokenFilter("my_tokenFilter").setPreserveOriginal(false)))
                    .setCharFilters(Arrays.asList(new MappingCharFilter("my_mapping", Arrays.asList(".=>,", "_=>-"))))
                    .setNormalizers(Arrays.asList(new CustomNormalizer("my_normalizer")
                        .setTokenFilters(Arrays.asList(TokenFilterName.fromString("my_tokenFilter")))
                        .setCharFilters(Arrays.asList(CharFilterName.fromString("my_mapping")))))
                    .setSimilarity(new BM25SimilarityAlgorithm().setK1(10.0D).setB(0.1D))
                    .setSemanticSearch(new SemanticSearch().setDefaultConfigurationName("testconfig")
                        .setConfigurations(Arrays.asList(new SemanticConfiguration("testconfig",
                            new SemanticPrioritizedFields().setTitleField(new SemanticField("category"))
                                .setContentFields(Arrays.asList(new SemanticField("description")))
                                .setKeywordsFields(Arrays.asList(new SemanticField("ownerId"))))
                                    .setRankingOrder(RankingOrder.BOOSTED_RERANKER_SCORE)
                                    .setFlightingOptIn(true))))
                    .setVectorSearch(new VectorSearch()
                        .setProfiles(Arrays.asList(
                            new VectorSearchProfile("config1", "cosine").setVectorizerName("openai")
                                .setCompressionName("mySQ8"),
                            new VectorSearchProfile("config2", "euclidean").setVectorizerName("custom-web-api")
                                .setCompressionName("mySQ8"),
                            new VectorSearchProfile("config3", "dotProduct").setVectorizerName("custom-web-api")
                                .setCompressionName("myBQC"),
                            new VectorSearchProfile("config4", "dotProduct").setVectorizerName("custom-web-api")
                                .setCompressionName("myBQWithoutOriginals")))
                        .setAlgorithms(Arrays.asList(
                            new HnswAlgorithmConfiguration("cosine")
                                .setParameters(new HnswParameters().setMetric(VectorSearchAlgorithmMetric.COSINE)),
                            new HnswAlgorithmConfiguration("euclidean")
                                .setParameters(new HnswParameters().setMetric(VectorSearchAlgorithmMetric.EUCLIDEAN)),
                            new HnswAlgorithmConfiguration("dotProduct").setParameters(
                                new HnswParameters().setMetric(VectorSearchAlgorithmMetric.DOT_PRODUCT))))
                        .setVectorizers(Arrays.asList(
                            new AzureOpenAIVectorizer("openai").setParameters(new AzureOpenAIVectorizerParameters()
                                .setResourceUrl("https://test-sample.openai.azure.com/")
                                .setDeploymentName("model")
                                .setApiKey("fakeTokenPlaceholder")
                                .setModelName(AzureOpenAIModelName.TEXT_EMBEDDING3LARGE)),
                            new WebApiVectorizer("custom-web-api").setWebApiParameters(
                                new WebApiVectorizerParameters().setUrl("https://my-custom-endpoint.org/")
                                    .setHttpHeaders(mapOf("header1", "value1", "header2", "value2"))
                                    .setHttpMethod("POST")
                                    .setTimeout(Duration.parse("PT1M"))
                                    .setAuthResourceId("api://f89d1c93-58a7-4b07-9a5b-5f89048b927b")
                                    .setAuthIdentity(new SearchIndexerDataNoneIdentity())),
                            new AzureMachineLearningVectorizer("aml")
                                .setAMLParameters(new AzureMachineLearningParameters("https://my-custom-endpoint.org/")
                                    .setResourceId("aml resource id")
                                    .setTimeout(Duration.parse("PT1M"))
                                    .setRegion("aml region")
                                    .setModelName(
                                        AIFoundryModelCatalogName.OPEN_AICLIPIMAGE_TEXT_EMBEDDINGS_VIT_BASE_PATCH32)),
                            new AzureMachineLearningVectorizer("aml-cohere")
                                .setAMLParameters(new AzureMachineLearningParameters("https://my-custom-endpoint.org/")
                                    .setResourceId("aml resource id")
                                    .setTimeout(Duration.parse("PT1M"))
                                    .setRegion("aml region")
                                    .setModelName(AIFoundryModelCatalogName.COHERE_EMBED_V4))))
                        .setCompressions(Arrays.asList(
                            new ScalarQuantizationCompression("mySQ8")
                                .setRescoringOptions(new RescoringOptions().setEnableRescoring(true)
                                    .setDefaultOversampling(10.0D)
                                    .setRescoreStorageMethod(
                                        VectorSearchCompressionRescoreStorageMethod.PRESERVE_ORIGINALS))
                                .setTruncationDimension(2)
                                .setParameters(new ScalarQuantizationParameters()
                                    .setQuantizedDataType(VectorSearchCompressionTarget.INT8)),
                            new BinaryQuantizationCompression("myBQC")
                                .setRescoringOptions(new RescoringOptions().setEnableRescoring(true)
                                    .setDefaultOversampling(10.0D)
                                    .setRescoreStorageMethod(
                                        VectorSearchCompressionRescoreStorageMethod.PRESERVE_ORIGINALS))
                                .setTruncationDimension(2),
                            new BinaryQuantizationCompression("myBQWithoutOriginals")
                                .setRescoringOptions(new RescoringOptions().setEnableRescoring(true)
                                    .setDefaultOversampling(10.0D)
                                    .setRescoreStorageMethod(
                                        VectorSearchCompressionRescoreStorageMethod.DISCARD_ORIGINALS))
                                .setTruncationDimension(2))))
                    .setPermissionFilterOption(SearchIndexPermissionFilterOption.ENABLED)
                    .setPurviewEnabled(true));
        // END:com.azure.search.documents.generated.create-index.search-service-create-index
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
