// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.search.documents.generated;

import com.azure.identity.DefaultAzureCredentialBuilder;
import com.azure.search.documents.indexes.SearchIndexerClient;
import com.azure.search.documents.indexes.SearchIndexerClientBuilder;
import com.azure.search.documents.indexes.models.DataSourceCredentials;
import com.azure.search.documents.indexes.models.HighWaterMarkChangeDetectionPolicy;
import com.azure.search.documents.indexes.models.SearchIndexerDataContainer;
import com.azure.search.documents.indexes.models.SearchIndexerDataNoneIdentity;
import com.azure.search.documents.indexes.models.SearchIndexerDataSourceConnection;
import com.azure.search.documents.indexes.models.SearchIndexerDataSourceType;
import com.azure.search.documents.indexes.models.SoftDeleteColumnDeletionDetectionPolicy;

public class SearchServiceCreateDataSource {
    public static void main(String[] args) {
        SearchIndexerClient searchIndexerClient
            = new SearchIndexerClientBuilder().credential(new DefaultAzureCredentialBuilder().build())
                .endpoint("https://previewexampleservice.search.windows.net")
                .buildClient();
        // BEGIN:com.azure.search.documents.generated.create-data-source-connection.search-service-create-data-source
        SearchIndexerDataSourceConnection response = searchIndexerClient.createDataSourceConnection(
            new SearchIndexerDataSourceConnection("tempdatasource", SearchIndexerDataSourceType.AZURE_BLOB,
                new DataSourceCredentials().setConnectionString(
                    "DefaultEndpointsProtocol=https;AccountName=myAccountName;AccountKey=myAccountKey;EndpointSuffix=core.windows.net "),
                new SearchIndexerDataContainer("doc-extraction-skillset").setQuery("E2E_Dsat"))
                    .setDescription("My Azure Blob data source.")
                    .setIdentity(new SearchIndexerDataNoneIdentity())
                    .setDataChangeDetectionPolicy(
                        new HighWaterMarkChangeDetectionPolicy("metadata_storage_last_modified"))
                    .setDataDeletionDetectionPolicy(
                        new SoftDeleteColumnDeletionDetectionPolicy().setSoftDeleteColumnName("isDeleted")
                            .setSoftDeleteMarkerValue("true")));
        // END:com.azure.search.documents.generated.create-data-source-connection.search-service-create-data-source
    }
}
