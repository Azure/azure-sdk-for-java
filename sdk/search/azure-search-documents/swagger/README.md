# Azure Search Documents for Java
    
> see https://aka.ms/autorest

This is the AutoRest configuration file for SearchServiceClient and SearchIndexClient.
---
## Getting Started 

To build the SDK for SearchServiceClient and SearchIndexClient, simply [Install AutoRest](https://aka.ms/autorest) and in this folder, run:

> `autorest`

To see additional help and options, run:

> `autorest --help`

### Setup
```ps
Fork and clone https://github.com/Azure/autorest.java 
git checkout v4
git submodule update --init --recursive
mvn package -Dlocal -DskipTests
npm install
npm install -g autorest
```

### Generation

There are two swaggers for search: index and service. They always under same package version, e.g. `--tag=package-2019-05-searchindex-preview` and `--tag=package-2019-05-searchservice-preview`.

```ps
cd <swagger-folder>
autorest --use=C:/work/autorest.java
```

e.g.
```ps
cd <swagger-folder>
autorest --use=C:/work/autorest.java --tag=package-2020-06-searchindex
autorest --use=C:/work/autorest.java --tag=package-2020-06-searchservice
```
## Configuration

### Basic Information 
These are the global settings for SearchServiceClient and SearchIndexClient.

``` yaml
opt-in-extensible-enums: true
openapi-type: data-plane
```
### Tag: package-2020-06-searchservice

These settings apply only when `--tag=package-2020-06-searchservice` is specified on the command line.

``` yaml $(tag) == 'package-2020-06-searchservice'
namespace: com.azure.search.documents.indexes
input-file:
- https://raw.githubusercontent.com/Azure/azure-rest-api-specs/0bc7853cb4d824bb6c310344dcc1b5f77cbe6bdd/specification/search/data-plane/Azure.Search/preview/2020-06-30/searchservice.json
models-subpackage: implementation.models
custom-types-subpackage: models
```

### Tag: package-2020-06-searchindex

These settings apply only when `--tag=package-2020-06-searchindex` is specified on the command line.

``` yaml $(tag) == 'package-2020-06-searchindex'
namespace: com.azure.search.documents
input-file:
- https://raw.githubusercontent.com/Azure/azure-rest-api-specs/0bc7853cb4d824bb6c310344dcc1b5f77cbe6bdd/specification/search/data-plane/Azure.Search/preview/2020-06-30/searchindex.json
models-subpackage: implementation.models
custom-types-subpackage: models
```

### Tag: package-2019-05-searchservice-preview

These settings apply only when `--tag=package-2019-05-searchservice-preview` is specified on the command line.

``` yaml $(tag) == 'package-2019-05-searchservice-preview'
namespace: com.azure.search.documents.indexes
input-file:
- https://github.com/Azure/azure-rest-api-specs/blob/master/specification/search/data-plane/Azure.Search/preview/2019-05-06-preview/searchservice.json
models-subpackage: implementation.models
custom-types-subpackage: models
```

### Tag: package-2019-05-searchindex-preview

These settings apply only when `--tag=package-2019-05-searchindex-preview` is specified on the command line.

``` yaml $(tag) == 'package-2019-05-searchindex-preview'
namespace: com.azure.search.documents
input-file:
- https://github.com/Azure/azure-rest-api-specs/blob/master/specification/search/data-plane/Azure.Search/preview/2019-05-06-preview/searchindex.json
models-subpackage: implementation.models
custom-types-subpackage: models
```

### Tag: package-2019-05-searchservice

These settings apply only when `--tag=package-2019-05-searchservice` is specified on the command line.

``` yaml $(tag) == 'package-2019-05-searchservice'
input-file:
- https://github.com/Azure/azure-rest-api-specs/blob/master/specification/search/data-plane/Azure.Search/stable/2019-05-06/searchservice.json
```

### Tag: package-2019-05-searchindex

These settings apply only when `--tag=package-2019-05-searchindex` is specified on the command line.

``` yaml $(tag) == 'package-2019-05-searchindex'
input-file:
- https://github.com/Azure/azure-rest-api-specs/blob/master/specification/search/data-plane/Azure.Search/stable/2019-05-06/searchindex.json
```

---
# Code Generation

!!! READ THIS !!!
This swagger is ready for C# and Java.
!!! READ THIS !!!

## Java

``` yaml
output-folder: ../
java: true
sync-methods: none
generate-client-interfaces: false
context-client-method-parameter: true
generate-client-as-impl: true
required-fields-as-ctor-args: true
client-side-validations: true
license-header: |-
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the MIT License.
  Code generated by Microsoft (R) AutoRest Code Generator.
  Changes may cause incorrect behavior and will be lost if the code is regenerated.

vararg-properties: >-
  AutocompleteOptions.searchFields,
  SearchOptions.facets, SearchOptions.highlightFields, SearchOptions.orderBy, SearchOptions.scoringParameters, SearchOptions.searchFields, SearchOptions.select,
  SuggestOptions.orderBy, SuggestOptions.searchFields, SuggestOptions.select, CorsOptions.allowedOrigins
```

### Set odata.metadata Accept header in operations

searchindex.json needs odata.metadata=none and searchservice.json needs odata.metadata=minimal in the Accept header.

``` yaml $(java)
directive:
  - from: swagger-document
    where: $.paths
    transform: >
      for (var path in $) {
        for (var opName in $[path]) {
          var accept = "application/json; odata.metadata=";
          accept += path.startsWith("/docs") ? "none" : "minimal";

          var op = $[path][opName];
          op.parameters.push({
            name: "accept",
            "in": "header",
            required: true,
            type: "string",
            enum: [ accept ],
            "x-ms-parameter-location": "method"
          });
        }
      }

      return $;
```
