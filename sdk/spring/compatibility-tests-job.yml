parameters:
  Matrix: ''
  MaxParallel: 0

jobs:
  - job: 'test'
    dependsOn: ${{ parameters.DependsOn }}
    condition: and(succeededOrFailed(), ne(${{ parameters.Matrix }}, '{}'))

    strategy:
      maxParallel: ${{ parameters.MaxParallel }}
      matrix: $[ ${{ parameters.Matrix }} ]
    pool:
      vmImage: "ubuntu-latest"
    variables:
      - template: ../../eng/pipelines/templates/variables/globals.yml

    steps:
      - script: |
          pip install termcolor
        displayName: 'python module install'
      - script: |
          python ./sdk/spring/scripts/compatibility_add_dependencymanagement.py -b 2.6.6 -c 2021.0.1
        displayName: 'add dependency management'
      - script: |
          python ./sdk/spring/scripts/compatibility_deleted_version.py
        displayName: 'remove version'
      - task: Maven@3
        displayName: 'Run tests'
        inputs:
          mavenPomFile: sdk/spring/pom.xml
          mavenOptions: '$(MemoryOptions)'
          javaHomeOption: 'JDKVersion'
          jdkVersionOption: $(JavaTestVersion)
          jdkArchitectureOption: 'x64'
          goals: 'clean test -Pdev'

