trigger: none
pr: none

variables:
  - template: ../../eng/pipelines/templates/variables/globals.yml

stages:
  - stage: "monitor_tests"
    jobs:
      - template: /eng/common/pipelines/templates/jobs/archetype-sdk-tests-generate.yml
        parameters:
          SparseCheckout: true
          JobTemplatePath: ../../../../../sdk/spring/monitor-tests-job.yml
          AdditionalParameters:
            ServiceDirectory: spring
      - template: /eng/common/pipelines/templates/jobs/archetype-sdk-tests-generate.yml
        parameters:
          SparseCheckout: true
          JobTemplatePath: ../../../../../sdk/spring/monitor-tests-job.yml
          AdditionalParameters:
            ServiceDirectory: spring
          MatrixConfigs:
            - Name: monitor_compatibility_tests
              Path: sdk/spring/monitor-matrix.json
              Selection: sparse
              NonSparseParameters:
                - TEST_SPRING_BOOT_VERSION
              GenerateVMJobs: true
          PreGenerationSteps:
            - script: |
                python ./sdk/spring/scripts/monitor_update_monitor_matrix_json.py
              displayName: 'update test version'
