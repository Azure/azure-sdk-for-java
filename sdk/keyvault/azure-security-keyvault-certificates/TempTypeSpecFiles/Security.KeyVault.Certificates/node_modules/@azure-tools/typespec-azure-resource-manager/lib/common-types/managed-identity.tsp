using Azure.Core;
using TypeSpec.Versioning;

namespace Azure.ResourceManager.CommonTypes;

/** The set of user assigned identities associated with the resource. The userAssignedIdentities dictionary keys will be ARM resource ids in the form: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identityName}. The dictionary values can be empty objects ({}) in requests. */
#deprecated "Do not use this model. Instead, use Record<UserAssignedIdentity | null> directly. Using this model will result in a different client SDK when generated from TypeSpec compared to the Swagger."
model UserAssignedIdentities is Record<UserAssignedIdentity | null>;

/**
 * Managed service identity (system assigned and/or user assigned identities)
 */
model ManagedServiceIdentity {
  /** The service principal ID of the system assigned identity. This property will only be provided for a system assigned identity. */
  @visibility("read")
  principalId?: uuid;

  /** The tenant ID of the system assigned identity. This property will only be provided for a system assigned identity. */
  @visibility("read")
  tenantId?: uuid;

  /** The type of managed identity assigned to this resource. */
  type: ManagedServiceIdentityType;

  /** The identities assigned to this resource by the user. */
  @typeChangedFrom(Versions.v5, Record<UserAssignedIdentity>)
  userAssignedIdentities?: Record<UserAssignedIdentity | null>;
}

/**
 * Managed service identity (either system assigned, or none)
 */
model SystemAssignedServiceIdentity {
  /** The service principal ID of the system assigned identity. This property will only be provided for a system assigned identity. */
  @visibility("read")
  principalId?: uuid;

  /** The tenant ID of the system assigned identity. This property will only be provided for a system assigned identity. */
  @visibility("read")
  tenantId?: uuid;

  /** The type of managed identity assigned to this resource. */
  type: SystemAssignedServiceIdentityType;
}

/**
 * User assigned identity properties
 */
model UserAssignedIdentity {
  /** The principal ID of the assigned identity. */
  @visibility("read")
  principalId?: uuid;

  /** The client ID of the assigned identity. */
  @visibility("read")
  clientId?: uuid;
}

/**
 * Type of managed service identity (where both SystemAssigned and UserAssigned types are allowed).
 */
union ManagedServiceIdentityType {
  /** No managed identity. */
  None: "None",

  /** System assigned managed identity. */
  SystemAssigned: "SystemAssigned",

  /** User assigned managed identity. */
  UserAssigned: "UserAssigned",

  /** System and user assigned managed identity. */
  @renamedFrom(Versions.v3, "SystemAndUserAssigned")
  @removed(Versions.v4)
  SystemAndUserAssignedV3: "SystemAssigned,UserAssigned",

  /** System and user assigned managed identity. */
  @added(Versions.v4)
  @renamedFrom(Versions.v4, "SystemAndUserAssigned")
  @removed(Versions.v5)
  SystemAndUserAssignedV4: "SystemAssigned, UserAssigned",

  /** System and user assigned managed identity. */
  @added(Versions.v5)
  SystemAndUserAssigned: "SystemAssigned,UserAssigned",

  string,
}

/**
 * Type of managed service identity (either system assigned, or none).
 */
union SystemAssignedServiceIdentityType {
  /** No managed system identity. */
  None: "None",

  /** System assigned managed system identity. */
  SystemAssigned: "SystemAssigned",

  string,
}
