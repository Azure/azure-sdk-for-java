// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.appservice.generated.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.appservice.generated.AppServiceManager;
import com.azure.resourcemanager.appservice.generated.models.SiteRuntimeState;
import com.azure.resourcemanager.appservice.generated.models.WebSiteInstanceStatus;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class WebAppsGetInstanceInfoWithResponseMockTests {
    @Test
    public void testGetInstanceInfoWithResponse() throws Exception {
        String responseStr
            = "{\"properties\":{\"state\":\"STOPPED\",\"statusUrl\":\"jn\",\"detectorUrl\":\"okxihfenmbljlrfw\",\"consoleUrl\":\"ssxid\",\"healthCheckUrl\":\"fvbicdzvypfobz\",\"containers\":{\"tqnqbdxwyo\":{\"currentTimeStamp\":\"2021-02-16T04:51:02Z\",\"previousTimeStamp\":\"2021-07-11T20:43:30Z\",\"currentCpuStats\":{\"cpuUsage\":{},\"systemCpuUsage\":7035721796054933737,\"onlineCpuCount\":2015347992,\"throttlingData\":{}},\"previousCpuStats\":{\"cpuUsage\":{},\"systemCpuUsage\":5354843470529446496,\"onlineCpuCount\":693195029,\"throttlingData\":{}},\"memoryStats\":{\"usage\":5802388266772750022,\"maxUsage\":1016636789625640892,\"limit\":3456549890463682824},\"name\":\"qeu\",\"id\":\"vscfpwpqvg\",\"eth0\":{\"rxBytes\":7232523699749797276,\"rxPackets\":2259058122013619287,\"rxErrors\":9133551879446792329,\"rxDropped\":8970276138327729302,\"txBytes\":3180207129513055187,\"txPackets\":5365983534057819540,\"txErrors\":3185839624743859173,\"txDropped\":3969467178714466110}}}},\"kind\":\"lfhnfjuuwmcug\",\"id\":\"eiiegoolbl\",\"name\":\"calbudfqtho\",\"type\":\"fqbeaizvnnhxgi\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AppServiceManager manager = AppServiceManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        WebSiteInstanceStatus response = manager.webApps()
            .getInstanceInfoWithResponse("t", "nrortjtyl", "eudpyh", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("lfhnfjuuwmcug", response.kind());
        Assertions.assertEquals(SiteRuntimeState.STOPPED, response.state());
        Assertions.assertEquals("jn", response.statusUrl());
        Assertions.assertEquals("okxihfenmbljlrfw", response.detectorUrl());
        Assertions.assertEquals("ssxid", response.consoleUrl());
        Assertions.assertEquals("fvbicdzvypfobz", response.healthCheckUrl());
        Assertions.assertEquals(OffsetDateTime.parse("2021-02-16T04:51:02Z"),
            response.containers().get("tqnqbdxwyo").currentTimestamp());
        Assertions.assertEquals(OffsetDateTime.parse("2021-07-11T20:43:30Z"),
            response.containers().get("tqnqbdxwyo").previousTimestamp());
        Assertions.assertEquals(7035721796054933737L,
            response.containers().get("tqnqbdxwyo").currentCpuStats().systemCpuUsage());
        Assertions.assertEquals(2015347992, response.containers().get("tqnqbdxwyo").currentCpuStats().onlineCpuCount());
        Assertions.assertEquals(5354843470529446496L,
            response.containers().get("tqnqbdxwyo").previousCpuStats().systemCpuUsage());
        Assertions.assertEquals(693195029, response.containers().get("tqnqbdxwyo").previousCpuStats().onlineCpuCount());
        Assertions.assertEquals(5802388266772750022L, response.containers().get("tqnqbdxwyo").memoryStats().usage());
        Assertions.assertEquals(1016636789625640892L, response.containers().get("tqnqbdxwyo").memoryStats().maxUsage());
        Assertions.assertEquals(3456549890463682824L, response.containers().get("tqnqbdxwyo").memoryStats().limit());
        Assertions.assertEquals("qeu", response.containers().get("tqnqbdxwyo").name());
        Assertions.assertEquals("vscfpwpqvg", response.containers().get("tqnqbdxwyo").id());
        Assertions.assertEquals(7232523699749797276L, response.containers().get("tqnqbdxwyo").eth0().rxBytes());
        Assertions.assertEquals(2259058122013619287L, response.containers().get("tqnqbdxwyo").eth0().rxPackets());
        Assertions.assertEquals(9133551879446792329L, response.containers().get("tqnqbdxwyo").eth0().rxErrors());
        Assertions.assertEquals(8970276138327729302L, response.containers().get("tqnqbdxwyo").eth0().rxDropped());
        Assertions.assertEquals(3180207129513055187L, response.containers().get("tqnqbdxwyo").eth0().txBytes());
        Assertions.assertEquals(5365983534057819540L, response.containers().get("tqnqbdxwyo").eth0().txPackets());
        Assertions.assertEquals(3185839624743859173L, response.containers().get("tqnqbdxwyo").eth0().txErrors());
        Assertions.assertEquals(3969467178714466110L, response.containers().get("tqnqbdxwyo").eth0().txDropped());
    }
}
