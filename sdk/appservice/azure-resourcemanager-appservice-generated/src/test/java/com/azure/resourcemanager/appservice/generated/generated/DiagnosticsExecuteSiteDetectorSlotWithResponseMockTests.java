// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.appservice.generated.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.appservice.generated.AppServiceManager;
import com.azure.resourcemanager.appservice.generated.models.DiagnosticDetectorResponse;
import com.azure.resourcemanager.appservice.generated.models.IssueType;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class DiagnosticsExecuteSiteDetectorSlotWithResponseMockTests {
    @Test
    public void testExecuteSiteDetectorSlotWithResponse() throws Exception {
        String responseStr
            = "{\"properties\":{\"startTime\":\"2021-11-26T22:40:16Z\",\"endTime\":\"2021-06-09T16:01:06Z\",\"issueDetected\":true,\"detectorDefinition\":{\"displayName\":\"jirfyetljrdcg\",\"description\":\"rmx\",\"rank\":68.23975593651012,\"isEnabled\":true},\"metrics\":[{\"name\":\"mfnfatwi\",\"unit\":\"uhasqielhtukheim\",\"startTime\":\"2021-02-05T10:05:37Z\",\"endTime\":\"2021-11-03T13:57:39Z\",\"timeGrain\":\"gdpqkfxdqmdvrg\",\"values\":[{},{},{}]},{\"name\":\"mke\",\"unit\":\"yqotmju\",\"startTime\":\"2021-07-30T16:04:02Z\",\"endTime\":\"2021-03-22T16:07:59Z\",\"timeGrain\":\"letac\",\"values\":[{},{}]},{\"name\":\"kkva\",\"unit\":\"fjuefjbmowqwodmd\",\"startTime\":\"2021-10-09T01:06:15Z\",\"endTime\":\"2021-07-02T08:58:42Z\",\"timeGrain\":\"jqwahciapvcsw\",\"values\":[{},{}]},{\"name\":\"cpgcltftaqmriml\",\"unit\":\"jvzptfgabiblhz\",\"startTime\":\"2021-06-30T20:07:18Z\",\"endTime\":\"2021-07-31T07:05:47Z\",\"timeGrain\":\"gszx\",\"values\":[{}]}],\"abnormalTimePeriods\":[{\"startTime\":\"2021-08-24T03:34:51Z\",\"endTime\":\"2021-05-17T21:35:52Z\",\"message\":\"i\",\"source\":\"ndhsjpqhaskuiosl\",\"priority\":23.87689375090605,\"metaData\":[[{},{},{}],[{}],[{},{}]],\"type\":\"RuntimeIssueDetected\",\"solutions\":[{}]},{\"startTime\":\"2021-02-26T06:21:10Z\",\"endTime\":\"2021-06-23T14:12:45Z\",\"message\":\"jfdiijchtaaabt\",\"source\":\"hemnkykvru\",\"priority\":62.561683973754064,\"metaData\":[[{},{},{}],[{}],[{}],[{}]],\"type\":\"ServiceIncident\",\"solutions\":[{},{}]},{\"startTime\":\"2021-07-14T05:15:23Z\",\"endTime\":\"2021-03-30T10:31:01Z\",\"message\":\"eqvkuvy\",\"source\":\"yrfokolcoikstap\",\"priority\":5.773104068616597,\"metaData\":[[{},{},{}],[{},{}],[{},{},{},{}],[{},{},{}]],\"type\":\"Other\",\"solutions\":[{}]}],\"data\":[[{\"name\":\"wayhauhqvxeyliis\",\"value\":\"b\"},{\"name\":\"htkdcufzxxqdntvf\",\"value\":\"vernqke\"}],[{\"name\":\"ys\",\"value\":\"joxwugdzwoczfizf\"},{\"name\":\"pddzzdw\",\"value\":\"vmocnfzmuyykxlfl\"},{\"name\":\"uwunsnyqpmnyvnbm\",\"value\":\"omcrev\"}],[{\"name\":\"clilzv\",\"value\":\"sdnobxcdxpnrae\"},{\"name\":\"ixof\",\"value\":\"vsuhxrctc\"},{\"name\":\"fjsfrbj\",\"value\":\"qcbrrwbcycwasm\"},{\"name\":\"bw\",\"value\":\"cmhhvb\"}]],\"responseMetaData\":{\"dataSource\":{\"instructions\":[\"fyle\",\"gd\"],\"dataSourceUri\":[{}]}}},\"id\":\"femnykfzso\",\"name\":\"ue\",\"kind\":\"zl\",\"type\":\"z\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AppServiceManager manager = AppServiceManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        DiagnosticDetectorResponse response = manager.diagnostics()
            .executeSiteDetectorSlotWithResponse("lokhmkqyfatddwf", "fjfatoilmwzkxa", "lwd", "tjfnmxzu",
                "hvioccszdaxafu", OffsetDateTime.parse("2021-02-28T18:43:09Z"),
                OffsetDateTime.parse("2021-03-03T16:18:04Z"), "nqfwobnbluutm", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("zl", response.kind());
        Assertions.assertEquals(OffsetDateTime.parse("2021-11-26T22:40:16Z"), response.startTime());
        Assertions.assertEquals(OffsetDateTime.parse("2021-06-09T16:01:06Z"), response.endTime());
        Assertions.assertTrue(response.issueDetected());
        Assertions.assertEquals("mfnfatwi", response.metrics().get(0).name());
        Assertions.assertEquals("uhasqielhtukheim", response.metrics().get(0).unit());
        Assertions.assertEquals(OffsetDateTime.parse("2021-02-05T10:05:37Z"), response.metrics().get(0).startTime());
        Assertions.assertEquals(OffsetDateTime.parse("2021-11-03T13:57:39Z"), response.metrics().get(0).endTime());
        Assertions.assertEquals("gdpqkfxdqmdvrg", response.metrics().get(0).timeGrain());
        Assertions.assertEquals(OffsetDateTime.parse("2021-08-24T03:34:51Z"),
            response.abnormalTimePeriods().get(0).startTime());
        Assertions.assertEquals(OffsetDateTime.parse("2021-05-17T21:35:52Z"),
            response.abnormalTimePeriods().get(0).endTime());
        Assertions.assertEquals("i", response.abnormalTimePeriods().get(0).message());
        Assertions.assertEquals("ndhsjpqhaskuiosl", response.abnormalTimePeriods().get(0).source());
        Assertions.assertEquals(23.87689375090605D, response.abnormalTimePeriods().get(0).priority());
        Assertions.assertEquals(IssueType.RUNTIME_ISSUE_DETECTED, response.abnormalTimePeriods().get(0).type());
        Assertions.assertEquals("wayhauhqvxeyliis", response.data().get(0).get(0).name());
        Assertions.assertEquals("b", response.data().get(0).get(0).value());
        Assertions.assertEquals("fyle", response.responseMetaData().dataSource().instructions().get(0));
    }
}
