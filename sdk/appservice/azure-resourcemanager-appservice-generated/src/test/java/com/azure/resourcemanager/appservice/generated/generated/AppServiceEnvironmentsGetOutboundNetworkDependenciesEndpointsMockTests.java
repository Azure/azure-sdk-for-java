// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.appservice.generated.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.appservice.generated.AppServiceManager;
import com.azure.resourcemanager.appservice.generated.models.OutboundEnvironmentEndpoint;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class AppServiceEnvironmentsGetOutboundNetworkDependenciesEndpointsMockTests {
    @Test
    public void testGetOutboundNetworkDependenciesEndpoints() throws Exception {
        String responseStr
            = "{\"value\":[{\"category\":\"tmkobxvex\",\"endpoints\":[{\"domainName\":\"juphjjue\",\"endpointDetails\":[{\"ipAddress\":\"tgpyoatlpsi\",\"port\":371378222,\"latency\":85.51395081788523,\"isAccessible\":true},{\"ipAddress\":\"v\",\"port\":1642972891,\"latency\":55.21078743260519,\"isAccessible\":false},{\"ipAddress\":\"wvvxj\",\"port\":941647782,\"latency\":3.3002519149237575,\"isAccessible\":true}]},{\"domainName\":\"fec\",\"endpointDetails\":[{\"ipAddress\":\"ewfuwg\",\"port\":674459548,\"latency\":37.8790306378029,\"isAccessible\":true},{\"ipAddress\":\"hwy\",\"port\":245415009,\"latency\":12.285624646275206,\"isAccessible\":true},{\"ipAddress\":\"cfd\",\"port\":802922818,\"latency\":62.36489718858861,\"isAccessible\":true},{\"ipAddress\":\"s\",\"port\":578168731,\"latency\":80.81269363306923,\"isAccessible\":true}]},{\"domainName\":\"xjkdsqe\",\"endpointDetails\":[{\"ipAddress\":\"qttiqwixsdxxf\",\"port\":919226196,\"latency\":17.850491801665214,\"isAccessible\":false}]}]}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AppServiceManager manager = AppServiceManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        PagedIterable<OutboundEnvironmentEndpoint> response = manager.appServiceEnvironments()
            .getOutboundNetworkDependenciesEndpoints("lzxxg", "mhenqn", com.azure.core.util.Context.NONE);

        Assertions.assertEquals("tmkobxvex", response.iterator().next().category());
        Assertions.assertEquals("juphjjue", response.iterator().next().endpoints().get(0).domainName());
        Assertions.assertEquals("tgpyoatlpsi",
            response.iterator().next().endpoints().get(0).endpointDetails().get(0).ipAddress());
        Assertions.assertEquals(371378222,
            response.iterator().next().endpoints().get(0).endpointDetails().get(0).port());
        Assertions.assertEquals(85.51395081788523D,
            response.iterator().next().endpoints().get(0).endpointDetails().get(0).latency());
        Assertions.assertTrue(response.iterator().next().endpoints().get(0).endpointDetails().get(0).isAccessible());
    }
}
