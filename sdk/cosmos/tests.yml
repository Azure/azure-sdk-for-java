trigger: none

variables:
  DefaultOptions: '--batch-mode -Dmaven.wagon.http.pool=false'


jobs:
  - template: ../../eng/pipelines/templates/jobs/archetype-sdk-tests.yml
    parameters:
      TestName: Single_Region
      ServiceDirectory: cosmos
      TimeoutInMinutes: 240
      MaxParallel: 1
      Matrix:
        Strong_Http:
          DisplayName: Single Region Strong Https
          OSVmImage: 'macOS-10.13'
          ProfileFlag: '-Pfast'
          ACCOUNT_HOST: $(java-cosmos-strong-singleregion-host)
          ACCOUNT_KEY: $(java-cosmos-strong-singleregion-key)
          PROTOCOLS: '["Https"]'
          DESIRED_CONSISTENCIES: '["Strong", "Session"]'
          ACCOUNT_DEFAULT_CONSISTENCY: Strong

      PreRunSteps:
        - template: ../steps/install-reporting-tools.yml

      TestStepMavenInputs:
        goals: verify
        options: '$(ProfileFlag) -Dgpg.skip'
        testResultsFiles: '**/junitreports/TEST-*.xml'
        testRunTitle: 'Live tests for cosmos $(DisplayName)'  # TODO: DRY "cosmos" up
