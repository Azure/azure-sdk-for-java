// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.securityinsights.fluent.models.FusionAlertRuleProperties;
import com.azure.resourcemanager.securityinsights.models.AlertSeverity;
import com.azure.resourcemanager.securityinsights.models.FusionScenarioExclusionPattern;
import com.azure.resourcemanager.securityinsights.models.FusionSourceSettings;
import com.azure.resourcemanager.securityinsights.models.FusionSourceSubTypeSetting;
import com.azure.resourcemanager.securityinsights.models.FusionSubTypeSeverityFilter;
import com.azure.resourcemanager.securityinsights.models.FusionSubTypeSeverityFiltersItem;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class FusionAlertRulePropertiesTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        FusionAlertRuleProperties model = BinaryData.fromString(
            "{\"alertRuleTemplateName\":\"zugamxzkrrcoiis\",\"description\":\"mnppccekuztd\",\"displayName\":\"ezax\",\"enabled\":false,\"sourceSettings\":[{\"enabled\":true,\"sourceName\":\"xuizhyhnepkpet\",\"sourceSubTypes\":[{\"enabled\":true,\"sourceSubTypeName\":\"qiubxdukecpxda\",\"sourceSubTypeDisplayName\":\"dhctmmko\",\"severityFilters\":{\"isSupported\":true,\"filters\":[{\"severity\":\"Medium\",\"enabled\":true},{\"severity\":\"High\",\"enabled\":true},{\"severity\":\"High\",\"enabled\":true}]}}]},{\"enabled\":false,\"sourceName\":\"caqkiofk\",\"sourceSubTypes\":[{\"enabled\":false,\"sourceSubTypeName\":\"hklbnldpvcbh\",\"sourceSubTypeDisplayName\":\"zyqu\",\"severityFilters\":{\"isSupported\":false,\"filters\":[{\"severity\":\"Medium\",\"enabled\":false}]}},{\"enabled\":false,\"sourceSubTypeName\":\"pbrruyu\",\"sourceSubTypeDisplayName\":\"tvlmbjwcolbmxlb\",\"severityFilters\":{\"isSupported\":false,\"filters\":[{\"severity\":\"High\",\"enabled\":true},{\"severity\":\"Informational\",\"enabled\":false},{\"severity\":\"High\",\"enabled\":false}]}},{\"enabled\":true,\"sourceSubTypeName\":\"vxhmtfhocnxzcmj\",\"sourceSubTypeDisplayName\":\"gxnoqrxtdis\",\"severityFilters\":{\"isSupported\":true,\"filters\":[{\"severity\":\"High\",\"enabled\":true},{\"severity\":\"Low\",\"enabled\":true},{\"severity\":\"High\",\"enabled\":false}]}}]}],\"scenarioExclusionPatterns\":[{\"exclusionPattern\":\"hepfwwtjfdoes\",\"dateAddedInUTC\":\"xhmw\"},{\"exclusionPattern\":\"dbckyo\",\"dateAddedInUTC\":\"kxkxhnegk\"}],\"lastModifiedUtc\":\"2021-11-20T23:30:15Z\",\"severity\":\"Low\",\"tactics\":[\"PreAttack\"],\"techniques\":[\"lvukaobrlb\",\"gsnbagnchjh\",\"emuowakyw\",\"lhjym\"]}")
            .toObject(FusionAlertRuleProperties.class);
        Assertions.assertEquals("zugamxzkrrcoiis", model.alertRuleTemplateName());
        Assertions.assertEquals(false, model.enabled());
        Assertions.assertEquals(true, model.sourceSettings().get(0).enabled());
        Assertions.assertEquals("xuizhyhnepkpet", model.sourceSettings().get(0).sourceName());
        Assertions.assertEquals(true, model.sourceSettings().get(0).sourceSubTypes().get(0).enabled());
        Assertions.assertEquals("qiubxdukecpxda",
            model.sourceSettings().get(0).sourceSubTypes().get(0).sourceSubTypeName());
        Assertions.assertEquals(AlertSeverity.MEDIUM,
            model.sourceSettings().get(0).sourceSubTypes().get(0).severityFilters().filters().get(0).severity());
        Assertions.assertEquals(true,
            model.sourceSettings().get(0).sourceSubTypes().get(0).severityFilters().filters().get(0).enabled());
        Assertions.assertEquals("hepfwwtjfdoes", model.scenarioExclusionPatterns().get(0).exclusionPattern());
        Assertions.assertEquals("xhmw", model.scenarioExclusionPatterns().get(0).dateAddedInUtc());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        FusionAlertRuleProperties model
            = new FusionAlertRuleProperties().withAlertRuleTemplateName("zugamxzkrrcoiis")
                .withEnabled(false)
                .withSourceSettings(Arrays.asList(new FusionSourceSettings().withEnabled(true)
                    .withSourceName("xuizhyhnepkpet")
                    .withSourceSubTypes(Arrays.asList(new FusionSourceSubTypeSetting().withEnabled(true)
                        .withSourceSubTypeName("qiubxdukecpxda")
                        .withSeverityFilters(new FusionSubTypeSeverityFilter().withFilters(Arrays.asList(
                            new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.MEDIUM).withEnabled(true),
                            new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.HIGH).withEnabled(true),
                            new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.HIGH)
                                .withEnabled(true)))))),
                    new FusionSourceSettings().withEnabled(false)
                        .withSourceName("caqkiofk")
                        .withSourceSubTypes(Arrays.asList(
                            new FusionSourceSubTypeSetting().withEnabled(false)
                                .withSourceSubTypeName("hklbnldpvcbh")
                                .withSeverityFilters(new FusionSubTypeSeverityFilter().withFilters(Arrays
                                    .asList(new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.MEDIUM)
                                        .withEnabled(false)))),
                            new FusionSourceSubTypeSetting().withEnabled(false)
                                .withSourceSubTypeName("pbrruyu")
                                .withSeverityFilters(new FusionSubTypeSeverityFilter().withFilters(Arrays.asList(
                                    new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.HIGH)
                                        .withEnabled(true),
                                    new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.INFORMATIONAL)
                                        .withEnabled(false),
                                    new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.HIGH)
                                        .withEnabled(false)))),
                            new FusionSourceSubTypeSetting().withEnabled(true)
                                .withSourceSubTypeName("vxhmtfhocnxzcmj")
                                .withSeverityFilters(new FusionSubTypeSeverityFilter().withFilters(Arrays.asList(
                                    new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.HIGH)
                                        .withEnabled(true),
                                    new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.LOW)
                                        .withEnabled(true),
                                    new FusionSubTypeSeverityFiltersItem().withSeverity(AlertSeverity.HIGH)
                                        .withEnabled(false))))))))
                .withScenarioExclusionPatterns(Arrays.asList(
                    new FusionScenarioExclusionPattern().withExclusionPattern("hepfwwtjfdoes")
                        .withDateAddedInUtc("xhmw"),
                    new FusionScenarioExclusionPattern().withExclusionPattern("dbckyo")
                        .withDateAddedInUtc("kxkxhnegk")));
        model = BinaryData.fromObject(model).toObject(FusionAlertRuleProperties.class);
        Assertions.assertEquals("zugamxzkrrcoiis", model.alertRuleTemplateName());
        Assertions.assertEquals(false, model.enabled());
        Assertions.assertEquals(true, model.sourceSettings().get(0).enabled());
        Assertions.assertEquals("xuizhyhnepkpet", model.sourceSettings().get(0).sourceName());
        Assertions.assertEquals(true, model.sourceSettings().get(0).sourceSubTypes().get(0).enabled());
        Assertions.assertEquals("qiubxdukecpxda",
            model.sourceSettings().get(0).sourceSubTypes().get(0).sourceSubTypeName());
        Assertions.assertEquals(AlertSeverity.MEDIUM,
            model.sourceSettings().get(0).sourceSubTypes().get(0).severityFilters().filters().get(0).severity());
        Assertions.assertEquals(true,
            model.sourceSettings().get(0).sourceSubTypes().get(0).severityFilters().filters().get(0).enabled());
        Assertions.assertEquals("hepfwwtjfdoes", model.scenarioExclusionPatterns().get(0).exclusionPattern());
        Assertions.assertEquals("xhmw", model.scenarioExclusionPatterns().get(0).dateAddedInUtc());
    }
}
