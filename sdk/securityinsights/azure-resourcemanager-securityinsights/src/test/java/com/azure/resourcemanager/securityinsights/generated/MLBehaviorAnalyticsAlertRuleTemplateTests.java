// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.securityinsights.models.AlertRuleTemplateDataSource;
import com.azure.resourcemanager.securityinsights.models.AlertSeverity;
import com.azure.resourcemanager.securityinsights.models.AttackTactic;
import com.azure.resourcemanager.securityinsights.models.MLBehaviorAnalyticsAlertRuleTemplate;
import com.azure.resourcemanager.securityinsights.models.TemplateStatus;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class MLBehaviorAnalyticsAlertRuleTemplateTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        MLBehaviorAnalyticsAlertRuleTemplate model = BinaryData.fromString(
            "{\"kind\":\"MLBehaviorAnalytics\",\"properties\":{\"severity\":\"Low\",\"tactics\":[\"Persistence\"],\"techniques\":[\"hpczykmktpvw\"],\"alertRulesCreatedByTemplateCount\":698471341,\"lastUpdatedDateUTC\":\"2021-07-18T08:02:30Z\",\"createdDateUTC\":\"2021-09-14T03:13:29Z\",\"description\":\"khufmpqumqyjgydz\",\"displayName\":\"odsaeuzan\",\"requiredDataConnectors\":[{\"connectorId\":\"hse\",\"dataTypes\":[\"hpzfngqj\",\"lidftujwjj\",\"fwbeqrkuorh\"]},{\"connectorId\":\"sruqnmdvha\",\"dataTypes\":[\"jy\",\"iqswbqer\",\"w\"]},{\"connectorId\":\"ytxtdgu\",\"dataTypes\":[\"bpktgd\",\"tyouambewreswmow\"]}],\"status\":\"Installed\"},\"id\":\"uteyxeyguq\",\"name\":\"gijiitnspxlzd\",\"type\":\"sygrijwa\"}")
            .toObject(MLBehaviorAnalyticsAlertRuleTemplate.class);
        Assertions.assertEquals(AlertSeverity.LOW, model.severity());
        Assertions.assertEquals(AttackTactic.PERSISTENCE, model.tactics().get(0));
        Assertions.assertEquals("hpczykmktpvw", model.techniques().get(0));
        Assertions.assertEquals(698471341, model.alertRulesCreatedByTemplateCount());
        Assertions.assertEquals("khufmpqumqyjgydz", model.description());
        Assertions.assertEquals("odsaeuzan", model.displayName());
        Assertions.assertEquals("hse", model.requiredDataConnectors().get(0).connectorId());
        Assertions.assertEquals("hpzfngqj", model.requiredDataConnectors().get(0).dataTypes().get(0));
        Assertions.assertEquals(TemplateStatus.INSTALLED, model.status());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        MLBehaviorAnalyticsAlertRuleTemplate model
            = new MLBehaviorAnalyticsAlertRuleTemplate().withSeverity(AlertSeverity.LOW)
                .withTactics(Arrays.asList(AttackTactic.PERSISTENCE))
                .withTechniques(Arrays.asList("hpczykmktpvw"))
                .withAlertRulesCreatedByTemplateCount(698471341)
                .withDescription("khufmpqumqyjgydz")
                .withDisplayName("odsaeuzan")
                .withRequiredDataConnectors(Arrays.asList(
                    new AlertRuleTemplateDataSource().withConnectorId("hse")
                        .withDataTypes(Arrays.asList("hpzfngqj", "lidftujwjj", "fwbeqrkuorh")),
                    new AlertRuleTemplateDataSource().withConnectorId("sruqnmdvha")
                        .withDataTypes(Arrays.asList("jy", "iqswbqer", "w")),
                    new AlertRuleTemplateDataSource().withConnectorId("ytxtdgu")
                        .withDataTypes(Arrays.asList("bpktgd", "tyouambewreswmow"))))
                .withStatus(TemplateStatus.INSTALLED);
        model = BinaryData.fromObject(model).toObject(MLBehaviorAnalyticsAlertRuleTemplate.class);
        Assertions.assertEquals(AlertSeverity.LOW, model.severity());
        Assertions.assertEquals(AttackTactic.PERSISTENCE, model.tactics().get(0));
        Assertions.assertEquals("hpczykmktpvw", model.techniques().get(0));
        Assertions.assertEquals(698471341, model.alertRulesCreatedByTemplateCount());
        Assertions.assertEquals("khufmpqumqyjgydz", model.description());
        Assertions.assertEquals("odsaeuzan", model.displayName());
        Assertions.assertEquals("hse", model.requiredDataConnectors().get(0).connectorId());
        Assertions.assertEquals("hpzfngqj", model.requiredDataConnectors().get(0).dataTypes().get(0));
        Assertions.assertEquals(TemplateStatus.INSTALLED, model.status());
    }
}
