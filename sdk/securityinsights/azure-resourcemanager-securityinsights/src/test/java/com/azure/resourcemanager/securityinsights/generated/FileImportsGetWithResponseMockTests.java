// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.securityinsights.SecurityInsightsManager;
import com.azure.resourcemanager.securityinsights.models.FileFormat;
import com.azure.resourcemanager.securityinsights.models.FileImport;
import com.azure.resourcemanager.securityinsights.models.FileImportContentType;
import com.azure.resourcemanager.securityinsights.models.IngestionMode;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class FileImportsGetWithResponseMockTests {
    @Test
    public void testGetWithResponse() throws Exception {
        String responseStr
            = "{\"properties\":{\"ingestionMode\":\"IngestOnlyIfAllAreValid\",\"contentType\":\"Unspecified\",\"createdTimeUTC\":\"2021-11-27T11:22:03Z\",\"errorFile\":{\"fileFormat\":\"JSON\",\"fileName\":\"go\",\"fileSize\":743806482,\"fileContentUri\":\"wbywaazba\",\"deleteStatus\":\"Unspecified\"},\"errorsPreview\":[{\"recordIndex\":128767598,\"errorMessages\":[\"ab\"]},{\"recordIndex\":540063762,\"errorMessages\":[\"wnoljdkx\"]},{\"recordIndex\":627985252,\"errorMessages\":[\"aol\",\"lzxkrdpuyyt\"]},{\"recordIndex\":1337092802,\"errorMessages\":[\"khqetpoenefnoafp\",\"nrxiyrxow\",\"hufcmuajwblx\",\"htozfrfaw\"]}],\"importFile\":{\"fileFormat\":\"JSON\",\"fileName\":\"vr\",\"fileSize\":126017921,\"fileContentUri\":\"ni\",\"deleteStatus\":\"Deleted\"},\"ingestedRecordCount\":1092543818,\"source\":\"fgzqzhl\",\"state\":\"WaitingForUpload\",\"totalRecordCount\":449251298,\"validRecordCount\":2077888630,\"filesValidUntilTimeUTC\":\"2021-10-03T12:29:05Z\",\"importValidUntilTimeUTC\":\"2021-11-18T08:19:24Z\"},\"id\":\"yohrcmeqljxdum\",\"name\":\"ycxone\",\"type\":\"ldxagmdfj\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        SecurityInsightsManager manager = SecurityInsightsManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        FileImport response = manager.fileImports()
            .getWithResponse("mvghcmixmlwkfefb", "yjrtalqeebu", "fyim", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals(IngestionMode.INGEST_ONLY_IF_ALL_ARE_VALID, response.ingestionMode());
        Assertions.assertEquals(FileImportContentType.UNSPECIFIED, response.contentType());
        Assertions.assertEquals(FileFormat.JSON, response.importFile().fileFormat());
        Assertions.assertEquals("vr", response.importFile().fileName());
        Assertions.assertEquals(126017921, response.importFile().fileSize());
        Assertions.assertEquals("fgzqzhl", response.source());
    }
}
