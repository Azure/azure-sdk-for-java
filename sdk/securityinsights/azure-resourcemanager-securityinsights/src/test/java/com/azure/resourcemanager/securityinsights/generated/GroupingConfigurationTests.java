// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.securityinsights.models.AlertDetail;
import com.azure.resourcemanager.securityinsights.models.EntityMappingType;
import com.azure.resourcemanager.securityinsights.models.GroupingConfiguration;
import com.azure.resourcemanager.securityinsights.models.MatchingMethod;
import java.time.Duration;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class GroupingConfigurationTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        GroupingConfiguration model = BinaryData.fromString(
            "{\"enabled\":true,\"reopenClosedIncident\":false,\"lookbackDuration\":\"PT10H40M44S\",\"matchingMethod\":\"AllEntities\",\"groupByEntities\":[\"MailCluster\",\"CloudApplication\"],\"groupByAlertDetails\":[\"Severity\"],\"groupByCustomDetails\":[\"f\"]}")
            .toObject(GroupingConfiguration.class);
        Assertions.assertEquals(true, model.enabled());
        Assertions.assertEquals(false, model.reopenClosedIncident());
        Assertions.assertEquals(Duration.parse("PT10H40M44S"), model.lookbackDuration());
        Assertions.assertEquals(MatchingMethod.ALL_ENTITIES, model.matchingMethod());
        Assertions.assertEquals(EntityMappingType.MAIL_CLUSTER, model.groupByEntities().get(0));
        Assertions.assertEquals(AlertDetail.SEVERITY, model.groupByAlertDetails().get(0));
        Assertions.assertEquals("f", model.groupByCustomDetails().get(0));
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        GroupingConfiguration model = new GroupingConfiguration().withEnabled(true)
            .withReopenClosedIncident(false)
            .withLookbackDuration(Duration.parse("PT10H40M44S"))
            .withMatchingMethod(MatchingMethod.ALL_ENTITIES)
            .withGroupByEntities(Arrays.asList(EntityMappingType.MAIL_CLUSTER, EntityMappingType.CLOUD_APPLICATION))
            .withGroupByAlertDetails(Arrays.asList(AlertDetail.SEVERITY))
            .withGroupByCustomDetails(Arrays.asList("f"));
        model = BinaryData.fromObject(model).toObject(GroupingConfiguration.class);
        Assertions.assertEquals(true, model.enabled());
        Assertions.assertEquals(false, model.reopenClosedIncident());
        Assertions.assertEquals(Duration.parse("PT10H40M44S"), model.lookbackDuration());
        Assertions.assertEquals(MatchingMethod.ALL_ENTITIES, model.matchingMethod());
        Assertions.assertEquals(EntityMappingType.MAIL_CLUSTER, model.groupByEntities().get(0));
        Assertions.assertEquals(AlertDetail.SEVERITY, model.groupByAlertDetails().get(0));
        Assertions.assertEquals("f", model.groupByCustomDetails().get(0));
    }
}
