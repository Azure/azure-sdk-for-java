// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.security.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.security.fluent.models.DeviceSecurityGroupProperties;
import com.azure.resourcemanager.security.models.AllowlistCustomAlertRule;
import com.azure.resourcemanager.security.models.DenylistCustomAlertRule;
import com.azure.resourcemanager.security.models.ThresholdCustomAlertRule;
import com.azure.resourcemanager.security.models.TimeWindowCustomAlertRule;
import java.time.Duration;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class DeviceSecurityGroupPropertiesTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        DeviceSecurityGroupProperties model =
            BinaryData
                .fromString(
                    "{\"thresholdRules\":[{\"ruleType\":\"ThresholdCustomAlertRule\",\"minThreshold\":169768909,\"maxThreshold\":1712979680,\"displayName\":\"kbfkg\",\"description\":\"dkexxppofm\",\"isEnabled\":true},{\"ruleType\":\"ThresholdCustomAlertRule\",\"minThreshold\":159547648,\"maxThreshold\":54654595,\"displayName\":\"jpgd\",\"description\":\"ocjjxhvpmouexh\",\"isEnabled\":false}],\"timeWindowRules\":[{\"ruleType\":\"TimeWindowCustomAlertRule\",\"timeWindowSize\":\"PT63H16M48S\",\"minThreshold\":1730783579,\"maxThreshold\":996013729,\"displayName\":\"jnxqbzvddntwn\",\"description\":\"icbtwnpzao\",\"isEnabled\":true}],\"allowlistRules\":[{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"hcffcyddglmjthjq\",\"wpyeicxmqciwqvh\",\"hix\"],\"valueType\":\"String\",\"displayName\":\"topbobjogh\",\"description\":\"w\",\"isEnabled\":false},{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"a\"],\"valueType\":\"IpCidr\",\"displayName\":\"ayvvtpgvdf\",\"description\":\"otkftutqxlngx\",\"isEnabled\":false},{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"gug\",\"xkrxdqmi\",\"tthzrvqd\",\"abhjybi\"],\"valueType\":\"IpCidr\",\"displayName\":\"qfbow\",\"description\":\"anyktzlcuiywg\",\"isEnabled\":false},{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"gndrvynh\",\"gpphrcgyn\",\"ocpecfvmmco\",\"fsxlzevgbmqjqa\"],\"valueType\":\"IpCidr\",\"displayName\":\"mivkwlzuvcc\",\"description\":\"nfnbacfionlebxe\",\"isEnabled\":false}],\"denylistRules\":[{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"xdpnqbqq\",\"xrjfeallnwsub\",\"snjampmng\"],\"valueType\":\"IpCidr\",\"displayName\":\"xaqwoochcbonqv\",\"description\":\"vlrxnjeaseiph\",\"isEnabled\":false},{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"lokeyy\"],\"valueType\":\"IpCidr\",\"displayName\":\"bdlwtgrhpdjpj\",\"description\":\"asxazjpqyegualhb\",\"isEnabled\":true},{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"e\",\"jzzvdud\"],\"valueType\":\"String\",\"displayName\":\"lfh\",\"description\":\"wmc\",\"isEnabled\":true}]}")
                .toObject(DeviceSecurityGroupProperties.class);
        Assertions.assertEquals(true, model.thresholdRules().get(0).isEnabled());
        Assertions.assertEquals(169768909, model.thresholdRules().get(0).minThreshold());
        Assertions.assertEquals(1712979680, model.thresholdRules().get(0).maxThreshold());
        Assertions.assertEquals(true, model.timeWindowRules().get(0).isEnabled());
        Assertions.assertEquals(1730783579, model.timeWindowRules().get(0).minThreshold());
        Assertions.assertEquals(996013729, model.timeWindowRules().get(0).maxThreshold());
        Assertions.assertEquals(Duration.parse("PT63H16M48S"), model.timeWindowRules().get(0).timeWindowSize());
        Assertions.assertEquals(false, model.allowlistRules().get(0).isEnabled());
        Assertions.assertEquals("hcffcyddglmjthjq", model.allowlistRules().get(0).allowlistValues().get(0));
        Assertions.assertEquals(false, model.denylistRules().get(0).isEnabled());
        Assertions.assertEquals("xdpnqbqq", model.denylistRules().get(0).denylistValues().get(0));
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        DeviceSecurityGroupProperties model =
            new DeviceSecurityGroupProperties()
                .withThresholdRules(
                    Arrays
                        .asList(
                            new ThresholdCustomAlertRule()
                                .withIsEnabled(true)
                                .withMinThreshold(169768909)
                                .withMaxThreshold(1712979680),
                            new ThresholdCustomAlertRule()
                                .withIsEnabled(false)
                                .withMinThreshold(159547648)
                                .withMaxThreshold(54654595)))
                .withTimeWindowRules(
                    Arrays
                        .asList(
                            new TimeWindowCustomAlertRule()
                                .withIsEnabled(true)
                                .withMinThreshold(1730783579)
                                .withMaxThreshold(996013729)
                                .withTimeWindowSize(Duration.parse("PT63H16M48S"))))
                .withAllowlistRules(
                    Arrays
                        .asList(
                            new AllowlistCustomAlertRule()
                                .withIsEnabled(false)
                                .withAllowlistValues(Arrays.asList("hcffcyddglmjthjq", "wpyeicxmqciwqvh", "hix")),
                            new AllowlistCustomAlertRule().withIsEnabled(false).withAllowlistValues(Arrays.asList("a")),
                            new AllowlistCustomAlertRule()
                                .withIsEnabled(false)
                                .withAllowlistValues(Arrays.asList("gug", "xkrxdqmi", "tthzrvqd", "abhjybi")),
                            new AllowlistCustomAlertRule()
                                .withIsEnabled(false)
                                .withAllowlistValues(
                                    Arrays.asList("gndrvynh", "gpphrcgyn", "ocpecfvmmco", "fsxlzevgbmqjqa"))))
                .withDenylistRules(
                    Arrays
                        .asList(
                            new DenylistCustomAlertRule()
                                .withIsEnabled(false)
                                .withDenylistValues(Arrays.asList("xdpnqbqq", "xrjfeallnwsub", "snjampmng")),
                            new DenylistCustomAlertRule()
                                .withIsEnabled(true)
                                .withDenylistValues(Arrays.asList("lokeyy")),
                            new DenylistCustomAlertRule()
                                .withIsEnabled(true)
                                .withDenylistValues(Arrays.asList("e", "jzzvdud"))));
        model = BinaryData.fromObject(model).toObject(DeviceSecurityGroupProperties.class);
        Assertions.assertEquals(true, model.thresholdRules().get(0).isEnabled());
        Assertions.assertEquals(169768909, model.thresholdRules().get(0).minThreshold());
        Assertions.assertEquals(1712979680, model.thresholdRules().get(0).maxThreshold());
        Assertions.assertEquals(true, model.timeWindowRules().get(0).isEnabled());
        Assertions.assertEquals(1730783579, model.timeWindowRules().get(0).minThreshold());
        Assertions.assertEquals(996013729, model.timeWindowRules().get(0).maxThreshold());
        Assertions.assertEquals(Duration.parse("PT63H16M48S"), model.timeWindowRules().get(0).timeWindowSize());
        Assertions.assertEquals(false, model.allowlistRules().get(0).isEnabled());
        Assertions.assertEquals("hcffcyddglmjthjq", model.allowlistRules().get(0).allowlistValues().get(0));
        Assertions.assertEquals(false, model.denylistRules().get(0).isEnabled());
        Assertions.assertEquals("xdpnqbqq", model.denylistRules().get(0).denylistValues().get(0));
    }
}
