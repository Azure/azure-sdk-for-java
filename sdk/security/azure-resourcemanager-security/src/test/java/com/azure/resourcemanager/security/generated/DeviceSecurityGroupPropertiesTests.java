// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.security.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.security.fluent.models.DeviceSecurityGroupProperties;
import com.azure.resourcemanager.security.models.AllowlistCustomAlertRule;
import com.azure.resourcemanager.security.models.DenylistCustomAlertRule;
import com.azure.resourcemanager.security.models.ThresholdCustomAlertRule;
import com.azure.resourcemanager.security.models.TimeWindowCustomAlertRule;
import java.time.Duration;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class DeviceSecurityGroupPropertiesTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        DeviceSecurityGroupProperties model = BinaryData.fromString(
            "{\"thresholdRules\":[{\"ruleType\":\"ThresholdCustomAlertRule\",\"minThreshold\":749203483,\"maxThreshold\":202196748,\"displayName\":\"mhbrbqgvg\",\"description\":\"pbbttefjoknss\",\"isEnabled\":true},{\"ruleType\":\"ThresholdCustomAlertRule\",\"minThreshold\":1048720893,\"maxThreshold\":242035379,\"displayName\":\"dikdfrdbi\",\"description\":\"rjgeih\",\"isEnabled\":false},{\"ruleType\":\"ThresholdCustomAlertRule\",\"minThreshold\":448495041,\"maxThreshold\":1830771147,\"displayName\":\"wfiwzcxmj\",\"description\":\"yephmgtvljvrcmyf\",\"isEnabled\":false},{\"ruleType\":\"ThresholdCustomAlertRule\",\"minThreshold\":895211840,\"maxThreshold\":1540718771,\"displayName\":\"hnp\",\"description\":\"yqwcabvnuil\",\"isEnabled\":false}],\"timeWindowRules\":[{\"ruleType\":\"TimeWindowCustomAlertRule\",\"timeWindowSize\":\"PT109H54M24S\",\"minThreshold\":1969142096,\"maxThreshold\":2064428749,\"displayName\":\"augmrmfjlr\",\"description\":\"toaukhfkvcisiz\",\"isEnabled\":true},{\"ruleType\":\"TimeWindowCustomAlertRule\",\"timeWindowSize\":\"PT171H6M14S\",\"minThreshold\":714943113,\"maxThreshold\":598120417,\"displayName\":\"xjw\",\"description\":\"vedwcgyeewx\",\"isEnabled\":false}],\"allowlistRules\":[{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"smgomguaml\",\"dlrgms\"],\"valueType\":\"String\",\"displayName\":\"auf\",\"description\":\"hhvnewgnxkymp\",\"isEnabled\":false}],\"denylistRules\":[{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"jk\",\"xtwbta\"],\"valueType\":\"IpCidr\",\"displayName\":\"yghs\",\"description\":\"cyl\",\"isEnabled\":true},{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"mnsghpxycphdr\",\"jjkhvyomaclu\",\"vxnqmhrpqpd\"],\"valueType\":\"String\",\"displayName\":\"oi\",\"description\":\"css\",\"isEnabled\":true},{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"uifmc\",\"ypobkdqzr\",\"zsylollgt\",\"czzydmxzjij\"],\"valueType\":\"String\",\"displayName\":\"urkihci\",\"description\":\"defxrdc\",\"isEnabled\":false}]}")
            .toObject(DeviceSecurityGroupProperties.class);
        Assertions.assertEquals(true, model.thresholdRules().get(0).isEnabled());
        Assertions.assertEquals(749203483, model.thresholdRules().get(0).minThreshold());
        Assertions.assertEquals(202196748, model.thresholdRules().get(0).maxThreshold());
        Assertions.assertEquals(true, model.timeWindowRules().get(0).isEnabled());
        Assertions.assertEquals(1969142096, model.timeWindowRules().get(0).minThreshold());
        Assertions.assertEquals(2064428749, model.timeWindowRules().get(0).maxThreshold());
        Assertions.assertEquals(Duration.parse("PT109H54M24S"), model.timeWindowRules().get(0).timeWindowSize());
        Assertions.assertEquals(false, model.allowlistRules().get(0).isEnabled());
        Assertions.assertEquals("smgomguaml", model.allowlistRules().get(0).allowlistValues().get(0));
        Assertions.assertEquals(true, model.denylistRules().get(0).isEnabled());
        Assertions.assertEquals("jk", model.denylistRules().get(0).denylistValues().get(0));
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        DeviceSecurityGroupProperties model = new DeviceSecurityGroupProperties().withThresholdRules(Arrays.asList(
            new ThresholdCustomAlertRule().withIsEnabled(true).withMinThreshold(749203483).withMaxThreshold(202196748),
            new ThresholdCustomAlertRule().withIsEnabled(false)
                .withMinThreshold(1048720893)
                .withMaxThreshold(242035379),
            new ThresholdCustomAlertRule().withIsEnabled(false)
                .withMinThreshold(448495041)
                .withMaxThreshold(1830771147),
            new ThresholdCustomAlertRule().withIsEnabled(false)
                .withMinThreshold(895211840)
                .withMaxThreshold(1540718771)))
            .withTimeWindowRules(Arrays.asList(
                new TimeWindowCustomAlertRule().withIsEnabled(true)
                    .withMinThreshold(1969142096)
                    .withMaxThreshold(2064428749)
                    .withTimeWindowSize(Duration.parse("PT109H54M24S")),
                new TimeWindowCustomAlertRule().withIsEnabled(false)
                    .withMinThreshold(714943113)
                    .withMaxThreshold(598120417)
                    .withTimeWindowSize(Duration.parse("PT171H6M14S"))))
            .withAllowlistRules(Arrays.asList(new AllowlistCustomAlertRule().withIsEnabled(false)
                .withAllowlistValues(Arrays.asList("smgomguaml", "dlrgms"))))
            .withDenylistRules(Arrays.asList(
                new DenylistCustomAlertRule().withIsEnabled(true).withDenylistValues(Arrays.asList("jk", "xtwbta")),
                new DenylistCustomAlertRule().withIsEnabled(true)
                    .withDenylistValues(Arrays.asList("mnsghpxycphdr", "jjkhvyomaclu", "vxnqmhrpqpd")),
                new DenylistCustomAlertRule().withIsEnabled(false)
                    .withDenylistValues(Arrays.asList("uifmc", "ypobkdqzr", "zsylollgt", "czzydmxzjij"))));
        model = BinaryData.fromObject(model).toObject(DeviceSecurityGroupProperties.class);
        Assertions.assertEquals(true, model.thresholdRules().get(0).isEnabled());
        Assertions.assertEquals(749203483, model.thresholdRules().get(0).minThreshold());
        Assertions.assertEquals(202196748, model.thresholdRules().get(0).maxThreshold());
        Assertions.assertEquals(true, model.timeWindowRules().get(0).isEnabled());
        Assertions.assertEquals(1969142096, model.timeWindowRules().get(0).minThreshold());
        Assertions.assertEquals(2064428749, model.timeWindowRules().get(0).maxThreshold());
        Assertions.assertEquals(Duration.parse("PT109H54M24S"), model.timeWindowRules().get(0).timeWindowSize());
        Assertions.assertEquals(false, model.allowlistRules().get(0).isEnabled());
        Assertions.assertEquals("smgomguaml", model.allowlistRules().get(0).allowlistValues().get(0));
        Assertions.assertEquals(true, model.denylistRules().get(0).isEnabled());
        Assertions.assertEquals("jk", model.denylistRules().get(0).denylistValues().get(0));
    }
}
