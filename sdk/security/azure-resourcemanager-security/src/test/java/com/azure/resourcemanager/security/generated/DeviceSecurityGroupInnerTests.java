// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.security.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.security.fluent.models.DeviceSecurityGroupInner;
import com.azure.resourcemanager.security.models.AllowlistCustomAlertRule;
import com.azure.resourcemanager.security.models.DenylistCustomAlertRule;
import com.azure.resourcemanager.security.models.ThresholdCustomAlertRule;
import com.azure.resourcemanager.security.models.TimeWindowCustomAlertRule;
import java.time.Duration;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class DeviceSecurityGroupInnerTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        DeviceSecurityGroupInner model = BinaryData.fromString(
            "{\"properties\":{\"thresholdRules\":[{\"ruleType\":\"ThresholdCustomAlertRule\",\"minThreshold\":1683033093,\"maxThreshold\":142879531,\"displayName\":\"oeshoygzcbyfq\",\"description\":\"faoytehqpuv\",\"isEnabled\":true}],\"timeWindowRules\":[{\"ruleType\":\"TimeWindowCustomAlertRule\",\"timeWindowSize\":\"PT114H54M24S\",\"minThreshold\":2064395969,\"maxThreshold\":71975398,\"displayName\":\"ckygroejnndljdju\",\"description\":\"br\",\"isEnabled\":false}],\"allowlistRules\":[{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"kceysfaqegplw\"],\"valueType\":\"String\",\"displayName\":\"w\",\"description\":\"kvb\",\"isEnabled\":false},{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"qusybwptd\",\"carvvlfntymtpoi\",\"enazerohzrsqals\"],\"valueType\":\"IpCidr\",\"displayName\":\"wqapfgsdp\",\"description\":\"essmzhhku\",\"isEnabled\":false},{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"ldqqctekv\",\"lblhtjq\"],\"valueType\":\"String\",\"displayName\":\"wehtaemxh\",\"description\":\"ysev\",\"isEnabled\":true},{\"ruleType\":\"AllowlistCustomAlertRule\",\"allowlistValues\":[\"ivzrrryveimipsk\",\"yzatvfuzkaft\"],\"valueType\":\"IpCidr\",\"displayName\":\"uxwigsyeipqdsm\",\"description\":\"grq\",\"isEnabled\":false}],\"denylistRules\":[{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"ileplk\",\"smk\",\"hwtbbaedorvvm\",\"floygbdgwumg\"],\"valueType\":\"String\",\"displayName\":\"hpabgdexjddvjs\",\"description\":\"wotmmwllcolsrsxa\",\"isEnabled\":true},{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"f\"],\"valueType\":\"String\",\"displayName\":\"gjokjljnhvlqjbek\",\"description\":\"eksnbksdqhjvyk\",\"isEnabled\":true},{\"ruleType\":\"DenylistCustomAlertRule\",\"denylistValues\":[\"sl\"],\"valueType\":\"String\",\"displayName\":\"stcpoqmavnwqjw\",\"description\":\"knlejjjkxybwfd\",\"isEnabled\":true}]},\"id\":\"jbzten\",\"name\":\"vkzykjtjknsxf\",\"type\":\"us\"}")
            .toObject(DeviceSecurityGroupInner.class);
        Assertions.assertEquals(true, model.thresholdRules().get(0).isEnabled());
        Assertions.assertEquals(1683033093, model.thresholdRules().get(0).minThreshold());
        Assertions.assertEquals(142879531, model.thresholdRules().get(0).maxThreshold());
        Assertions.assertEquals(false, model.timeWindowRules().get(0).isEnabled());
        Assertions.assertEquals(2064395969, model.timeWindowRules().get(0).minThreshold());
        Assertions.assertEquals(71975398, model.timeWindowRules().get(0).maxThreshold());
        Assertions.assertEquals(Duration.parse("PT114H54M24S"), model.timeWindowRules().get(0).timeWindowSize());
        Assertions.assertEquals(false, model.allowlistRules().get(0).isEnabled());
        Assertions.assertEquals("kceysfaqegplw", model.allowlistRules().get(0).allowlistValues().get(0));
        Assertions.assertEquals(true, model.denylistRules().get(0).isEnabled());
        Assertions.assertEquals("ileplk", model.denylistRules().get(0).denylistValues().get(0));
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        DeviceSecurityGroupInner model = new DeviceSecurityGroupInner()
            .withThresholdRules(Arrays.asList(new ThresholdCustomAlertRule().withIsEnabled(true)
                .withMinThreshold(1683033093).withMaxThreshold(142879531)))
            .withTimeWindowRules(
                Arrays.asList(new TimeWindowCustomAlertRule().withIsEnabled(false).withMinThreshold(2064395969)
                    .withMaxThreshold(71975398).withTimeWindowSize(Duration.parse("PT114H54M24S"))))
            .withAllowlistRules(Arrays.asList(
                new AllowlistCustomAlertRule().withIsEnabled(false).withAllowlistValues(Arrays.asList("kceysfaqegplw")),
                new AllowlistCustomAlertRule().withIsEnabled(false)
                    .withAllowlistValues(Arrays.asList("qusybwptd", "carvvlfntymtpoi", "enazerohzrsqals")),
                new AllowlistCustomAlertRule().withIsEnabled(true)
                    .withAllowlistValues(Arrays.asList("ldqqctekv", "lblhtjq")),
                new AllowlistCustomAlertRule().withIsEnabled(false)
                    .withAllowlistValues(Arrays.asList("ivzrrryveimipsk", "yzatvfuzkaft"))))
            .withDenylistRules(Arrays.asList(
                new DenylistCustomAlertRule().withIsEnabled(true)
                    .withDenylistValues(Arrays.asList("ileplk", "smk", "hwtbbaedorvvm", "floygbdgwumg")),
                new DenylistCustomAlertRule().withIsEnabled(true).withDenylistValues(Arrays.asList("f")),
                new DenylistCustomAlertRule().withIsEnabled(true).withDenylistValues(Arrays.asList("sl"))));
        model = BinaryData.fromObject(model).toObject(DeviceSecurityGroupInner.class);
        Assertions.assertEquals(true, model.thresholdRules().get(0).isEnabled());
        Assertions.assertEquals(1683033093, model.thresholdRules().get(0).minThreshold());
        Assertions.assertEquals(142879531, model.thresholdRules().get(0).maxThreshold());
        Assertions.assertEquals(false, model.timeWindowRules().get(0).isEnabled());
        Assertions.assertEquals(2064395969, model.timeWindowRules().get(0).minThreshold());
        Assertions.assertEquals(71975398, model.timeWindowRules().get(0).maxThreshold());
        Assertions.assertEquals(Duration.parse("PT114H54M24S"), model.timeWindowRules().get(0).timeWindowSize());
        Assertions.assertEquals(false, model.allowlistRules().get(0).isEnabled());
        Assertions.assertEquals("kceysfaqegplw", model.allowlistRules().get(0).allowlistValues().get(0));
        Assertions.assertEquals(true, model.denylistRules().get(0).isEnabled());
        Assertions.assertEquals("ileplk", model.denylistRules().get(0).denylistValues().get(0));
    }
}
