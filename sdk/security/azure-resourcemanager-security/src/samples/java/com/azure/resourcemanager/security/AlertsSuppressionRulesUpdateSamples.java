// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.security;

import com.azure.core.util.Context;
import com.azure.resourcemanager.security.fluent.models.AlertsSuppressionRuleInner;
import com.azure.resourcemanager.security.models.RuleState;
import com.azure.resourcemanager.security.models.ScopeElement;
import com.azure.resourcemanager.security.models.SuppressionAlertsScope;
import java.time.OffsetDateTime;
import java.util.Arrays;

/** Samples for AlertsSuppressionRules Update. */
public final class AlertsSuppressionRulesUpdateSamples {
    /**
     * Sample code: Update or create suppression rule for subscription.
     *
     * @param securityManager Entry point to SecurityManager. API spec for Microsoft.Security (Azure Security Center)
     *     resource provider.
     */
    public static void updateOrCreateSuppressionRuleForSubscription(
        com.azure.resourcemanager.security.SecurityManager securityManager) {
        securityManager
            .alertsSuppressionRules()
            .updateWithResponse(
                "dismissIpAnomalyAlerts",
                new AlertsSuppressionRuleInner()
                    .withAlertType("IpAnomaly")
                    .withExpirationDateUtc(OffsetDateTime.parse("2019-12-01T19:50:47.083633Z"))
                    .withReason("FalsePositive")
                    .withState(RuleState.ENABLED)
                    .withComment("Test VM")
                    .withSuppressionAlertsScope(
                        new SuppressionAlertsScope()
                            .withAllOf(
                                Arrays
                                    .asList(
                                        new ScopeElement().withField("entities.ip.address"),
                                        new ScopeElement().withField("entities.process.commandline")))),
                Context.NONE);
    }
}
