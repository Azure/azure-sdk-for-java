// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.policyinsights.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.policyinsights.PolicyInsightsManager;
import com.azure.resourcemanager.policyinsights.models.ComponentPolicyStatesQueryResults;
import com.azure.resourcemanager.policyinsights.models.ComponentPolicyStatesResource;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class ComponentPolicyStatesListQueryResultsForPolicyDefinitionWithResponseMockTests {
    @Test
    public void testListQueryResultsForPolicyDefinitionWithResponse() throws Exception {
        String responseStr
            = "{\"@odata.context\":\"armhpwbuklv\",\"@odata.count\":539074796,\"value\":[{\"@odata.id\":\"tlvhqpoilosjaemc\",\"@odata.context\":\"evft\",\"timestamp\":\"2021-10-04T21:00:27Z\",\"componentId\":\"pokjyghztm\",\"componentType\":\"iwtp\",\"componentName\":\"lcezswwvw\",\"resourceId\":\"tdjtvbfpfhru\",\"policyAssignmentId\":\"syqcjnqswxdowum\",\"policyDefinitionId\":\"ukrcdiohcl\",\"subscriptionId\":\"dnhfknebwedd\",\"resourceType\":\"yzcwy\",\"resourceLocation\":\"mkaqldqabnwvpaq\",\"resourceGroup\":\"xf\",\"policyAssignmentName\":\"igcfddofxnf\",\"policyAssignmentOwner\":\"jyyrqaedw\",\"policyAssignmentParameters\":\"ocytjgoeayokrw\",\"policyAssignmentScope\":\"ihwpadhedbfobd\",\"policyDefinitionName\":\"vothmkhjaoz\",\"policyDefinitionAction\":\"wfcn\",\"policyDefinitionCategory\":\"bpoelhscmyhrhjv\",\"policySetDefinitionId\":\"fqbokndwp\",\"policySetDefinitionName\":\"qwojoev\",\"policySetDefinitionOwner\":\"ufytdxmly\",\"policySetDefinitionCategory\":\"lyvapbkrbu\",\"policySetDefinitionParameters\":\"gtdltlcuha\",\"policyDefinitionReferenceId\":\"ijvaylze\",\"complianceState\":\"lpsftqkrvm\",\"policyEvaluationDetails\":{\"evaluatedExpressions\":[{},{},{}],\"reason\":\"cpwtqs\"},\"policyDefinitionGroupNames\":[\"nhmzydff\",\"tevrntfknwac\"],\"policyDefinitionVersion\":\"syotctkhfhfsatv\",\"policySetDefinitionVersion\":\"xrmhnmizhvprh\",\"policyAssignmentVersion\":\"wcublehhk\",\"tbtdvu\":\"databzgottaksadzighm\",\"urdeewlsuxp\":\"datafvvraab\"},{\"@odata.id\":\"wkdwjyjiznioroof\",\"@odata.context\":\"taspmcrei\",\"timestamp\":\"2021-04-22T10:06:16Z\",\"componentId\":\"rnig\",\"componentType\":\"inuwqxungrob\",\"componentName\":\"fmsxjwdy\",\"resourceId\":\"xmvzjow\",\"policyAssignmentId\":\"geerclbl\",\"policyDefinitionId\":\"hpwachyeu\",\"subscriptionId\":\"wmvwryvdi\",\"resourceType\":\"ii\",\"resourceLocation\":\"pruccwme\",\"resourceGroup\":\"txsytrtexegwmrq\",\"policyAssignmentName\":\"wi\",\"policyAssignmentOwner\":\"vycfjncindi\",\"policyAssignmentParameters\":\"q\",\"policyAssignmentScope\":\"jwjuriarsb\",\"policyDefinitionName\":\"lanhzcknjxizba\",\"policyDefinitionAction\":\"ygzkztxfexwacyy\",\"policyDefinitionCategory\":\"lxppd\",\"policySetDefinitionId\":\"zkf\",\"policySetDefinitionName\":\"uiiu\",\"policySetDefinitionOwner\":\"b\",\"policySetDefinitionCategory\":\"cjy\",\"policySetDefinitionParameters\":\"dcizeqqfop\",\"policyDefinitionReferenceId\":\"opmotdsf\",\"complianceState\":\"xqlyoazyfbkmvl\",\"policyEvaluationDetails\":{\"evaluatedExpressions\":[{}],\"reason\":\"jzsvmaigb\"},\"policyDefinitionGroupNames\":[\"hyejt\",\"geecbpergwlckih\",\"amyqso\",\"knp\"],\"policyDefinitionVersion\":\"zjwdizcr\",\"policySetDefinitionVersion\":\"x\",\"policyAssignmentVersion\":\"j\",\"xbbwlmnwz\":\"datasexgkrswksykkbxk\"},{\"@odata.id\":\"nvuqddlggbqaolgz\",\"@odata.context\":\"akdlkvggc\",\"timestamp\":\"2021-06-29T08:09:17Z\",\"componentId\":\"ffetp\",\"componentType\":\"ixwewzlscgsmep\",\"componentName\":\"vxgv\",\"resourceId\":\"dbthhxmoevv\",\"policyAssignmentId\":\"eepfh\",\"policyDefinitionId\":\"nn\",\"subscriptionId\":\"xqhpjhuboh\",\"resourceType\":\"zgaybvr\",\"resourceLocation\":\"og\",\"resourceGroup\":\"gxnwfmzvztau\",\"policyAssignmentName\":\"pamqxfcssanybz\",\"policyAssignmentOwner\":\"hvdfe\",\"policyAssignmentParameters\":\"yj\",\"policyAssignmentScope\":\"cdhlywkho\",\"policyDefinitionName\":\"junzxezriwg\",\"policyDefinitionAction\":\"wapcqksaaapxjhc\",\"policyDefinitionCategory\":\"ibenwsdfpvda\",\"policySetDefinitionId\":\"lfrcqklpmvz\",\"policySetDefinitionName\":\"reszyaqgom\",\"policySetDefinitionOwner\":\"mfggeokfekc\",\"policySetDefinitionCategory\":\"lwkyeahhh\",\"policySetDefinitionParameters\":\"pulnrfcqufmcihp\",\"policyDefinitionReferenceId\":\"owrer\",\"complianceState\":\"xptch\",\"policyEvaluationDetails\":{\"evaluatedExpressions\":[{},{}],\"reason\":\"idqimlgbbfj\"},\"policyDefinitionGroupNames\":[\"jvxlhmpmh\",\"ftyaphq\",\"ofytlsnlowm\"],\"policyDefinitionVersion\":\"cqi\",\"policySetDefinitionVersion\":\"anccqvjfdgfqp\",\"policyAssignmentVersion\":\"u\",\"aaradciovmuf\":\"datahc\",\"aossnqebao\":\"datagugrblwa\"},{\"@odata.id\":\"ptgcsmanxxrwq\",\"@odata.context\":\"dqe\",\"timestamp\":\"2021-10-23T19:38:31Z\",\"componentId\":\"mqwzmnob\",\"componentType\":\"wwps\",\"componentName\":\"xovuqoqjr\",\"resourceId\":\"lndyclwgycv\",\"policyAssignmentId\":\"nzjcyqqzhembtbw\",\"policyDefinitionId\":\"lbadp\",\"subscriptionId\":\"jdleajvmvvlooubs\",\"resourceType\":\"ipjeo\",\"resourceLocation\":\"kgocj\",\"resourceGroup\":\"lupfazus\",\"policyAssignmentName\":\"dhuslgdwz\",\"policyAssignmentOwner\":\"dqyxajclgr\",\"policyAssignmentParameters\":\"vqcwyzoqzk\",\"policyAssignmentScope\":\"cwwsj\",\"policyDefinitionName\":\"iixepbntqqwwgfgs\",\"policyDefinitionAction\":\"ilefej\",\"policyDefinitionCategory\":\"wrznequ\",\"policySetDefinitionId\":\"nttwk\",\"policySetDefinitionName\":\"ajksbs\",\"policySetDefinitionOwner\":\"gjmqjhgcydijnmcv\",\"policySetDefinitionCategory\":\"ssfcriqxzixtd\",\"policySetDefinitionParameters\":\"wmvcdkucpxpyafrw\",\"policyDefinitionReferenceId\":\"orogeuv\",\"complianceState\":\"rspnrsjsem\",\"policyEvaluationDetails\":{\"evaluatedExpressions\":[{},{},{}],\"reason\":\"snqpljpete\"},\"policyDefinitionGroupNames\":[\"ikelpmwgr\",\"ub\",\"udhvos\"],\"policyDefinitionVersion\":\"zscueza\",\"policySetDefinitionVersion\":\"vdfwgqjhewcffrx\",\"policyAssignmentVersion\":\"ezkhzp\",\"yzaivnpsjnpckpl\":\"dataissenerru\",\"uonbdawsaop\":\"datajy\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        PolicyInsightsManager manager = PolicyInsightsManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        ComponentPolicyStatesQueryResults response = manager.componentPolicyStates()
            .listQueryResultsForPolicyDefinitionWithResponse("lxrmxvm", "rwynb", ComponentPolicyStatesResource.LATEST,
                256685420, "azoymdvhhpl", "hwwdkatveqmg", OffsetDateTime.parse("2021-07-22T21:27:10Z"),
                OffsetDateTime.parse("2021-05-29T01:41:36Z"), "w", "eyxr", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("cpwtqs", response.value().get(0).policyEvaluationDetails().reason());
    }
}
