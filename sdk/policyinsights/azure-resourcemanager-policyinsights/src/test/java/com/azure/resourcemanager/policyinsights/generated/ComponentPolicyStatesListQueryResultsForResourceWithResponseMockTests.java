// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.policyinsights.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.policyinsights.PolicyInsightsManager;
import com.azure.resourcemanager.policyinsights.models.ComponentPolicyStatesQueryResults;
import com.azure.resourcemanager.policyinsights.models.ComponentPolicyStatesResource;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class ComponentPolicyStatesListQueryResultsForResourceWithResponseMockTests {
    @Test
    public void testListQueryResultsForResourceWithResponse() throws Exception {
        String responseStr
            = "{\"@odata.context\":\"mihrijezbfsj\",\"@odata.count\":1495148602,\"value\":[{\"@odata.id\":\"kvb\",\"@odata.context\":\"kbsvbwy\",\"timestamp\":\"2021-02-20T20:54:09Z\",\"componentId\":\"nb\",\"componentType\":\"hjgclxaxwcf\",\"componentName\":\"spsdz\",\"resourceId\":\"cszghdoaqip\",\"policyAssignmentId\":\"xclfrs\",\"policyDefinitionId\":\"rnmuvwvpuofddtbf\",\"subscriptionId\":\"kjcnginxdvmaoyq\",\"resourceType\":\"vg\",\"resourceLocation\":\"zmxynofxlt\",\"resourceGroup\":\"oqxt\",\"policyAssignmentName\":\"zujsjirkrp\",\"policyAssignmentOwner\":\"cjhmmofbnivdqtk\",\"policyAssignmentParameters\":\"paxnlsfgnyscac\",\"policyAssignmentScope\":\"tbzetxyg\",\"policyDefinitionName\":\"iceecvjwy\",\"policyDefinitionAction\":\"eoxmpzzw\",\"policyDefinitionCategory\":\"drdvha\",\"policySetDefinitionId\":\"kx\",\"policySetDefinitionName\":\"vz\",\"policySetDefinitionOwner\":\"xmbrygmwibiosiq\",\"policySetDefinitionCategory\":\"kqfdqwdrtx\",\"policySetDefinitionParameters\":\"daglmrcok\",\"policyDefinitionReferenceId\":\"ert\",\"complianceState\":\"unzsiywhubym\",\"policyEvaluationDetails\":{\"evaluatedExpressions\":[{},{}],\"reason\":\"k\"},\"policyDefinitionGroupNames\":[\"qnnfywt\"],\"policyDefinitionVersion\":\"ow\",\"policySetDefinitionVersion\":\"lkhczygpmgfjculo\",\"policyAssignmentVersion\":\"hylxdevfiyymo\",\"pk\":\"databybwjmtftcvelnir\",\"qp\":\"datanstp\",\"bvswmehfxrt\":\"databj\"},{\"@odata.id\":\"bmsennqfabqcama\",\"@odata.context\":\"ctcxs\",\"timestamp\":\"2021-08-12T05:39:38Z\",\"componentId\":\"dxmsynbkdnn\",\"componentType\":\"fxuzmsvzyqrbrn\",\"componentName\":\"jtlxfikjkxara\",\"resourceId\":\"wuasnjeglhtrx\",\"policyAssignmentId\":\"zpcjcnwjzbqblxr\",\"policyDefinitionId\":\"vdsvoqizawwsds\",\"subscriptionId\":\"gfhjxsawoo\",\"resourceType\":\"ffhx\",\"resourceLocation\":\"kmwzrdqyoy\",\"resourceGroup\":\"rn\",\"policyAssignmentName\":\"ocjnzdaiovrbhr\",\"policyAssignmentOwner\":\"phkvyyz\",\"policyAssignmentParameters\":\"crxylaypdt\",\"policyAssignmentScope\":\"velffohuriw\",\"policyDefinitionName\":\"dfrwpsshrm\",\"policyDefinitionAction\":\"cclpct\",\"policyDefinitionCategory\":\"gkscxjfsgmosp\",\"policySetDefinitionId\":\"bnxsqc\",\"policySetDefinitionName\":\"scuyfqlamfbqhsuj\",\"policySetDefinitionOwner\":\"fu\",\"policySetDefinitionCategory\":\"nxqpwnikxkcajgrb\",\"policySetDefinitionParameters\":\"tsvgoocqs\",\"policyDefinitionReferenceId\":\"mzlpcx\",\"complianceState\":\"mhxxrqicfzfvwjd\",\"policyEvaluationDetails\":{\"evaluatedExpressions\":[{},{},{},{}],\"reason\":\"yeyoafinmpnqu\"},\"policyDefinitionGroupNames\":[\"jr\"],\"policyDefinitionVersion\":\"wkyl\",\"policySetDefinitionVersion\":\"bdx\",\"policyAssignmentVersion\":\"qdcclcv\",\"mf\":\"dataupaylcvwb\",\"qnpfydrfb\":\"datalrymfjxlpiy\",\"k\":\"datacnyxbyx\",\"ncgaull\":\"datamq\"},{\"@odata.id\":\"tyygjq\",\"@odata.context\":\"lmwqg\",\"timestamp\":\"2021-07-18T22:08:01Z\",\"componentId\":\"miwxzfvv\",\"componentType\":\"cqfgu\",\"componentName\":\"nbxwbmwd\",\"resourceId\":\"inhlxhgdekekz\",\"policyAssignmentId\":\"yvewwpzrdwcg\",\"policyDefinitionId\":\"ohgcand\",\"subscriptionId\":\"h\",\"resourceType\":\"te\",\"resourceLocation\":\"dqtdnnc\",\"resourceGroup\":\"pljdshvvfkdxcc\",\"policyAssignmentName\":\"jjimhijz\",\"policyAssignmentOwner\":\"njxm\",\"policyAssignmentParameters\":\"s\",\"policyAssignmentScope\":\"ydw\",\"policyDefinitionName\":\"gruhhqldrdymn\",\"policyDefinitionAction\":\"xiexqwqnghxnimvy\",\"policyDefinitionCategory\":\"rxgunnqgy\",\"policySetDefinitionId\":\"qtny\",\"policySetDefinitionName\":\"uevqmvyumgmm\",\"policySetDefinitionOwner\":\"bsnznwgsqufm\",\"policySetDefinitionCategory\":\"cyoseqcazisvbrqg\",\"policySetDefinitionParameters\":\"jp\",\"policyDefinitionReferenceId\":\"wepkwonrzpghlr\",\"complianceState\":\"bgblxbuibrvjzta\",\"policyEvaluationDetails\":{\"evaluatedExpressions\":[{}],\"reason\":\"fjihvfjcqrttjfuq\"},\"policyDefinitionGroupNames\":[\"j\",\"wfeqbavd\",\"stwygu\"],\"policyDefinitionVersion\":\"wel\",\"policySetDefinitionVersion\":\"gwzz\",\"policyAssignmentVersion\":\"dtlcjgpvcqzv\",\"x\":\"datavg\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        PolicyInsightsManager manager = PolicyInsightsManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        ComponentPolicyStatesQueryResults response = manager.componentPolicyStates()
            .listQueryResultsForResourceWithResponse("gvxrktjcjigc", ComponentPolicyStatesResource.LATEST, 304014554,
                "panbqxasevc", "efpgeedyyb", OffsetDateTime.parse("2021-11-25T00:50:13Z"),
                OffsetDateTime.parse("2021-09-15T19:34:58Z"), "olaemwcgi", "mrimaabsqql", "nbzaowcahdkmb",
                com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("k", response.value().get(0).policyEvaluationDetails().reason());
    }
}
