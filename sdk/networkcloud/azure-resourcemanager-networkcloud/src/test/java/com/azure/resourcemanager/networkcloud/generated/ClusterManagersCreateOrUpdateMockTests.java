// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.networkcloud.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.networkcloud.NetworkCloudManager;
import com.azure.resourcemanager.networkcloud.models.ClusterManager;
import com.azure.resourcemanager.networkcloud.models.ManagedResourceGroupConfiguration;
import com.azure.resourcemanager.networkcloud.models.ManagedServiceIdentity;
import com.azure.resourcemanager.networkcloud.models.ManagedServiceIdentityType;
import com.azure.resourcemanager.networkcloud.models.UserAssignedIdentity;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class ClusterManagersCreateOrUpdateMockTests {
    @Test
    public void testCreateOrUpdate() throws Exception {
        String responseStr
            = "{\"etag\":\"jzudrtpzk\",\"identity\":{\"principalId\":\"9ca08c3f-1950-485a-bc3a-7b5094aa79ee\",\"tenantId\":\"5640896e-3e8d-4578-9581-964c8cc01a5d\",\"type\":\"SystemAssigned,UserAssigned\",\"userAssignedIdentities\":{\"zzqrhmngqbedy\":{\"principalId\":\"e97ff86b-dd51-4ca9-9ef2-7a1d39ccc2ce\",\"clientId\":\"2ef5d3b6-d432-41a1-a991-8e621376e4f1\"},\"rzwnyk\":{\"principalId\":\"0e3b012d-a3e0-4605-8259-0c42e5a50ad9\",\"clientId\":\"843c497b-dc0c-45f2-80da-28b3fc100f7f\"},\"jch\":{\"principalId\":\"aece1e43-80fa-4d2f-a2d5-99e86fe03110\",\"clientId\":\"f3177c6d-3b28-40eb-bdb4-28d4dee79f29\"}}},\"properties\":{\"analyticsWorkspaceId\":\"mpwctoflds\",\"availabilityZones\":[\"dhztxkbr\"],\"clusterVersions\":[{\"supportExpiryDate\":\"wjiyewhfjsrwq\",\"targetClusterVersion\":\"etfgcwvrrmdqntyc\"},{\"supportExpiryDate\":\"wthv\",\"targetClusterVersion\":\"xgnuyeamcmhu\"}],\"detailedStatus\":\"Available\",\"detailedStatusMessage\":\"cehokw\",\"fabricControllerId\":\"pqtwloesqrggvrb\",\"managedResourceGroupConfiguration\":{\"location\":\"ukoila\",\"name\":\"duwjleipjlhwy\"},\"managerExtendedLocation\":{\"name\":\"zr\",\"type\":\"z\"},\"provisioningState\":\"Succeeded\",\"vmSize\":\"kkwhbgxvellvulnx\"},\"location\":\"nitmujdtvmclyymf\",\"tags\":{\"xfzuvrzmzqmzj\":\"jpddn\",\"pv\":\"rb\",\"pglaoh\":\"mdyfoebojtj\"},\"id\":\"qk\",\"name\":\"jtnqjil\",\"type\":\"ywkdcwmqsy\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        NetworkCloudManager manager = NetworkCloudManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        ClusterManager response = manager.clusterManagers()
            .define("uzowpuohdkcpr")
            .withRegion("ekrdr")
            .withExistingResourceGroup("flanfkgxsyao")
            .withFabricControllerId("wohpmwhqnucs")
            .withTags(mapOf("yehqbeivdlhydwb", "olr", "mpathubtah", "bfgrlpunytjlkes"))
            .withIdentity(new ManagedServiceIdentity().withType(ManagedServiceIdentityType.SYSTEM_ASSIGNED)
                .withUserAssignedIdentities(mapOf("mqrud", new UserAssignedIdentity(), "cbfzmc",
                    new UserAssignedIdentity(), "fhi", new UserAssignedIdentity())))
            .withAnalyticsWorkspaceId("nmfbc")
            .withAvailabilityZones(Arrays.asList("ktkrumzuedky", "bfvxovqkxiuxq", "gvqrnhyhlwcj", "qggjhf"))
            .withManagedResourceGroupConfiguration(
                new ManagedResourceGroupConfiguration().withLocation("sidsjtd").withName("bninjgazlsvbzfc"))
            .withVmSize("ciklh")
            .withIfMatch("gravaqogfkbebauz")
            .withIfNoneMatch("qbtxxwpf")
            .create();

        Assertions.assertEquals("nitmujdtvmclyymf", response.location());
        Assertions.assertEquals("jpddn", response.tags().get("xfzuvrzmzqmzj"));
        Assertions.assertEquals(ManagedServiceIdentityType.SYSTEM_ASSIGNED_USER_ASSIGNED, response.identity().type());
        Assertions.assertEquals("mpwctoflds", response.analyticsWorkspaceId());
        Assertions.assertEquals("dhztxkbr", response.availabilityZones().get(0));
        Assertions.assertEquals("pqtwloesqrggvrb", response.fabricControllerId());
        Assertions.assertEquals("ukoila", response.managedResourceGroupConfiguration().location());
        Assertions.assertEquals("duwjleipjlhwy", response.managedResourceGroupConfiguration().name());
        Assertions.assertEquals("kkwhbgxvellvulnx", response.vmSize());
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
