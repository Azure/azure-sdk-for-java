// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.synapse.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.synapse.SynapseManager;
import com.azure.resourcemanager.synapse.models.KustoPoolListResult;
import com.azure.resourcemanager.synapse.models.SkuName;
import com.azure.resourcemanager.synapse.models.SkuSize;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class KustoPoolsListByWorkspaceWithResponseMockTests {
    @Test
    public void testListByWorkspaceWithResponse() throws Exception {
        String responseStr
            = "{\"value\":[{\"sku\":{\"name\":\"Compute optimized\",\"capacity\":1330095429,\"size\":\"Large\"},\"properties\":{\"state\":\"Deleting\",\"provisioningState\":\"Moving\",\"uri\":\"dfwgqjhewcffrx\",\"dataIngestionUri\":\"ezkhzp\",\"stateReason\":\"qissen\",\"optimizedAutoscale\":{\"version\":1824938735,\"isEnabled\":true,\"minimum\":1906202000,\"maximum\":1806204309},\"enableStreamingIngest\":true,\"enablePurge\":true,\"languageExtensions\":{\"value\":[{},{},{}]},\"workspaceUID\":\"n\"},\"etag\":\"kplujyduon\",\"location\":\"awsaoplvvmnbkx\",\"tags\":{\"xqkdyqjvzvcgrds\":\"sbbdddwokqxai\",\"hvzf\":\"zesfkqqx\"},\"id\":\"brouszxac\",\"name\":\"wukokgoojj\",\"type\":\"uktubcmunhgbtzv\"},{\"sku\":{\"name\":\"Compute optimized\",\"capacity\":861082551,\"size\":\"Medium\"},\"properties\":{\"state\":\"Starting\",\"provisioningState\":\"Moving\",\"uri\":\"fnkcnihkswxm\",\"dataIngestionUri\":\"rqmwmwwpn\",\"stateReason\":\"motahbqsvnk\",\"optimizedAutoscale\":{\"version\":143583752,\"isEnabled\":true,\"minimum\":1027927355,\"maximum\":215079538},\"enableStreamingIngest\":false,\"enablePurge\":true,\"languageExtensions\":{\"value\":[{},{},{},{}]},\"workspaceUID\":\"cqmyrhkvxzz\"},\"etag\":\"emqyftgpqoswgfq\",\"location\":\"mghpakbqyh\",\"tags\":{\"jm\":\"rnfbmeqagkn\",\"mqmbwpp\":\"bnyevztnjawrhule\"},\"id\":\"irxbkitzmnhit\",\"name\":\"xjucl\",\"type\":\"j\"},{\"sku\":{\"name\":\"Storage optimized\",\"capacity\":936714724,\"size\":\"Large\"},\"properties\":{\"state\":\"Updating\",\"provisioningState\":\"Running\",\"uri\":\"dvyljubvfjy\",\"dataIngestionUri\":\"f\",\"stateReason\":\"ifnivlut\",\"optimizedAutoscale\":{\"version\":932860252,\"isEnabled\":true,\"minimum\":1427315085,\"maximum\":1903854968},\"enableStreamingIngest\":true,\"enablePurge\":true,\"languageExtensions\":{\"value\":[{},{},{}]},\"workspaceUID\":\"xhklsqxt\"},\"etag\":\"yygktsrjyxxoxwf\",\"location\":\"kvecnxfx\",\"tags\":{\"vuwmsumustihtgr\":\"owbebsnbwut\",\"czvogtd\":\"fjajvkyxmm\"},\"id\":\"rjenn\",\"name\":\"kvaeuwqdwxhhlbm\",\"type\":\"phfxnrpdhewoky\"},{\"sku\":{\"name\":\"Compute optimized\",\"capacity\":530619554,\"size\":\"Small\"},\"properties\":{\"state\":\"Stopping\",\"provisioningState\":\"Running\",\"uri\":\"hqbtodjfyxbvkv\",\"dataIngestionUri\":\"dmv\",\"stateReason\":\"qwcrugyo\",\"optimizedAutoscale\":{\"version\":388406043,\"isEnabled\":true,\"minimum\":18905408,\"maximum\":1117163209},\"enableStreamingIngest\":true,\"enablePurge\":false,\"languageExtensions\":{\"value\":[{},{}]},\"workspaceUID\":\"c\"},\"etag\":\"kvx\",\"location\":\"dqzbvbpsuvqhx\",\"tags\":{\"rklpiigfuzk\":\"fgdkwbk\",\"jclzjwaqdzqydewu\":\"utui\"},\"id\":\"xyll\",\"name\":\"zzevtzqwczochwb\",\"type\":\"k\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        SynapseManager manager = SynapseManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        KustoPoolListResult response = manager.kustoPools()
            .listByWorkspaceWithResponse("wu", "hvo", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("awsaoplvvmnbkx", response.value().get(0).location());
        Assertions.assertEquals("sbbdddwokqxai", response.value().get(0).tags().get("xqkdyqjvzvcgrds"));
        Assertions.assertEquals(SkuName.COMPUTE_OPTIMIZED, response.value().get(0).sku().name());
        Assertions.assertEquals(1330095429, response.value().get(0).sku().capacity());
        Assertions.assertEquals(SkuSize.LARGE, response.value().get(0).sku().size());
        Assertions.assertEquals(1824938735, response.value().get(0).optimizedAutoscale().version());
        Assertions.assertEquals(true, response.value().get(0).optimizedAutoscale().isEnabled());
        Assertions.assertEquals(1906202000, response.value().get(0).optimizedAutoscale().minimum());
        Assertions.assertEquals(1806204309, response.value().get(0).optimizedAutoscale().maximum());
        Assertions.assertEquals(true, response.value().get(0).enableStreamingIngest());
        Assertions.assertEquals(true, response.value().get(0).enablePurge());
        Assertions.assertEquals("n", response.value().get(0).workspaceUid());
    }
}
