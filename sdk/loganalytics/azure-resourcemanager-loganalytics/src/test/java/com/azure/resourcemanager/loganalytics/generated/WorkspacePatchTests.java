// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.loganalytics.generated;

import com.azure.core.util.BinaryData;
import com.azure.core.util.serializer.JacksonAdapter;
import com.azure.core.util.serializer.SerializerEncoding;
import com.azure.resourcemanager.loganalytics.models.Identity;
import com.azure.resourcemanager.loganalytics.models.IdentityType;
import com.azure.resourcemanager.loganalytics.models.PublicNetworkAccessType;
import com.azure.resourcemanager.loganalytics.models.UserIdentityProperties;
import com.azure.resourcemanager.loganalytics.models.WorkspaceCapping;
import com.azure.resourcemanager.loganalytics.models.WorkspaceFailoverProperties;
import com.azure.resourcemanager.loganalytics.models.WorkspaceFeatures;
import com.azure.resourcemanager.loganalytics.models.WorkspacePatch;
import com.azure.resourcemanager.loganalytics.models.WorkspaceReplicationProperties;
import com.azure.resourcemanager.loganalytics.models.WorkspaceSku;
import com.azure.resourcemanager.loganalytics.models.WorkspaceSkuNameEnum;
import java.util.HashMap;
import java.util.Map;
import org.junit.jupiter.api.Assertions;

public final class WorkspacePatchTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        WorkspacePatch model = BinaryData.fromString(
            "{\"properties\":{\"provisioningState\":\"Updating\",\"customerId\":\"zlrphwzs\",\"sku\":{\"name\":\"PerGB2018\",\"capacityReservationLevel\":1354895276,\"lastSkuUpdate\":\"2021-05-13T15:08:20Z\"},\"retentionInDays\":2112519300,\"workspaceCapping\":{\"dailyQuotaGb\":34.97869271736046,\"quotaNextResetTime\":\"nrwrbiork\",\"dataIngestionStatus\":\"RespectQuota\"},\"createdDate\":\"2021-03-04T00:16:10Z\",\"modifiedDate\":\"2021-04-15T08:16:25Z\",\"publicNetworkAccessForIngestion\":\"SecuredByPerimeter\",\"publicNetworkAccessForQuery\":\"Enabled\",\"forceCmkForQuery\":true,\"privateLinkScopedResources\":[{\"resourceId\":\"v\",\"scopeId\":\"miloxggdufiqndie\"},{\"resourceId\":\"ao\",\"scopeId\":\"chvcyyysfgdo\"},{\"resourceId\":\"ubiipuipwoqonma\",\"scopeId\":\"ekni\"}],\"features\":{\"enableDataExport\":false,\"immediatePurgeDataOn30Days\":false,\"enableLogAccessUsingOnlyResourcePermissions\":false,\"clusterResourceId\":\"ev\",\"disableLocalAuth\":true,\"unifiedSentinelBillingOnly\":false,\"associations\":[\"ilbywdxsm\",\"ccwr\"],\"n\":\"datacj\",\"voqyt\":\"datanszqujiz\"},\"defaultDataCollectionRuleResourceId\":\"yo\",\"replication\":{\"location\":\"lgy\",\"enabled\":false,\"provisioningState\":\"Failed\",\"createdDate\":\"2021-06-15T10:26:37Z\",\"lastModifiedDate\":\"2021-11-07T15:05:03Z\"},\"failover\":{\"state\":\"Failed\",\"lastModifiedDate\":\"2021-01-31T04:26:46Z\"}},\"identity\":{\"principalId\":\"sbpimlq\",\"tenantId\":\"jxkcgxxlxsff\",\"type\":\"None\",\"userAssignedIdentities\":{\"sgow\":{\"principalId\":\"qzdwlvwlyoup\",\"clientId\":\"fbkjubdyhgkfmi\"},\"tg\":{\"principalId\":\"ttsttktlahbqact\",\"clientId\":\"gzukxitmm\"},\"isavok\":{\"principalId\":\"q\",\"clientId\":\"rnxrxcpj\"},\"rqttbajlkatnw\":{\"principalId\":\"zfvazi\",\"clientId\":\"l\"}}},\"tags\":{\"cxkdmligovi\":\"opidkqqfkuv\",\"goorbteo\":\"rxkpmloazuruoc\"},\"etag\":\"fhjxakvvjgs\",\"id\":\"ordilmywwtkgkxny\",\"name\":\"dabg\",\"type\":\"vudtjuewbcihx\"}")
            .toObject(WorkspacePatch.class);
        Assertions.assertEquals(IdentityType.NONE, model.identity().type());
        Assertions.assertEquals("opidkqqfkuv", model.tags().get("cxkdmligovi"));
        Assertions.assertEquals(WorkspaceSkuNameEnum.PER_GB2018, model.sku().name());
        Assertions.assertEquals(1354895276, model.sku().capacityReservationLevel());
        Assertions.assertEquals(2112519300, model.retentionInDays());
        Assertions.assertEquals(34.97869271736046D, model.workspaceCapping().dailyQuotaGb());
        Assertions.assertEquals(PublicNetworkAccessType.SECURED_BY_PERIMETER, model.publicNetworkAccessForIngestion());
        Assertions.assertEquals(PublicNetworkAccessType.ENABLED, model.publicNetworkAccessForQuery());
        Assertions.assertTrue(model.forceCmkForQuery());
        Assertions.assertFalse(model.features().enableDataExport());
        Assertions.assertFalse(model.features().immediatePurgeDataOn30Days());
        Assertions.assertFalse(model.features().enableLogAccessUsingOnlyResourcePermissions());
        Assertions.assertEquals("ev", model.features().clusterResourceId());
        Assertions.assertTrue(model.features().disableLocalAuth());
        Assertions.assertEquals("yo", model.defaultDataCollectionRuleResourceId());
        Assertions.assertEquals("lgy", model.replication().location());
        Assertions.assertFalse(model.replication().enabled());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        WorkspacePatch model = new WorkspacePatch().withIdentity(new Identity().withType(IdentityType.NONE)
            .withUserAssignedIdentities(mapOf("sgow", new UserIdentityProperties(), "tg", new UserIdentityProperties(),
                "isavok", new UserIdentityProperties(), "rqttbajlkatnw", new UserIdentityProperties())))
            .withTags(mapOf("cxkdmligovi", "opidkqqfkuv", "goorbteo", "rxkpmloazuruoc"))
            .withSku(
                new WorkspaceSku().withName(WorkspaceSkuNameEnum.PER_GB2018).withCapacityReservationLevel(1354895276))
            .withRetentionInDays(2112519300)
            .withWorkspaceCapping(new WorkspaceCapping().withDailyQuotaGb(34.97869271736046D))
            .withPublicNetworkAccessForIngestion(PublicNetworkAccessType.SECURED_BY_PERIMETER)
            .withPublicNetworkAccessForQuery(PublicNetworkAccessType.ENABLED)
            .withForceCmkForQuery(true)
            .withFeatures(new WorkspaceFeatures().withEnableDataExport(false)
                .withImmediatePurgeDataOn30Days(false)
                .withEnableLogAccessUsingOnlyResourcePermissions(false)
                .withClusterResourceId("ev")
                .withDisableLocalAuth(true)
                .withAdditionalProperties(mapOf("associations",
                    JacksonAdapter.createDefaultSerializerAdapter()
                        .deserialize("[\"ilbywdxsm\",\"ccwr\"]", Object.class, SerializerEncoding.JSON),
                    "voqyt", "datanszqujiz", "unifiedSentinelBillingOnly", false, "n", "datacj")))
            .withDefaultDataCollectionRuleResourceId("yo")
            .withReplication(new WorkspaceReplicationProperties().withLocation("lgy").withEnabled(false))
            .withFailover(new WorkspaceFailoverProperties());
        model = BinaryData.fromObject(model).toObject(WorkspacePatch.class);
        Assertions.assertEquals(IdentityType.NONE, model.identity().type());
        Assertions.assertEquals("opidkqqfkuv", model.tags().get("cxkdmligovi"));
        Assertions.assertEquals(WorkspaceSkuNameEnum.PER_GB2018, model.sku().name());
        Assertions.assertEquals(1354895276, model.sku().capacityReservationLevel());
        Assertions.assertEquals(2112519300, model.retentionInDays());
        Assertions.assertEquals(34.97869271736046D, model.workspaceCapping().dailyQuotaGb());
        Assertions.assertEquals(PublicNetworkAccessType.SECURED_BY_PERIMETER, model.publicNetworkAccessForIngestion());
        Assertions.assertEquals(PublicNetworkAccessType.ENABLED, model.publicNetworkAccessForQuery());
        Assertions.assertTrue(model.forceCmkForQuery());
        Assertions.assertFalse(model.features().enableDataExport());
        Assertions.assertFalse(model.features().immediatePurgeDataOn30Days());
        Assertions.assertFalse(model.features().enableLogAccessUsingOnlyResourcePermissions());
        Assertions.assertEquals("ev", model.features().clusterResourceId());
        Assertions.assertTrue(model.features().disableLocalAuth());
        Assertions.assertEquals("yo", model.defaultDataCollectionRuleResourceId());
        Assertions.assertEquals("lgy", model.replication().location());
        Assertions.assertFalse(model.replication().enabled());
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
