// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.loganalytics.models;

import com.azure.core.annotation.Fluent;
import com.azure.core.util.CoreUtils;
import com.azure.json.JsonReader;
import com.azure.json.JsonSerializable;
import com.azure.json.JsonToken;
import com.azure.json.JsonWriter;
import java.io.IOException;
import java.time.OffsetDateTime;
import java.time.format.DateTimeFormatter;

/**
 * Rule definition parameters.
 */
@Fluent
public final class RuleDefinition implements JsonSerializable<RuleDefinition> {
    /*
     * Summary rule query.
     */
    private String query;

    /*
     * Scheduled window in minutes. Allowed values: 20, 30, 60, 120, 180, 360, 720, 1440.
     */
    private Integer binSize;

    /*
     * The minimum delay in seconds before bin processing.
     */
    private Integer binDelay;

    /*
     * The start time (UTC) when Summary rule execution starts.
     */
    private OffsetDateTime binStartTime;

    /*
     * The time cursor used in Summary rules bins processing, e.g. TimeGenerated.
     */
    private TimeSelectorEnum timeSelector;

    /*
     * The destination table used for the Summary rule results.
     */
    private String destinationTable;

    /**
     * Creates an instance of RuleDefinition class.
     */
    public RuleDefinition() {
    }

    /**
     * Get the query property: Summary rule query.
     * 
     * @return the query value.
     */
    public String query() {
        return this.query;
    }

    /**
     * Set the query property: Summary rule query.
     * 
     * @param query the query value to set.
     * @return the RuleDefinition object itself.
     */
    public RuleDefinition withQuery(String query) {
        this.query = query;
        return this;
    }

    /**
     * Get the binSize property: Scheduled window in minutes. Allowed values: 20, 30, 60, 120, 180, 360, 720, 1440.
     * 
     * @return the binSize value.
     */
    public Integer binSize() {
        return this.binSize;
    }

    /**
     * Set the binSize property: Scheduled window in minutes. Allowed values: 20, 30, 60, 120, 180, 360, 720, 1440.
     * 
     * @param binSize the binSize value to set.
     * @return the RuleDefinition object itself.
     */
    public RuleDefinition withBinSize(Integer binSize) {
        this.binSize = binSize;
        return this;
    }

    /**
     * Get the binDelay property: The minimum delay in seconds before bin processing.
     * 
     * @return the binDelay value.
     */
    public Integer binDelay() {
        return this.binDelay;
    }

    /**
     * Set the binDelay property: The minimum delay in seconds before bin processing.
     * 
     * @param binDelay the binDelay value to set.
     * @return the RuleDefinition object itself.
     */
    public RuleDefinition withBinDelay(Integer binDelay) {
        this.binDelay = binDelay;
        return this;
    }

    /**
     * Get the binStartTime property: The start time (UTC) when Summary rule execution starts.
     * 
     * @return the binStartTime value.
     */
    public OffsetDateTime binStartTime() {
        return this.binStartTime;
    }

    /**
     * Set the binStartTime property: The start time (UTC) when Summary rule execution starts.
     * 
     * @param binStartTime the binStartTime value to set.
     * @return the RuleDefinition object itself.
     */
    public RuleDefinition withBinStartTime(OffsetDateTime binStartTime) {
        this.binStartTime = binStartTime;
        return this;
    }

    /**
     * Get the timeSelector property: The time cursor used in Summary rules bins processing, e.g. TimeGenerated.
     * 
     * @return the timeSelector value.
     */
    public TimeSelectorEnum timeSelector() {
        return this.timeSelector;
    }

    /**
     * Set the timeSelector property: The time cursor used in Summary rules bins processing, e.g. TimeGenerated.
     * 
     * @param timeSelector the timeSelector value to set.
     * @return the RuleDefinition object itself.
     */
    public RuleDefinition withTimeSelector(TimeSelectorEnum timeSelector) {
        this.timeSelector = timeSelector;
        return this;
    }

    /**
     * Get the destinationTable property: The destination table used for the Summary rule results.
     * 
     * @return the destinationTable value.
     */
    public String destinationTable() {
        return this.destinationTable;
    }

    /**
     * Validates the instance.
     * 
     * @throws IllegalArgumentException thrown if the instance is not valid.
     */
    public void validate() {
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public JsonWriter toJson(JsonWriter jsonWriter) throws IOException {
        jsonWriter.writeStartObject();
        jsonWriter.writeStringField("query", this.query);
        jsonWriter.writeNumberField("binSize", this.binSize);
        jsonWriter.writeNumberField("binDelay", this.binDelay);
        jsonWriter.writeStringField("binStartTime",
            this.binStartTime == null ? null : DateTimeFormatter.ISO_OFFSET_DATE_TIME.format(this.binStartTime));
        jsonWriter.writeStringField("timeSelector", this.timeSelector == null ? null : this.timeSelector.toString());
        return jsonWriter.writeEndObject();
    }

    /**
     * Reads an instance of RuleDefinition from the JsonReader.
     * 
     * @param jsonReader The JsonReader being read.
     * @return An instance of RuleDefinition if the JsonReader was pointing to an instance of it, or null if it was
     * pointing to JSON null.
     * @throws IOException If an error occurs while reading the RuleDefinition.
     */
    public static RuleDefinition fromJson(JsonReader jsonReader) throws IOException {
        return jsonReader.readObject(reader -> {
            RuleDefinition deserializedRuleDefinition = new RuleDefinition();
            while (reader.nextToken() != JsonToken.END_OBJECT) {
                String fieldName = reader.getFieldName();
                reader.nextToken();

                if ("query".equals(fieldName)) {
                    deserializedRuleDefinition.query = reader.getString();
                } else if ("binSize".equals(fieldName)) {
                    deserializedRuleDefinition.binSize = reader.getNullable(JsonReader::getInt);
                } else if ("binDelay".equals(fieldName)) {
                    deserializedRuleDefinition.binDelay = reader.getNullable(JsonReader::getInt);
                } else if ("binStartTime".equals(fieldName)) {
                    deserializedRuleDefinition.binStartTime = reader
                        .getNullable(nonNullReader -> CoreUtils.parseBestOffsetDateTime(nonNullReader.getString()));
                } else if ("timeSelector".equals(fieldName)) {
                    deserializedRuleDefinition.timeSelector = TimeSelectorEnum.fromString(reader.getString());
                } else if ("destinationTable".equals(fieldName)) {
                    deserializedRuleDefinition.destinationTable = reader.getString();
                } else {
                    reader.skipChildren();
                }
            }

            return deserializedRuleDefinition;
        });
    }
}
