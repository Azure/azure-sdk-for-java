// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.alertsmanagement.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.alertsmanagement.AlertsManagementManager;
import com.azure.resourcemanager.alertsmanagement.models.AlertState;
import com.azure.resourcemanager.alertsmanagement.models.MonitorCondition;
import com.azure.resourcemanager.alertsmanagement.models.MonitorService;
import com.azure.resourcemanager.alertsmanagement.models.Severity;
import com.azure.resourcemanager.alertsmanagement.models.SmartGroup;
import com.azure.resourcemanager.alertsmanagement.models.SmartGroupsSortByFields;
import com.azure.resourcemanager.alertsmanagement.models.SortOrder;
import com.azure.resourcemanager.alertsmanagement.models.TimeRange;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class SmartGroupsListMockTests {
    @Test
    public void testList() throws Exception {
        String responseStr
            = "{\"value\":[{\"properties\":{\"alertsCount\":8359656321753356824,\"smartGroupState\":\"Acknowledged\",\"severity\":\"Sev2\",\"startDateTime\":\"2021-01-14T09:17:52Z\",\"lastModifiedDateTime\":\"2021-03-26T19:15:22Z\",\"lastModifiedUserName\":\"kukjtasb\",\"resources\":[{\"name\":\"pkxkdtxfk\",\"count\":2130588444165252083},{\"name\":\"twknvgm\",\"count\":6603807667381665393},{\"name\":\"yw\",\"count\":5879522166526636909}],\"resourceTypes\":[{\"name\":\"ueatgroe\",\"count\":5867758838614551124},{\"name\":\"zcbyfq\",\"count\":3455942189061392603},{\"name\":\"ytehqpuvjmvqmt\",\"count\":8284136875620833788},{\"name\":\"gr\",\"count\":1756154643718209890}],\"resourceGroups\":[{\"name\":\"jdjusk\",\"count\":2649652010948531679},{\"name\":\"ynkceysfaqegpl\",\"count\":2680120261878936468},{\"name\":\"w\",\"count\":2355549514473182456}],\"monitorServices\":[{\"name\":\"kqusybwptda\",\"count\":2387011378292120046},{\"name\":\"lf\",\"count\":5479508191284455272},{\"name\":\"poi\",\"count\":2845727062291158187}],\"monitorConditions\":[{\"name\":\"ohzrsqalsx\",\"count\":7104254094559493194},{\"name\":\"apfgsdpcvessm\",\"count\":763981426346852383},{\"name\":\"uipldqq\",\"count\":2870113627035783545},{\"name\":\"alblhtjqvq\",\"count\":939321880619260761}],\"alertStates\":[{\"name\":\"emxhzzy\",\"count\":6387904209917874810}],\"alertSeverities\":[{\"name\":\"vzrrryveimi\",\"count\":2801570864652317189},{\"name\":\"zatvfuzka\",\"count\":5392653388256869187}],\"nextLink\":\"ru\"},\"id\":\"wigsyeipqdsm\",\"name\":\"tgrqgdgkkile\",\"type\":\"lkcsmknhwtbbae\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AlertsManagementManager manager = AlertsManagementManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        PagedIterable<SmartGroup> response = manager.smartGroups()
            .list("dwnapf", "qwowftptnuw", "tkschgcgqyhl", MonitorService.PLATFORM, MonitorCondition.FIRED,
                Severity.SEV4, AlertState.CLOSED, TimeRange.ONED, 382994635015808266L,
                SmartGroupsSortByFields.LAST_MODIFIED_DATE_TIME, SortOrder.ASC, com.azure.core.util.Context.NONE);

        Assertions.assertEquals(8359656321753356824L, response.iterator().next().alertsCount());
        Assertions.assertEquals("pkxkdtxfk", response.iterator().next().resources().get(0).name());
        Assertions.assertEquals(2130588444165252083L, response.iterator().next().resources().get(0).count());
        Assertions.assertEquals("ueatgroe", response.iterator().next().resourceTypes().get(0).name());
        Assertions.assertEquals(5867758838614551124L, response.iterator().next().resourceTypes().get(0).count());
        Assertions.assertEquals("jdjusk", response.iterator().next().resourceGroups().get(0).name());
        Assertions.assertEquals(2649652010948531679L, response.iterator().next().resourceGroups().get(0).count());
        Assertions.assertEquals("kqusybwptda", response.iterator().next().monitorServices().get(0).name());
        Assertions.assertEquals(2387011378292120046L, response.iterator().next().monitorServices().get(0).count());
        Assertions.assertEquals("ohzrsqalsx", response.iterator().next().monitorConditions().get(0).name());
        Assertions.assertEquals(7104254094559493194L, response.iterator().next().monitorConditions().get(0).count());
        Assertions.assertEquals("emxhzzy", response.iterator().next().alertStates().get(0).name());
        Assertions.assertEquals(6387904209917874810L, response.iterator().next().alertStates().get(0).count());
        Assertions.assertEquals("vzrrryveimi", response.iterator().next().alertSeverities().get(0).name());
        Assertions.assertEquals(2801570864652317189L, response.iterator().next().alertSeverities().get(0).count());
        Assertions.assertEquals("ru", response.iterator().next().nextLink());
    }
}
