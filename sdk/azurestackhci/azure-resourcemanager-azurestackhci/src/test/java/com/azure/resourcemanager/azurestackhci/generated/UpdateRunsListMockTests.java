// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.azurestackhci.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.azurestackhci.AzureStackHciManager;
import com.azure.resourcemanager.azurestackhci.models.UpdateRun;
import com.azure.resourcemanager.azurestackhci.models.UpdateRunPropertiesState;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class UpdateRunsListMockTests {
    @Test
    public void testList() throws Exception {
        String responseStr
            = "{\"value\":[{\"properties\":{\"provisioningState\":\"Updating\",\"timeStarted\":\"2021-11-06T12:18:30Z\",\"lastUpdatedTime\":\"2021-07-25T20:00:35Z\",\"duration\":\"umbmwgftshfg\",\"state\":\"Unknown\",\"progress\":{\"name\":\"iagskoikuqir\",\"description\":\"kxpaowkgvnlfue\",\"errorMessage\":\"fzib\",\"status\":\"rjugcfeb\",\"startTimeUtc\":\"2021-03-04T01:50:34Z\",\"endTimeUtc\":\"2021-11-08T10:09:28Z\",\"lastUpdatedTimeUtc\":\"2021-08-31T07:05:45Z\",\"expectedExecutionTime\":\"rllld\",\"steps\":[{\"name\":\"dzwilsxryi\",\"description\":\"zlwrduxntpfxxgj\",\"errorMessage\":\"yxfwfctq\",\"status\":\"yfbkqynlzx\",\"startTimeUtc\":\"2021-02-06T03:35:14Z\",\"endTimeUtc\":\"2021-05-03T03:54:41Z\",\"lastUpdatedTimeUtc\":\"2021-11-22T18:54:33Z\",\"expectedExecutionTime\":\"kiehdmv\",\"steps\":[{},{},{}]},{\"name\":\"xxxffgmcuanszee\",\"description\":\"gcgcsapvbcq\",\"errorMessage\":\"usekijhm\",\"status\":\"enkbiv\",\"startTimeUtc\":\"2021-02-26T02:54:30Z\",\"endTimeUtc\":\"2021-10-13T18:31:18Z\",\"lastUpdatedTimeUtc\":\"2021-04-08T05:17:40Z\",\"expectedExecutionTime\":\"fqmljewynb\",\"steps\":[{},{},{},{}]}]}},\"location\":\"wv\",\"id\":\"kmjufav\",\"name\":\"lnpbsotmynkln\",\"type\":\"rznmtvrkkfcwxi\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AzureStackHciManager manager = AzureStackHciManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        PagedIterable<UpdateRun> response
            = manager.updateRuns().list("ojuxil", "zblkc", "fldfljwt", com.azure.core.util.Context.NONE);

        Assertions.assertEquals("wv", response.iterator().next().location());
        Assertions.assertEquals(OffsetDateTime.parse("2021-11-06T12:18:30Z"), response.iterator().next().timeStarted());
        Assertions.assertEquals(OffsetDateTime.parse("2021-07-25T20:00:35Z"),
            response.iterator().next().lastUpdatedTime());
        Assertions.assertEquals("umbmwgftshfg", response.iterator().next().duration());
        Assertions.assertEquals(UpdateRunPropertiesState.UNKNOWN, response.iterator().next().state());
        Assertions.assertEquals("iagskoikuqir", response.iterator().next().namePropertiesName());
        Assertions.assertEquals("kxpaowkgvnlfue", response.iterator().next().description());
        Assertions.assertEquals("fzib", response.iterator().next().errorMessage());
        Assertions.assertEquals("rjugcfeb", response.iterator().next().status());
        Assertions.assertEquals(OffsetDateTime.parse("2021-03-04T01:50:34Z"),
            response.iterator().next().startTimeUtc());
        Assertions.assertEquals(OffsetDateTime.parse("2021-11-08T10:09:28Z"), response.iterator().next().endTimeUtc());
        Assertions.assertEquals(OffsetDateTime.parse("2021-08-31T07:05:45Z"),
            response.iterator().next().lastUpdatedTimeUtc());
        Assertions.assertEquals("rllld", response.iterator().next().expectedExecutionTime());
        Assertions.assertEquals("dzwilsxryi", response.iterator().next().steps().get(0).name());
        Assertions.assertEquals("zlwrduxntpfxxgj", response.iterator().next().steps().get(0).description());
        Assertions.assertEquals("yxfwfctq", response.iterator().next().steps().get(0).errorMessage());
        Assertions.assertEquals("yfbkqynlzx", response.iterator().next().steps().get(0).status());
        Assertions.assertEquals(OffsetDateTime.parse("2021-02-06T03:35:14Z"),
            response.iterator().next().steps().get(0).startTimeUtc());
        Assertions.assertEquals(OffsetDateTime.parse("2021-05-03T03:54:41Z"),
            response.iterator().next().steps().get(0).endTimeUtc());
        Assertions.assertEquals(OffsetDateTime.parse("2021-11-22T18:54:33Z"),
            response.iterator().next().steps().get(0).lastUpdatedTimeUtc());
        Assertions.assertEquals("kiehdmv", response.iterator().next().steps().get(0).expectedExecutionTime());
    }
}
