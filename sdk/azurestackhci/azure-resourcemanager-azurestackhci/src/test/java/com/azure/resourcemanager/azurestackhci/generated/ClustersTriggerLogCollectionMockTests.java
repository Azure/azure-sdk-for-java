// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.azurestackhci.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.azurestackhci.AzureStackHciManager;
import com.azure.resourcemanager.azurestackhci.models.Cluster;
import com.azure.resourcemanager.azurestackhci.models.DiagnosticLevel;
import com.azure.resourcemanager.azurestackhci.models.LogCollectionRequest;
import com.azure.resourcemanager.azurestackhci.models.LogCollectionRequestProperties;
import com.azure.resourcemanager.azurestackhci.models.ManagedServiceIdentityType;
import com.azure.resourcemanager.azurestackhci.models.SoftwareAssuranceIntent;
import com.azure.resourcemanager.azurestackhci.models.WindowsServerSubscription;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class ClustersTriggerLogCollectionMockTests {
    @Test
    public void testTriggerLogCollection() throws Exception {
        String responseStr
            = "{\"identity\":{\"principalId\":\"ac2e6bc9-6c97-4f7b-be87-8961cbe40490\",\"tenantId\":\"ea2d5e18-cc8d-4dcf-9576-d315e1a0b6de\",\"type\":\"SystemAssigned\",\"userAssignedIdentities\":{\"ovribq\":{\"principalId\":\"de0fa179-8723-4aec-ba38-a6ab2f55651e\",\"clientId\":\"2d13fa60-29cd-4e75-b3c7-fe1a399c4ba8\"}}},\"properties\":{\"provisioningState\":\"Succeeded\",\"status\":\"NotYetRegistered\",\"connectivityStatus\":\"NotSpecified\",\"cloudId\":\"taznkcqwwxwjyof\",\"cloudManagementEndpoint\":\"hnkbtlwljssmctsn\",\"aadClientId\":\"kpwolg\",\"aadTenantId\":\"ubxbteogfgfiijr\",\"aadApplicationObjectId\":\"wlefksxqceazfpxg\",\"aadServicePrincipalObjectId\":\"qvzvlu\",\"softwareAssuranceProperties\":{\"softwareAssuranceStatus\":\"Disabled\",\"softwareAssuranceIntent\":\"Enable\",\"lastUpdated\":\"2021-06-14T11:44:36Z\"},\"logCollectionProperties\":{\"fromDate\":\"2021-05-24T23:17:46Z\",\"toDate\":\"2021-03-03T06:35:43Z\",\"lastLogGenerated\":\"2021-07-14T22:22:26Z\",\"logCollectionSessionDetails\":[{\"logStartTime\":\"2021-08-12T03:41:34Z\",\"logEndTime\":\"2021-07-02T15:12:28Z\",\"timeCollected\":\"2021-08-22T05:41:09Z\",\"logSize\":7533324825716135469,\"logCollectionStatus\":\"InProgress\",\"logCollectionJobType\":\"OnDemand\",\"correlationId\":\"jdhsoy\",\"endTimeCollected\":\"2021-10-03T11:49:53Z\",\"logCollectionError\":{}}]},\"remoteSupportProperties\":{\"accessLevel\":\"DiagnosticsAndRepair\",\"expirationTimeStamp\":\"2021-11-12T07:02:25Z\",\"remoteSupportType\":\"Revoke\",\"remoteSupportNodeSettings\":[{\"arcResourceId\":\"boujstkfvv\",\"state\":\"hxcd\",\"createdAt\":\"2020-12-22T05:34:09Z\",\"updatedAt\":\"2021-03-14T15:19:04Z\",\"connectionStatus\":\"ygnxcgjtfrnqukt\",\"connectionErrorMessage\":\"nslnlrxsmyltrwnt\",\"transcriptLocation\":\"tbgwjdxwnazkur\"}],\"remoteSupportSessionDetails\":[{\"sessionStartTime\":\"2021-06-12T09:43:04Z\",\"sessionEndTime\":\"2021-11-02T22:00:47Z\",\"nodeName\":\"hsetwwj\",\"duration\":3302215545380544215,\"accessLevel\":\"Diagnostics\"},{\"sessionStartTime\":\"2021-06-13T21:06:36Z\",\"sessionEndTime\":\"2021-04-07T08:12:26Z\",\"nodeName\":\"y\",\"duration\":6688942895771681924,\"accessLevel\":\"Diagnostics\"}]},\"desiredProperties\":{\"windowsServerSubscription\":\"Enabled\",\"diagnosticLevel\":\"Basic\"},\"reportedProperties\":{\"clusterName\":\"keys\",\"clusterId\":\"wfopazdazg\",\"clusterVersion\":\"qgpewqcfutmdpvoz\",\"nodes\":[{\"name\":\"bknlzcl\",\"id\":99.73375,\"windowsServerSubscription\":\"Enabled\",\"nodeType\":\"FirstParty\",\"ehcResourceId\":\"ndc\",\"manufacturer\":\"dwzqauxzanhmkvfr\",\"model\":\"kudrbcpftx\",\"osName\":\"qyemebu\",\"osVersion\":\"ucmci\",\"osDisplayVersion\":\"nee\",\"serialNumber\":\"jauwcgxefnohaitr\",\"coreCount\":28.120434,\"memoryInGiB\":41.137814,\"lastLicensingTimestamp\":\"2021-03-02T16:05:57Z\",\"oemActivation\":\"Enabled\"},{\"name\":\"asmxubvfbngf\",\"id\":84.15061,\"windowsServerSubscription\":\"Disabled\",\"nodeType\":\"FirstParty\",\"ehcResourceId\":\"iylfmpztrau\",\"manufacturer\":\"vhl\",\"model\":\"culregpqt\",\"osName\":\"jhvrztnvgyshqrdg\",\"osVersion\":\"wmewjzlpyk\",\"osDisplayVersion\":\"azzwjcay\",\"serialNumber\":\"zrransyb\",\"coreCount\":75.015366,\"memoryInGiB\":26.378132,\"lastLicensingTimestamp\":\"2021-09-20T13:23:20Z\",\"oemActivation\":\"Enabled\"}],\"lastUpdated\":\"2021-03-21T23:43:17Z\",\"imdsAttestation\":\"Disabled\",\"diagnosticLevel\":\"Basic\",\"supportedCapabilities\":[\"fscjfn\",\"jwvuag\",\"qwtltngvmreupt\"],\"clusterType\":\"ThirdParty\",\"manufacturer\":\"m\",\"oemActivation\":\"Disabled\"},\"isolatedVmAttestationConfiguration\":{\"attestationResourceId\":\"olxf\",\"relyingPartyServiceEndpoint\":\"aghm\",\"attestationServiceEndpoint\":\"nwlslrcigtzjcvbx\"},\"trialDaysRemaining\":4.619074,\"billingModel\":\"snsso\",\"registrationTimestamp\":\"2021-08-20T00:22:26Z\",\"lastSyncTimestamp\":\"2021-09-29T19:56:37Z\",\"lastBillingTimestamp\":\"2021-02-25T19:52:15Z\",\"serviceEndpoint\":\"nievwffc\",\"resourceProviderObjectId\":\"yezslpu\"},\"location\":\"cbdsvalpnptwtrk\",\"tags\":{\"x\":\"azwu\",\"obfelhldiuhz\":\"qvn\"},\"id\":\"gqlmfaewzgi\",\"name\":\"djpxpqht\",\"type\":\"qhnmhk\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AzureStackHciManager manager = AzureStackHciManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        Cluster response = manager.clusters()
            .triggerLogCollection("ecominxojjluxxd", "ilz",
                new LogCollectionRequest().withProperties(
                    new LogCollectionRequestProperties().withFromDate(OffsetDateTime.parse("2021-05-18T19:06:31Z"))
                        .withToDate(OffsetDateTime.parse("2021-08-12T20:15:45Z"))),
                com.azure.core.util.Context.NONE);

        Assertions.assertEquals("cbdsvalpnptwtrk", response.location());
        Assertions.assertEquals("azwu", response.tags().get("x"));
        Assertions.assertEquals(ManagedServiceIdentityType.SYSTEM_ASSIGNED, response.typeIdentityType());
        Assertions.assertEquals("hnkbtlwljssmctsn", response.cloudManagementEndpoint());
        Assertions.assertEquals("kpwolg", response.aadClientId());
        Assertions.assertEquals("ubxbteogfgfiijr", response.aadTenantId());
        Assertions.assertEquals("wlefksxqceazfpxg", response.aadApplicationObjectId());
        Assertions.assertEquals("qvzvlu", response.aadServicePrincipalObjectId());
        Assertions.assertEquals(SoftwareAssuranceIntent.ENABLE,
            response.softwareAssuranceProperties().softwareAssuranceIntent());
        Assertions.assertEquals(WindowsServerSubscription.ENABLED,
            response.desiredProperties().windowsServerSubscription());
        Assertions.assertEquals(DiagnosticLevel.BASIC, response.desiredProperties().diagnosticLevel());
    }
}
