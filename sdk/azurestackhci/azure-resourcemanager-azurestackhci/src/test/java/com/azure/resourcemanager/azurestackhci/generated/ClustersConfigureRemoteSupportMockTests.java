// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.azurestackhci.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.azurestackhci.AzureStackHciManager;
import com.azure.resourcemanager.azurestackhci.models.Cluster;
import com.azure.resourcemanager.azurestackhci.models.DiagnosticLevel;
import com.azure.resourcemanager.azurestackhci.models.ManagedServiceIdentityType;
import com.azure.resourcemanager.azurestackhci.models.RemoteSupportRequest;
import com.azure.resourcemanager.azurestackhci.models.RemoteSupportRequestProperties;
import com.azure.resourcemanager.azurestackhci.models.RemoteSupportType;
import com.azure.resourcemanager.azurestackhci.models.SoftwareAssuranceIntent;
import com.azure.resourcemanager.azurestackhci.models.WindowsServerSubscription;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class ClustersConfigureRemoteSupportMockTests {
    @Test
    public void testConfigureRemoteSupport() throws Exception {
        String responseStr
            = "{\"identity\":{\"principalId\":\"b8f814ba-9153-4dbb-a55c-a4784d776b2b\",\"tenantId\":\"03eb09e9-57d9-4bdb-8ba3-398270e83410\",\"type\":\"SystemAssigned\",\"userAssignedIdentities\":{\"xu\":{\"principalId\":\"ba6912ee-e733-479b-a534-2b973173ef64\",\"clientId\":\"0aa6a0b5-0e8e-495b-a325-860b198ce08c\"},\"pfdvhaxdv\":{\"principalId\":\"1a150846-35d6-4462-b86a-39b7be8b5d1a\",\"clientId\":\"93066292-72ab-4012-9fb1-456c4d1e784d\"},\"ehpphthdklmveta\":{\"principalId\":\"b0761ea7-79ba-46f2-9cd8-415381441e51\",\"clientId\":\"774f2694-d08a-4557-ae7a-0c2a6bf48d4a\"}}},\"properties\":{\"provisioningState\":\"Succeeded\",\"status\":\"NotSpecified\",\"connectivityStatus\":\"NotYetRegistered\",\"cloudId\":\"wgiksbbvtoo\",\"cloudManagementEndpoint\":\"p\",\"aadClientId\":\"wp\",\"aadTenantId\":\"hgjtnhtukfaci\",\"aadApplicationObjectId\":\"bfntumeezbxvq\",\"aadServicePrincipalObjectId\":\"nuvwcgasgomtmjzw\",\"softwareAssuranceProperties\":{\"softwareAssuranceStatus\":\"Disabled\",\"softwareAssuranceIntent\":\"Enable\",\"lastUpdated\":\"2021-04-20T10:00:56Z\"},\"logCollectionProperties\":{\"fromDate\":\"2021-06-19T19:54:52Z\",\"toDate\":\"2021-08-06T00:39:29Z\",\"lastLogGenerated\":\"2021-02-10T04:05:47Z\",\"logCollectionSessionDetails\":[{\"logStartTime\":\"2021-02-07T23:38:04Z\",\"logEndTime\":\"2021-10-21T13:20:35Z\",\"timeCollected\":\"2021-08-23T00:31:41Z\",\"logSize\":4891435980141713838,\"logCollectionStatus\":\"Failed\",\"logCollectionJobType\":\"OnDemand\",\"correlationId\":\"ll\",\"endTimeCollected\":\"2021-10-05T03:59:42Z\",\"logCollectionError\":{}},{\"logStartTime\":\"2021-11-03T13:45:26Z\",\"logEndTime\":\"2021-10-12T13:30:19Z\",\"timeCollected\":\"2021-03-16T03:23:22Z\",\"logSize\":2662581133111301135,\"logCollectionStatus\":\"InProgress\",\"logCollectionJobType\":\"Scheduled\",\"correlationId\":\"mlyotg\",\"endTimeCollected\":\"2021-01-04T07:08:54Z\",\"logCollectionError\":{}},{\"logStartTime\":\"2021-05-06T10:13:33Z\",\"logEndTime\":\"2021-10-19T20:33:09Z\",\"timeCollected\":\"2021-02-14T10:44:54Z\",\"logSize\":8357561947868417233,\"logCollectionStatus\":\"None\",\"logCollectionJobType\":\"OnDemand\",\"correlationId\":\"bxeetqujxcxxqn\",\"endTimeCollected\":\"2021-08-16T20:52:08Z\",\"logCollectionError\":{}},{\"logStartTime\":\"2021-04-15T05:07:22Z\",\"logEndTime\":\"2021-10-10T07:02:55Z\",\"timeCollected\":\"2021-05-20T04:42:02Z\",\"logSize\":7207641865244379752,\"logCollectionStatus\":\"Failed\",\"logCollectionJobType\":\"Scheduled\",\"correlationId\":\"v\",\"endTimeCollected\":\"2021-04-17T16:51:58Z\",\"logCollectionError\":{}}]},\"remoteSupportProperties\":{\"accessLevel\":\"DiagnosticsAndRepair\",\"expirationTimeStamp\":\"2021-09-30T10:56:46Z\",\"remoteSupportType\":\"Enable\",\"remoteSupportNodeSettings\":[{\"arcResourceId\":\"ilcchskxxkansbvr\",\"state\":\"qgvtojrulfu\",\"createdAt\":\"2021-09-20T21:53:57Z\",\"updatedAt\":\"2021-11-30T18:51:59Z\",\"connectionStatus\":\"hcfjzhxlyubqjro\",\"connectionErrorMessage\":\"vrjeqmtzzbeqrztr\",\"transcriptLocation\":\"lxrdhabsrwrsn\"},{\"arcResourceId\":\"pqatiwkkvyanxkv\",\"state\":\"semsvuvd\",\"createdAt\":\"2021-07-09T07:15:04Z\",\"updatedAt\":\"2021-03-06T23:53:15Z\",\"connectionStatus\":\"qmmlivrjjxnwx\",\"connectionErrorMessage\":\"hpojxl\",\"transcriptLocation\":\"z\"},{\"arcResourceId\":\"pgfquwzpwiibelwc\",\"state\":\"wkwbpjx\",\"createdAt\":\"2021-07-06T07:22:37Z\",\"updatedAt\":\"2021-05-19T01:42:55Z\",\"connectionStatus\":\"sqtbxxniu\",\"connectionErrorMessage\":\"dzhgbdgzpags\",\"transcriptLocation\":\"nadbu\"},{\"arcResourceId\":\"r\",\"state\":\"fllmqiy\",\"createdAt\":\"2021-08-15T19:08:33Z\",\"updatedAt\":\"2021-11-16T18:35:26Z\",\"connectionStatus\":\"nkkiiwvmtumxpy\",\"connectionErrorMessage\":\"jfuaxroqvqpilrgu\",\"transcriptLocation\":\"anlduwzorxsb\"}],\"remoteSupportSessionDetails\":[{\"sessionStartTime\":\"2021-02-04T06:25:12Z\",\"sessionEndTime\":\"2021-04-10T14:35:27Z\",\"nodeName\":\"mxkqvf\",\"duration\":2889876698432401855,\"accessLevel\":\"Diagnostics\"},{\"sessionStartTime\":\"2021-02-18T05:36:17Z\",\"sessionEndTime\":\"2021-07-14T16:46:48Z\",\"nodeName\":\"wyvpj\",\"duration\":1357868514258880860,\"accessLevel\":\"DiagnosticsAndRepair\"}]},\"desiredProperties\":{\"windowsServerSubscription\":\"Disabled\",\"diagnosticLevel\":\"Enhanced\"},\"reportedProperties\":{\"clusterName\":\"exkydfb\",\"clusterId\":\"javh\",\"clusterVersion\":\"rkjd\",\"nodes\":[{\"name\":\"liegftcvbi\",\"id\":81.57286,\"windowsServerSubscription\":\"Enabled\",\"nodeType\":\"FirstParty\",\"ehcResourceId\":\"dnkefgm\",\"manufacturer\":\"hcebuvczldbglzo\",\"model\":\"baaq\",\"osName\":\"ekaj\",\"osVersion\":\"yzgsnorbjgmnz\",\"osDisplayVersion\":\"t\",\"serialNumber\":\"rxkhlob\",\"coreCount\":79.76163,\"memoryInGiB\":19.954985,\"lastLicensingTimestamp\":\"2021-05-11T18:13:33Z\",\"oemActivation\":\"Disabled\"}],\"lastUpdated\":\"2021-03-08T05:22:54Z\",\"imdsAttestation\":\"Enabled\",\"diagnosticLevel\":\"Off\",\"supportedCapabilities\":[\"uosnuud\"],\"clusterType\":\"ThirdParty\",\"manufacturer\":\"hyibdrqrswh\",\"oemActivation\":\"Disabled\"},\"isolatedVmAttestationConfiguration\":{\"attestationResourceId\":\"y\",\"relyingPartyServiceEndpoint\":\"wtjoxz\",\"attestationServiceEndpoint\":\"wfqchvcz\"},\"trialDaysRemaining\":0.509882,\"billingModel\":\"nctagfyvrtpqpem\",\"registrationTimestamp\":\"2021-07-17T01:09:25Z\",\"lastSyncTimestamp\":\"2021-02-06T15:16:06Z\",\"lastBillingTimestamp\":\"2021-12-03T07:21:37Z\",\"serviceEndpoint\":\"dqhqyhwqwemv\",\"resourceProviderObjectId\":\"abckmzeoxinhgre\"},\"location\":\"twhlpuzjpce\",\"tags\":{\"phmsexroq\":\"zangprbfaxyxzlbc\",\"nfee\":\"ndktxfv\",\"bgnixxoww\":\"gpkrie\"},\"id\":\"kyfwnwpiwxeiicr\",\"name\":\"p\",\"type\":\"pk\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        AzureStackHciManager manager = AzureStackHciManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        Cluster response = manager.clusters()
            .configureRemoteSupport("ezsdsuxheq", "gcruxspinym",
                new RemoteSupportRequest().withProperties(new RemoteSupportRequestProperties()
                    .withExpirationTimestamp(OffsetDateTime.parse("2021-06-04T16:05:44Z"))
                    .withRemoteSupportType(RemoteSupportType.ENABLE)),
                com.azure.core.util.Context.NONE);

        Assertions.assertEquals("twhlpuzjpce", response.location());
        Assertions.assertEquals("zangprbfaxyxzlbc", response.tags().get("phmsexroq"));
        Assertions.assertEquals(ManagedServiceIdentityType.SYSTEM_ASSIGNED, response.typeIdentityType());
        Assertions.assertEquals("p", response.cloudManagementEndpoint());
        Assertions.assertEquals("wp", response.aadClientId());
        Assertions.assertEquals("hgjtnhtukfaci", response.aadTenantId());
        Assertions.assertEquals("bfntumeezbxvq", response.aadApplicationObjectId());
        Assertions.assertEquals("nuvwcgasgomtmjzw", response.aadServicePrincipalObjectId());
        Assertions.assertEquals(SoftwareAssuranceIntent.ENABLE,
            response.softwareAssuranceProperties().softwareAssuranceIntent());
        Assertions.assertEquals(WindowsServerSubscription.DISABLED,
            response.desiredProperties().windowsServerSubscription());
        Assertions.assertEquals(DiagnosticLevel.ENHANCED, response.desiredProperties().diagnosticLevel());
    }
}
