// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.analytics.onlineexperimentation.generated;

import com.azure.analytics.onlineexperimentation.models.AggregatedValue;
import com.azure.analytics.onlineexperimentation.models.AverageMetricDefinition;
import com.azure.analytics.onlineexperimentation.models.DesiredDirection;
import com.azure.analytics.onlineexperimentation.models.ExperimentMetric;
import com.azure.analytics.onlineexperimentation.models.ExperimentMetricDefinition;
import com.azure.analytics.onlineexperimentation.models.ExperimentMetricType;
import com.azure.analytics.onlineexperimentation.models.LifecycleStage;
import com.azure.core.http.RequestConditions;
import java.time.OffsetDateTime;
import java.util.Arrays;
import java.util.List;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Disabled;
import org.junit.jupiter.api.Test;

@Disabled
public final class CreateOrUpdateMetricAverageTests extends OnlineExperimentationClientTestBase {
    @Test
    @Disabled
    public void testCreateOrUpdateMetricAverageTests() {
        // method invocation
        ExperimentMetric response = onlineExperimentationClient.createOrUpdateMetric("avg_purchase_revenue",
            new ExperimentMetric().setLifecycle(LifecycleStage.ACTIVE)
                .setDisplayName("Average revenue per purchase [USD]")
                .setDescription(
                    "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.")
                .setCategories(Arrays.asList("Monetization"))
                .setDesiredDirection(DesiredDirection.INCREASE)
                .setDefinition(new AverageMetricDefinition().setValue(new AggregatedValue().setEventName("Transaction")
                    .setFilter("Revenue > 0")
                    .setEventProperty("Revenue"))),
            new RequestConditions().setIfMatch("vxexdn")
                .setIfNoneMatch("ijchzdh")
                .setIfUnmodifiedSince(OffsetDateTime.parse("2024-08-22T02:02:11Z"))
                .setIfModifiedSince(OffsetDateTime.parse("2024-08-22T02:02:11Z")));

        // response assertion
        Assertions.assertNotNull(response);
        // verify property "id"
        Assertions.assertEquals("avg_purchase_revenue", response.getId());
        // verify property "lifecycle"
        Assertions.assertEquals(LifecycleStage.ACTIVE, response.getLifecycle());
        // verify property "displayName"
        Assertions.assertEquals("Average revenue per purchase [USD]", response.getDisplayName());
        // verify property "description"
        Assertions.assertEquals(
            "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.",
            response.getDescription());
        // verify property "categories"
        List<String> responseCategories = response.getCategories();
        Assertions.assertEquals("Monetization", responseCategories.iterator().next());
        // verify property "desiredDirection"
        Assertions.assertEquals(DesiredDirection.INCREASE, response.getDesiredDirection());
        // verify property "definition"
        ExperimentMetricDefinition responseDefinition = response.getDefinition();
        Assertions.assertNotNull(responseDefinition);
        Assertions.assertEquals(ExperimentMetricType.AVERAGE, responseDefinition.getType());
        // verify property "eTag"
        Assertions.assertEquals("ckswkavwgassdlocwuzxz", response.getETag());
        // verify property "lastModifiedAt"
        Assertions.assertNotNull(response.getLastModifiedAt());
    }
}
