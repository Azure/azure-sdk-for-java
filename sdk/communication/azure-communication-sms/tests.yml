trigger: none

stages:
- template: /eng/pipelines/templates/stages/archetype-sdk-tests.yml
  parameters:
    CloudConfig:
      Public:
        SubscriptionConfigurations:
          - $(sub-config-azure-cloud-test-resources)
          - $(sub-config-communication-services-cloud-test-resources-common)
          - $(sub-config-communication-services-cloud-test-resources-java)
    Clouds: Public
    Artifacts:
      - name: azure-communication-sms
        groupId: com.azure
        safeName: azurecommunicationsms
    ServiceDirectory: communication
    PostSteps:
      - task: PublishCodeCoverageResults@1
      condition: and(eq(variables['Agent.OS'], 'Windows_NT'), eq(variables['JavaTestVersion'], '1.11'))
      inputs:
          codeCoverageTool: JaCoCo
          summaryFileLocation: sdk/communication/azure-communication-sms/target/site/jacoco-aggregate/jacoco.xml
          reportDirectory: sdk/communication/azure-communication-sms/target/site/jacoco-aggregate/
          failIfCoverageEmpty: false
    EnvVars:
      SKIP_LIVE_TEST: TRUE
