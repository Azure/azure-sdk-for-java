// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.newrelicobservability.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.newrelicobservability.models.ManagedServiceIdentity;
import com.azure.resourcemanager.newrelicobservability.models.ManagedServiceIdentityType;
import com.azure.resourcemanager.newrelicobservability.models.UserAssignedIdentity;
import java.util.HashMap;
import java.util.Map;
import org.junit.jupiter.api.Assertions;

public final class ManagedServiceIdentityTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        ManagedServiceIdentity model = BinaryData.fromString(
            "{\"principalId\":\"93f5a8cc-607f-418d-b9d3-d6b74a1e9e73\",\"tenantId\":\"779a61d0-b64d-4d18-9d89-2a2fd778b8d2\",\"type\":\"SystemAssigned,UserAssigned\",\"userAssignedIdentities\":{\"gphuticndvka\":{\"principalId\":\"1b4edc35-09a9-450c-8383-7c3761688e9b\",\"clientId\":\"5d5b5b8f-3e98-420c-8168-5fb47fc496c2\"},\"yiftyhxhuro\":{\"principalId\":\"ceeedfe4-fe89-4430-bca0-e15a3eb303da\",\"clientId\":\"af4c9b5f-ffe1-4b62-85f1-aec755ec5778\"},\"yxolniwp\":{\"principalId\":\"0b9b587a-c902-4f10-a409-c929f06a1a8b\",\"clientId\":\"0557a3f5-756e-4a73-9eef-c8c28a27b010\"},\"kjfkg\":{\"principalId\":\"1e48b268-71d5-4994-a47e-f417be58e359\",\"clientId\":\"71fd3ead-42fb-4384-a54c-b40e46a59d35\"}}}")
            .toObject(ManagedServiceIdentity.class);
        Assertions.assertEquals(ManagedServiceIdentityType.SYSTEM_ASSIGNED_USER_ASSIGNED, model.type());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        ManagedServiceIdentity model
            = new ManagedServiceIdentity().withType(ManagedServiceIdentityType.SYSTEM_ASSIGNED_USER_ASSIGNED)
                .withUserAssignedIdentities(
                    mapOf("gphuticndvka", new UserAssignedIdentity(), "yiftyhxhuro", new UserAssignedIdentity(),
                        "yxolniwp", new UserAssignedIdentity(), "kjfkg", new UserAssignedIdentity()));
        model = BinaryData.fromObject(model).toObject(ManagedServiceIdentity.class);
        Assertions.assertEquals(ManagedServiceIdentityType.SYSTEM_ASSIGNED_USER_ASSIGNED, model.type());
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
