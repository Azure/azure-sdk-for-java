// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.frontdoor.generated;

import com.azure.core.util.BinaryData;
import com.azure.resourcemanager.frontdoor.models.ManagedRuleExclusion;
import com.azure.resourcemanager.frontdoor.models.ManagedRuleExclusionMatchVariable;
import com.azure.resourcemanager.frontdoor.models.ManagedRuleExclusionSelectorMatchOperator;
import com.azure.resourcemanager.frontdoor.models.ManagedRuleGroupOverride;
import com.azure.resourcemanager.frontdoor.models.ManagedRuleSet;
import com.azure.resourcemanager.frontdoor.models.ManagedRuleSetActionType;
import java.util.Arrays;
import org.junit.jupiter.api.Assertions;

public final class ManagedRuleSetTests {
    @org.junit.jupiter.api.Test
    public void testDeserialize() throws Exception {
        ManagedRuleSet model =
            BinaryData
                .fromString(
                    "{\"ruleSetType\":\"xu\",\"ruleSetVersion\":\"emdwzrmuhapfc\",\"ruleSetAction\":\"Block\",\"exclusions\":[{\"matchVariable\":\"RequestBodyJsonArgNames\",\"selectorMatchOperator\":\"EndsWith\",\"selector\":\"vpsvuoymgcce\"},{\"matchVariable\":\"RequestHeaderNames\",\"selectorMatchOperator\":\"EndsWith\",\"selector\":\"zrypqlmfeokerqw\"},{\"matchVariable\":\"RequestCookieNames\",\"selectorMatchOperator\":\"EqualsAny\",\"selector\":\"kobopgxed\"},{\"matchVariable\":\"RequestBodyJsonArgNames\",\"selectorMatchOperator\":\"EndsWith\",\"selector\":\"epbqpcrfkbw\"}],\"ruleGroupOverrides\":[{\"ruleGroupName\":\"njv\",\"exclusions\":[],\"rules\":[]},{\"ruleGroupName\":\"p\",\"exclusions\":[],\"rules\":[]},{\"ruleGroupName\":\"nkhtjsyingw\",\"exclusions\":[],\"rules\":[]},{\"ruleGroupName\":\"tdhtmdvyp\",\"exclusions\":[],\"rules\":[]}]}")
                .toObject(ManagedRuleSet.class);
        Assertions.assertEquals("xu", model.ruleSetType());
        Assertions.assertEquals("emdwzrmuhapfc", model.ruleSetVersion());
        Assertions.assertEquals(ManagedRuleSetActionType.BLOCK, model.ruleSetAction());
        Assertions
            .assertEquals(
                ManagedRuleExclusionMatchVariable.REQUEST_BODY_JSON_ARG_NAMES,
                model.exclusions().get(0).matchVariable());
        Assertions
            .assertEquals(
                ManagedRuleExclusionSelectorMatchOperator.ENDS_WITH, model.exclusions().get(0).selectorMatchOperator());
        Assertions.assertEquals("vpsvuoymgcce", model.exclusions().get(0).selector());
        Assertions.assertEquals("njv", model.ruleGroupOverrides().get(0).ruleGroupName());
    }

    @org.junit.jupiter.api.Test
    public void testSerialize() throws Exception {
        ManagedRuleSet model =
            new ManagedRuleSet()
                .withRuleSetType("xu")
                .withRuleSetVersion("emdwzrmuhapfc")
                .withRuleSetAction(ManagedRuleSetActionType.BLOCK)
                .withExclusions(
                    Arrays
                        .asList(
                            new ManagedRuleExclusion()
                                .withMatchVariable(ManagedRuleExclusionMatchVariable.REQUEST_BODY_JSON_ARG_NAMES)
                                .withSelectorMatchOperator(ManagedRuleExclusionSelectorMatchOperator.ENDS_WITH)
                                .withSelector("vpsvuoymgcce"),
                            new ManagedRuleExclusion()
                                .withMatchVariable(ManagedRuleExclusionMatchVariable.REQUEST_HEADER_NAMES)
                                .withSelectorMatchOperator(ManagedRuleExclusionSelectorMatchOperator.ENDS_WITH)
                                .withSelector("zrypqlmfeokerqw"),
                            new ManagedRuleExclusion()
                                .withMatchVariable(ManagedRuleExclusionMatchVariable.REQUEST_COOKIE_NAMES)
                                .withSelectorMatchOperator(ManagedRuleExclusionSelectorMatchOperator.EQUALS_ANY)
                                .withSelector("kobopgxed"),
                            new ManagedRuleExclusion()
                                .withMatchVariable(ManagedRuleExclusionMatchVariable.REQUEST_BODY_JSON_ARG_NAMES)
                                .withSelectorMatchOperator(ManagedRuleExclusionSelectorMatchOperator.ENDS_WITH)
                                .withSelector("epbqpcrfkbw")))
                .withRuleGroupOverrides(
                    Arrays
                        .asList(
                            new ManagedRuleGroupOverride()
                                .withRuleGroupName("njv")
                                .withExclusions(Arrays.asList())
                                .withRules(Arrays.asList()),
                            new ManagedRuleGroupOverride()
                                .withRuleGroupName("p")
                                .withExclusions(Arrays.asList())
                                .withRules(Arrays.asList()),
                            new ManagedRuleGroupOverride()
                                .withRuleGroupName("nkhtjsyingw")
                                .withExclusions(Arrays.asList())
                                .withRules(Arrays.asList()),
                            new ManagedRuleGroupOverride()
                                .withRuleGroupName("tdhtmdvyp")
                                .withExclusions(Arrays.asList())
                                .withRules(Arrays.asList())));
        model = BinaryData.fromObject(model).toObject(ManagedRuleSet.class);
        Assertions.assertEquals("xu", model.ruleSetType());
        Assertions.assertEquals("emdwzrmuhapfc", model.ruleSetVersion());
        Assertions.assertEquals(ManagedRuleSetActionType.BLOCK, model.ruleSetAction());
        Assertions
            .assertEquals(
                ManagedRuleExclusionMatchVariable.REQUEST_BODY_JSON_ARG_NAMES,
                model.exclusions().get(0).matchVariable());
        Assertions
            .assertEquals(
                ManagedRuleExclusionSelectorMatchOperator.ENDS_WITH, model.exclusions().get(0).selectorMatchOperator());
        Assertions.assertEquals("vpsvuoymgcce", model.exclusions().get(0).selector());
        Assertions.assertEquals("njv", model.ruleGroupOverrides().get(0).ruleGroupName());
    }
}
