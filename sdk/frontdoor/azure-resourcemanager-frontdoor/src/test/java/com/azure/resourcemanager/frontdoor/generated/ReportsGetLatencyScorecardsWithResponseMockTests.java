// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.frontdoor.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.AzureEnvironment;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.frontdoor.FrontDoorManager;
import com.azure.resourcemanager.frontdoor.models.LatencyScorecard;
import com.azure.resourcemanager.frontdoor.models.LatencyScorecardAggregationInterval;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class ReportsGetLatencyScorecardsWithResponseMockTests {
    @Test
    public void testGetLatencyScorecardsWithResponse() throws Exception {
        String responseStr
            = "{\"properties\":{\"id\":\"shtuwgm\",\"name\":\"uafpwzyifrk\",\"description\":\"ltxeqip\",\"endpointA\":\"zdyi\",\"endpointB\":\"fayorpravkjoges\",\"startDateTimeUTC\":\"2021-02-22T21:03:14Z\",\"endDateTimeUTC\":\"2021-11-12T14:16:13Z\",\"country\":\"jkwynqxaekqsykv\",\"latencyMetrics\":[{\"name\":\"pkevmylt\",\"endDateTimeUTC\":\"rspxklur\",\"aValue\":14.385528,\"bValue\":95.610214,\"delta\":84.517,\"deltaPercent\":3.5500765,\"aCLower95CI\":46.879883,\"aHUpper95CI\":5.04877,\"bCLower95CI\":30.904234,\"bUpper95CI\":72.015144},{\"name\":\"wxigpxv\",\"endDateTimeUTC\":\"maupxvpi\",\"aValue\":2.3832917,\"bValue\":12.627816,\"delta\":46.58986,\"deltaPercent\":61.054115,\"aCLower95CI\":38.121216,\"aHUpper95CI\":31.361979,\"bCLower95CI\":35.442387,\"bUpper95CI\":28.172707}]},\"location\":\"ds\",\"tags\":{\"gvdihoynkrxwetwk\":\"ytoithgygvfl\",\"dqumoenodnai\":\"rcyrucpcunnu\"},\"id\":\"nhq\",\"name\":\"skndnelqkaadlknw\",\"type\":\"oanniyopetxi\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        FrontDoorManager manager = FrontDoorManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureEnvironment.AZURE));

        LatencyScorecard response = manager.reports()
            .getLatencyScorecardsWithResponse("udqll", "sauzpjlx", "ehuxiqhzlraym",
                LatencyScorecardAggregationInterval.DAILY, "xls", "ihmxrfdsajredn", com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("ds", response.location());
        Assertions.assertEquals("ytoithgygvfl", response.tags().get("gvdihoynkrxwetwk"));
    }
}
