// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.managednetworkfabric.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.managednetworkfabric.FilesharesManager;
import com.azure.resourcemanager.managednetworkfabric.models.AccessControlList;
import com.azure.resourcemanager.managednetworkfabric.models.AccessControlListAction;
import com.azure.resourcemanager.managednetworkfabric.models.AccessControlListMatchCondition;
import com.azure.resourcemanager.managednetworkfabric.models.AccessControlListMatchConfiguration;
import com.azure.resourcemanager.managednetworkfabric.models.AccessControlListProperties;
import com.azure.resourcemanager.managednetworkfabric.models.AclType;
import com.azure.resourcemanager.managednetworkfabric.models.BooleanEnumProperty;
import com.azure.resourcemanager.managednetworkfabric.models.CommonDynamicMatchConfiguration;
import com.azure.resourcemanager.managednetworkfabric.models.CommunityActionTypes;
import com.azure.resourcemanager.managednetworkfabric.models.ConfigurationType;
import com.azure.resourcemanager.managednetworkfabric.models.DeviceRole;
import com.azure.resourcemanager.managednetworkfabric.models.GlobalAccessControlListActionProperties;
import com.azure.resourcemanager.managednetworkfabric.models.IPAddressType;
import com.azure.resourcemanager.managednetworkfabric.models.IpGroupProperties;
import com.azure.resourcemanager.managednetworkfabric.models.PortGroupProperties;
import com.azure.resourcemanager.managednetworkfabric.models.VlanGroupProperties;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class AccessControlListsCreateMockTests {
    @Test
    public void testCreate() throws Exception {
        String responseStr
            = "{\"properties\":{\"annotation\":\"vz\",\"configurationType\":\"File\",\"aclsUrl\":\"kfeomotquqlqeyis\",\"defaultAction\":\"Permit\",\"matchConfigurations\":[{\"matchConfigurationName\":\"dpfvlsqmmetwtla\",\"sequenceNumber\":8308518742671531249,\"ipAddressType\":\"IPv6\",\"matchConditions\":[{},{},{},{}],\"actions\":[{}]}],\"dynamicMatchConfigurations\":[{\"ipGroups\":[{},{},{}],\"vlanGroups\":[{},{},{}],\"portGroups\":[{}]}],\"lastSyncedTime\":\"2021-06-19T18:52:07Z\",\"aclType\":\"ControlPlaneTrafficPolicy\",\"deviceRole\":\"NPB\",\"globalAccessControlListActions\":{\"enableCount\":\"True\"},\"lastOperation\":{\"details\":\"hrchmetvz\"},\"configurationState\":\"Provisioning\",\"provisioningState\":\"Succeeded\",\"administrativeState\":\"Disabled\"},\"location\":\"dskwvb\",\"tags\":{\"nyotgnmze\":\"wwayqts\",\"yhheexz\":\"creluedcmk\",\"djklfsdntk\":\"hllxwknoo\"},\"id\":\"iymmddslwnlgj\",\"name\":\"lhmkspybnnn\",\"type\":\"pqdnn\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        FilesharesManager manager = FilesharesManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        AccessControlList response
            = manager.accessControlLists()
                .define("r")
                .withRegion("mwfwzlmpxfmdjsio")
                .withExistingResourceGroup("clpkr")
                .withProperties(new AccessControlListProperties().withAnnotation("mjjviut")
                    .withConfigurationType(ConfigurationType.FILE)
                    .withAclsUrl("fn")
                    .withDefaultAction(CommunityActionTypes.DENY)
                    .withMatchConfigurations(Arrays.asList(
                        new AccessControlListMatchConfiguration().withMatchConfigurationName("mgftjviiloh")
                            .withSequenceNumber(4948649589211237650L)
                            .withIpAddressType(IPAddressType.IPV6)
                            .withMatchConditions(Arrays.asList(new AccessControlListMatchCondition()))
                            .withActions(Arrays.asList(new AccessControlListAction())),
                        new AccessControlListMatchConfiguration().withMatchConfigurationName("nsjxwfogb")
                            .withSequenceNumber(6444949860271673704L)
                            .withIpAddressType(IPAddressType.IPV6)
                            .withMatchConditions(Arrays.asList(new AccessControlListMatchCondition(),
                                new AccessControlListMatchCondition(), new AccessControlListMatchCondition(),
                                new AccessControlListMatchCondition()))
                            .withActions(Arrays.asList(new AccessControlListAction())),
                        new AccessControlListMatchConfiguration().withMatchConfigurationName("rlnuom")
                            .withSequenceNumber(1382656018915000574L)
                            .withIpAddressType(IPAddressType.IPV4)
                            .withMatchConditions(Arrays.asList(new AccessControlListMatchCondition(),
                                new AccessControlListMatchCondition(), new AccessControlListMatchCondition(),
                                new AccessControlListMatchCondition()))
                            .withActions(Arrays.asList(new AccessControlListAction()))))
                    .withDynamicMatchConfigurations(Arrays.asList(new CommonDynamicMatchConfiguration()
                        .withIpGroups(Arrays.asList(new IpGroupProperties(), new IpGroupProperties(),
                            new IpGroupProperties(), new IpGroupProperties()))
                        .withVlanGroups(Arrays.asList(new VlanGroupProperties()))
                        .withPortGroups(Arrays.asList(new PortGroupProperties(), new PortGroupProperties(),
                            new PortGroupProperties()))))
                    .withAclType(AclType.TENANT)
                    .withDeviceRole(DeviceRole.TOR)
                    .withGlobalAccessControlListActions(
                        new GlobalAccessControlListActionProperties().withEnableCount(BooleanEnumProperty.FALSE)))
                .withTags(mapOf("r", "zphxul"))
                .create();

        Assertions.assertEquals("dskwvb", response.location());
        Assertions.assertEquals("wwayqts", response.tags().get("nyotgnmze"));
        Assertions.assertEquals("vz", response.properties().annotation());
        Assertions.assertEquals(ConfigurationType.FILE, response.properties().configurationType());
        Assertions.assertEquals("kfeomotquqlqeyis", response.properties().aclsUrl());
        Assertions.assertEquals(CommunityActionTypes.PERMIT, response.properties().defaultAction());
        Assertions.assertEquals("dpfvlsqmmetwtla",
            response.properties().matchConfigurations().get(0).matchConfigurationName());
        Assertions.assertEquals(8308518742671531249L,
            response.properties().matchConfigurations().get(0).sequenceNumber());
        Assertions.assertEquals(IPAddressType.IPV6, response.properties().matchConfigurations().get(0).ipAddressType());
        Assertions.assertEquals(AclType.CP, response.properties().aclType());
        Assertions.assertEquals(DeviceRole.NPB, response.properties().deviceRole());
        Assertions.assertEquals(BooleanEnumProperty.TRUE,
            response.properties().globalAccessControlListActions().enableCount());
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
