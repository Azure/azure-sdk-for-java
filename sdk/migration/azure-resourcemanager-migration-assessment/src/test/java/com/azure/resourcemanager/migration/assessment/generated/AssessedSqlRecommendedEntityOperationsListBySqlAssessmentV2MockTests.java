// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.migration.assessment.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.migration.assessment.MigrationAssessmentManager;
import com.azure.resourcemanager.migration.assessment.models.AssessedSqlRecommendedEntity;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class AssessedSqlRecommendedEntityOperationsListBySqlAssessmentV2MockTests {
    @Test
    public void testListBySqlAssessmentV2() throws Exception {
        String responseStr
            = "{\"value\":[{\"properties\":{\"machineName\":\"skbwgm\",\"instanceName\":\"rulcfogx\",\"productSupportStatus\":{\"currentVersion\":\"nwjtpf\",\"servicePackStatus\":\"xcouzfwofwak\",\"esuStatus\":\"zkdtzxsoed\",\"supportStatus\":\"wglihezomu\",\"eta\":1614778568,\"currentEsuYear\":\"isnionetbzdrdpue\",\"mainstreamEndDate\":\"2021-07-27T09:18:03Z\",\"extendedSupportEndDate\":\"2021-05-10T00:45:18Z\",\"extendedSecurityUpdateYear1EndDate\":\"2021-02-16T02:41:21Z\",\"extendedSecurityUpdateYear2EndDate\":\"2021-10-08T03:35:33Z\",\"extendedSecurityUpdateYear3EndDate\":\"2021-05-02T19:22:45Z\"},\"dbCount\":212272318,\"discoveredDBCount\":118271276,\"hasScanOccurred\":false,\"recommendedAzureSqlTargetType\":\"AzureVirtualMachine\",\"recommendedSuitability\":\"PotentiallySuitableForVM\",\"azureSqlMISuitabilityDetails\":{\"azureSqlSku\":{\"azureSqlServiceTier\":\"BusinessCritical\",\"azureSqlComputeTier\":\"Provisioned\",\"azureSqlHardwareGeneration\":\"Unknown\",\"storageMaxSizeInMB\":56.445385,\"predictedDataSizeInMB\":82.74375,\"predictedLogSizeInMB\":68.94291,\"cores\":926783353,\"azureSqlTargetType\":\"AzureSqlVirtualMachine\"},\"replicaAzureSqlSku\":[{\"azureSqlServiceTier\":\"GeneralPurpose\",\"azureSqlComputeTier\":\"Serverless\",\"azureSqlHardwareGeneration\":\"Gen5\",\"storageMaxSizeInMB\":96.515785,\"predictedDataSizeInMB\":95.57669,\"predictedLogSizeInMB\":2.9654562,\"cores\":1015199416,\"azureSqlTargetType\":\"Recommended\"},{\"azureSqlServiceTier\":\"Unknown\",\"azureSqlComputeTier\":\"Serverless\",\"azureSqlHardwareGeneration\":\"DC_series\",\"storageMaxSizeInMB\":28.742128,\"predictedDataSizeInMB\":89.02015,\"predictedLogSizeInMB\":35.792778,\"cores\":1889348759,\"azureSqlTargetType\":\"AzureSqlManagedInstance\"},{\"azureSqlServiceTier\":\"Automatic\",\"azureSqlComputeTier\":\"Provisioned\",\"azureSqlHardwareGeneration\":\"Unknown\",\"storageMaxSizeInMB\":36.13075,\"predictedDataSizeInMB\":58.18631,\"predictedLogSizeInMB\":76.93034,\"cores\":161019045,\"azureSqlTargetType\":\"Unknown\"},{\"azureSqlServiceTier\":\"GeneralPurpose\",\"azureSqlComputeTier\":\"Automatic\",\"azureSqlHardwareGeneration\":\"Fsv2_series\",\"storageMaxSizeInMB\":31.641466,\"predictedDataSizeInMB\":57.541405,\"predictedLogSizeInMB\":91.92485,\"cores\":1236323053,\"azureSqlTargetType\":\"AzureVirtualMachine\"}],\"sharedResources\":{\"sharedDataDisks\":[{}],\"sharedLogDisks\":[{},{}],\"sharedTempDbDisks\":[{},{}],\"numberOfMounts\":873252711,\"quorumWitness\":{\"quorumWitnessType\":\"Disk\"}},\"monthlyComputeCost\":54.43496,\"monthlyStorageCost\":95.73449,\"costComponents\":[{\"name\":\"MonthlyPremiumV2StorageCost\",\"value\":97.70187,\"description\":\"paydhfn\"}],\"securitySuitability\":\"ReadinessUnknown\",\"shouldProvisionReplicas\":true,\"skuReplicationMode\":\"NotApplicable\",\"migrationGuidelines\":[{\"guidelineId\":\"snyzmspam\",\"migrationGuidelineCategory\":\"General\",\"migrationGuidelineContext\":[{}]},{\"guidelineId\":\"lslcefiqdktwtkvi\",\"migrationGuidelineCategory\":\"General\",\"migrationGuidelineContext\":[{},{}]},{\"guidelineId\":\"woynguu\",\"migrationGuidelineCategory\":\"FailoverCluterInstanceGuideLine\",\"migrationGuidelineContext\":[{},{},{}]},{\"guidelineId\":\"dpcmhjh\",\"migrationGuidelineCategory\":\"FailoverCluterInstanceGuideLine\",\"migrationGuidelineContext\":[{}]}],\"recommendationReasonings\":[{\"reasoningId\":\"ym\",\"reasoningString\":\"ztsilscvq\",\"reasoningCategory\":\"eiihfymko\",\"contextParameters\":[{}]},{\"reasoningId\":\"eseuugci\",\"reasoningString\":\"hogsmgbvmtd\",\"reasoningCategory\":\"qbe\",\"contextParameters\":[{},{}]},{\"reasoningId\":\"veglabtvkbiwzn\",\"reasoningString\":\"fg\",\"reasoningCategory\":\"cud\",\"contextParameters\":[{},{}]},{\"reasoningId\":\"paczmuh\",\"reasoningString\":\"akznhokhoitwhr\",\"reasoningCategory\":\"dmmazdnc\",\"contextParameters\":[{}]}],\"migrationTargetPlatform\":\"AzureSqlManagedInstance\",\"suitability\":\"Unknown\",\"migrationIssues\":[{\"issueId\":\"qpx\",\"issueCategory\":\"Internal\",\"impactedObjects\":[{}]},{\"issueId\":\"kcdgfhbssd\",\"issueCategory\":\"Issue\",\"impactedObjects\":[{}]},{\"issueId\":\"xdede\",\"issueCategory\":\"Internal\",\"impactedObjects\":[{},{}]},{\"issueId\":\"gxsur\",\"issueCategory\":\"Issue\",\"impactedObjects\":[{}]}]},\"azureSqlDBSuitabilityDetails\":{\"azureSqlSku\":{\"azureSqlServiceTier\":\"HyperScale\",\"azureSqlComputeTier\":\"Unknown\",\"azureSqlHardwareGeneration\":\"Automatic\",\"storageMaxSizeInMB\":82.34454,\"predictedDataSizeInMB\":54.51052,\"predictedLogSizeInMB\":18.703657,\"cores\":753616806,\"azureSqlTargetType\":\"AzureSqlVirtualMachine\"},\"replicaAzureSqlSku\":[{\"azureSqlServiceTier\":\"Unknown\",\"azureSqlComputeTier\":\"Provisioned\",\"azureSqlHardwareGeneration\":\"Unknown\",\"storageMaxSizeInMB\":77.19659,\"predictedDataSizeInMB\":0.005275011,\"predictedLogSizeInMB\":1.6721785,\"cores\":1844678161,\"azureSqlTargetType\":\"AzureSqlVirtualMachine\"},{\"azureSqlServiceTier\":\"Automatic\",\"azureSqlComputeTier\":\"Automatic\",\"azureSqlHardwareGeneration\":\"Fsv2_series\",\"storageMaxSizeInMB\":80.447624,\"predictedDataSizeInMB\":10.910189,\"predictedLogSizeInMB\":37.55529,\"cores\":1473902358,\"azureSqlTargetType\":\"Unknown\"},{\"azureSqlServiceTier\":\"HyperScale\",\"azureSqlComputeTier\":\"Serverless\",\"azureSqlHardwareGeneration\":\"M_series\",\"storageMaxSizeInMB\":57.48646,\"predictedDataSizeInMB\":81.59941,\"predictedLogSizeInMB\":75.11977,\"cores\":1325876132,\"azureSqlTargetType\":\"AzureVirtualMachine\"}],\"sharedResources\":{\"sharedDataDisks\":[{},{},{}],\"sharedLogDisks\":[{}],\"sharedTempDbDisks\":[{},{},{}],\"numberOfMounts\":421840772,\"quorumWitness\":{\"quorumWitnessType\":\"Unknown\"}},\"monthlyComputeCost\":20.23537,\"monthlyStorageCost\":62.92355,\"costComponents\":[{\"name\":\"MonthlyAzureHybridCostSavings\",\"value\":96.248505,\"description\":\"kqlujqgira\"},{\"name\":\"MonthlyAzureHybridCostSavings\",\"value\":51.221985,\"description\":\"chpqvctsfaeuhww\"}],\"securitySuitability\":\"ConditionallySuitable\",\"shouldProvisionReplicas\":true,\"skuReplicationMode\":\"ActiveGeoReplication\",\"migrationGuidelines\":[{\"guidelineId\":\"asupmlppdpg\",\"migrationGuidelineCategory\":\"General\",\"migrationGuidelineContext\":[{},{}]},{\"guidelineId\":\"vbkarkptgon\",\"migrationGuidelineCategory\":\"AvailabilityGroupGuideline\",\"migrationGuidelineContext\":[{},{}]},{\"guidelineId\":\"yiysjqheni\",\"migrationGuidelineCategory\":\"Unknown\",\"migrationGuidelineContext\":[{}]},{\"guidelineId\":\"uba\",\"migrationGuidelineCategory\":\"FailoverCluterInstanceGuideLine\",\"migrationGuidelineContext\":[{},{}]}],\"recommendationReasonings\":[{\"reasoningId\":\"cseydz\",\"reasoningString\":\"mexmnvk\",\"reasoningCategory\":\"uwrxl\",\"contextParameters\":[{},{},{},{}]}],\"migrationTargetPlatform\":\"AzureSqlVirtualMachine\",\"suitability\":\"ReadinessUnknown\",\"migrationIssues\":[{\"issueId\":\"lhvdvmiphbeaeqj\",\"issueCategory\":\"Warning\",\"impactedObjects\":[{},{},{},{}]},{\"issueId\":\"lacro\",\"issueCategory\":\"Internal\",\"impactedObjects\":[{},{}]},{\"issueId\":\"erkeluxzsh\",\"issueCategory\":\"Warning\",\"impactedObjects\":[{},{}]},{\"issueId\":\"uzudlevzskejcg\",\"issueCategory\":\"Internal\",\"impactedObjects\":[{},{},{}]}]},\"azureSqlVMSuitabilityDetails\":{\"azureSqlSku\":{\"virtualMachineSize\":{\"azureVmFamily\":\"Ebsv5_series\",\"cores\":1663628881,\"azureSkuName\":\"Standard_M64ms_v2\",\"availableCores\":977354992,\"maxNetworkInterfaces\":30369579},\"dataDiskSizes\":[{},{},{},{}],\"logDiskSizes\":[{},{},{},{}],\"azureSqlTargetType\":\"Recommended\"},\"replicaAzureSqlSku\":[{\"virtualMachineSize\":{},\"dataDiskSizes\":[{},{},{}],\"logDiskSizes\":[{},{}],\"azureSqlTargetType\":\"AzureVirtualMachine\"}],\"sharedResources\":{\"sharedDataDisks\":[{},{}],\"sharedLogDisks\":[{}],\"sharedTempDbDisks\":[{},{},{}],\"numberOfMounts\":1723389232,\"quorumWitness\":{\"quorumWitnessType\":\"Disk\"}},\"monthlyComputeCost\":66.83869,\"monthlyStorageCost\":1.153487,\"costComponents\":[{\"name\":\"MonthlySecurityCost\",\"value\":36.31253,\"description\":\"aonzvaj\"},{\"name\":\"MonthlyPremiumV2StorageCost\",\"value\":39.682243,\"description\":\"demdidackzi\"},{\"name\":\"MonthlyPremiumV2StorageCost\",\"value\":92.795334,\"description\":\"damisvpztdi\"}],\"securitySuitability\":\"NotSuitable\",\"shouldProvisionReplicas\":true,\"skuReplicationMode\":\"FailoverGroupInstance\",\"migrationGuidelines\":[{\"guidelineId\":\"pjfojiunrls\",\"migrationGuidelineCategory\":\"FailoverCluterInstanceGuideLine\",\"migrationGuidelineContext\":[{}]}],\"recommendationReasonings\":[{\"reasoningId\":\"dtoiboancdrcoanv\",\"reasoningString\":\"ldxonckb\",\"reasoningCategory\":\"blfxlupibaqzi\",\"contextParameters\":[{},{}]}],\"migrationTargetPlatform\":\"AzureVirtualMachine\",\"suitability\":\"ConditionallySuitable\",\"migrationIssues\":[{\"issueId\":\"wwbogvgfklqiy\",\"issueCategory\":\"Internal\",\"impactedObjects\":[{}]},{\"issueId\":\"lsb\",\"issueCategory\":\"Internal\",\"impactedObjects\":[{},{},{},{}]}]},\"assessedSqlEntityArmId\":\"kzx\",\"isClustered\":false,\"isHighAvailabilityEnabled\":false,\"sqlEdition\":\"vlrdsmovpi\",\"sqlVersion\":\"ndnoxaxnrqaq\",\"sizingCriterion\":\"PerformanceBased\"},\"id\":\"dxolousdv\",\"name\":\"g\",\"type\":\"tqm\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        MigrationAssessmentManager manager = MigrationAssessmentManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        PagedIterable<AssessedSqlRecommendedEntity> response = manager.assessedSqlRecommendedEntityOperations()
            .listBySqlAssessmentV2("hqodv", "gcnbhcbmjk", "ti", "n", "ynts", 695243142, "mfmeftvhkmoo", 1369210689,
                com.azure.core.util.Context.NONE);

        Assertions.assertEquals("kzx", response.iterator().next().properties().assessedSqlEntityArmId());
    }
}
