// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.migration.assessment.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.http.rest.PagedIterable;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.migration.assessment.MigrationAssessmentManager;
import com.azure.resourcemanager.migration.assessment.models.AssessedSqlMachine;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class AssessedSqlMachinesOperationsListBySqlAssessmentV2MockTests {
    @Test
    public void testListBySqlAssessmentV2() throws Exception {
        String responseStr
            = "{\"value\":[{\"properties\":{\"biosGuid\":\"yotnplfacqo\",\"fqdn\":\"qrqxwetjt\",\"sqlInstances\":[{\"instanceId\":\"tfdoadtx\",\"instanceName\":\"ge\",\"sqlInstanceSdsArmId\":\"adkm\",\"sqlInstanceEntityId\":\"gssz\",\"sqlEdition\":\"ctkbbxuha\",\"sqlVersion\":\"sirncclabvoy\",\"isClustered\":false,\"isHighAvailabilityEnabled\":false,\"sqlFciState\":\"Active\"},{\"instanceId\":\"bmyqjog\",\"instanceName\":\"saidjan\",\"sqlInstanceSdsArmId\":\"movdxxurn\",\"sqlInstanceEntityId\":\"jmoilunwe\",\"sqlEdition\":\"deel\",\"sqlVersion\":\"lkyozdsfzj\",\"isClustered\":false,\"isHighAvailabilityEnabled\":false,\"sqlFciState\":\"Passive\"},{\"instanceId\":\"slejtvxj\",\"instanceName\":\"vgjbfio\",\"sqlInstanceSdsArmId\":\"njodfcbjqqwmtq\",\"sqlInstanceEntityId\":\"oxsazuxejgwe\",\"sqlEdition\":\"wnf\",\"sqlVersion\":\"zzaczsinqbdn\",\"isClustered\":false,\"isHighAvailabilityEnabled\":false,\"sqlFciState\":\"Passive\"},{\"instanceId\":\"vrmkjmyitrchwu\",\"instanceName\":\"xeeihtpmno\",\"sqlInstanceSdsArmId\":\"hqlfmsib\",\"sqlInstanceEntityId\":\"yrfgxkyd\",\"sqlEdition\":\"yp\",\"sqlVersion\":\"qvmtywhlakx\",\"isClustered\":true,\"isHighAvailabilityEnabled\":false,\"sqlFciState\":\"Passive\"}],\"suitabilityDetail\":\"CannotReportBandwidthCosts\",\"suitabilityExplanation\":\"InternalErrorOccurredDuringNetworkEvaluation\",\"recommendedVmSize\":\"Standard_E20_v5\",\"recommendedVmFamily\":\"GS_series\",\"productSupportStatus\":{\"currentVersion\":\"rzgeuqxbpiatw\",\"servicePackStatus\":\"ujegqdtadra\",\"esuStatus\":\"ddhjkr\",\"supportStatus\":\"izyh\",\"eta\":562700229,\"currentEsuYear\":\"nqskt\",\"mainstreamEndDate\":\"2021-08-10T15:27:16Z\",\"extendedSupportEndDate\":\"2021-09-08T02:54:35Z\",\"extendedSecurityUpdateYear1EndDate\":\"2021-04-24T12:20:45Z\",\"extendedSecurityUpdateYear2EndDate\":\"2021-09-18T07:56:18Z\",\"extendedSecurityUpdateYear3EndDate\":\"2021-05-03T05:55:58Z\"},\"recommendedVmSizeNumberOfCores\":1205167221,\"recommendedVmSizeMegabytesOfMemory\":15.604812,\"monthlyComputeCost\":40.004826,\"disks\":{\"uvbdujgcwxvec\":{\"suitability\":\"NotSuitable\",\"suitabilityExplanation\":\"NoDiskSizeFoundInSelectedLocation\",\"suitabilityDetail\":\"DiskGigabytesProvisionedOutOfRange\",\"recommendedDiskSize\":\"StandardSSD_E3\",\"recommendedDiskType\":\"Unknown\",\"recommendedDiskSizeGigabytes\":2134981177,\"recommendDiskThroughputInMbps\":19.407808,\"recommendedDiskIops\":75.00775,\"monthlyStorageCost\":97.72125,\"name\":\"klciichgjsysm\",\"displayName\":\"o\",\"gigabytesProvisioned\":99.37963,\"megabytesPerSecondOfRead\":1.3408244,\"megabytesPerSecondOfWrite\":87.72186,\"numberOfReadOperationsPerSecond\":17.827404,\"numberOfWriteOperationsPerSecond\":83.63925}},\"networkAdapters\":{\"wuntobuiz\":{\"suitability\":\"Suitable\",\"suitabilityDetail\":\"MegabytesOfDataRecievedOutOfRange\",\"suitabilityExplanation\":\"Unknown\",\"monthlyBandwidthCosts\":85.95127,\"netGigabytesTransmittedPerMonth\":72.71101,\"name\":\"bgiark\",\"displayName\":\"kpgdqxwabzrwiq\",\"macAddress\":\"ha\",\"ipAddresses\":[\"dosqkptjqg\",\"ifmmainwh\",\"d\"],\"megabytesPerSecondReceived\":56.87188,\"megabytesPerSecondTransmitted\":41.46951},\"ikyypz\":{\"suitability\":\"ConditionallySuitable\",\"suitabilityDetail\":\"MegabytesOfDataRecievedOutOfRange\",\"suitabilityExplanation\":\"InternalErrorOccurred\",\"monthlyBandwidthCosts\":63.58878,\"netGigabytesTransmittedPerMonth\":38.958977,\"name\":\"f\",\"displayName\":\"klblaxp\",\"macAddress\":\"jwdabalfd\",\"ipAddresses\":[\"lz\",\"ytlbtlqhopxouvm\"],\"megabytesPerSecondReceived\":82.69837,\"megabytesPerSecondTransmitted\":98.499886},\"cq\":{\"suitability\":\"ConditionallySuitable\",\"suitabilityDetail\":\"MegabytesOfDataTransmittedOutOfRange\",\"suitabilityExplanation\":\"Unknown\",\"monthlyBandwidthCosts\":87.71719,\"netGigabytesTransmittedPerMonth\":74.619354,\"name\":\"bpoks\",\"displayName\":\"nm\",\"macAddress\":\"gpterdiu\",\"ipAddresses\":[\"rkskwztsdetjy\"],\"megabytesPerSecondReceived\":86.00711,\"megabytesPerSecondTransmitted\":35.51214}},\"monthlyBandwidthCost\":86.84527,\"monthlyStorageCost\":12.033564,\"costComponents\":[{\"name\":\"MonthlyPremiumV2StorageCost\",\"value\":37.48664,\"description\":\"ybz\"},{\"name\":\"Unknown\",\"value\":55.582367,\"description\":\"ptvdxxheigm\"}],\"securitySuitability\":\"Unknown\",\"migrationGuidelines\":[{\"guidelineId\":\"hjhjvm\",\"migrationGuidelineCategory\":\"FailoverCluterInstanceGuideLine\",\"migrationGuidelineContext\":[{},{}]}],\"bootType\":\"Unknown\",\"operatingSystemType\":\"b\",\"operatingSystemName\":\"d\",\"operatingSystemVersion\":\"bgymqt\",\"operatingSystemArchitecture\":\"X64\",\"createdTimestamp\":\"2021-11-09T12:10:09Z\",\"updatedTimestamp\":\"2021-08-04T15:49:36Z\",\"displayName\":\"rjnbsconxavipne\",\"type\":\"SqlAssessedMachine\",\"description\":\"jizqfsg\",\"datacenterMachineArmId\":\"dxze\",\"datacenterManagementServerArmId\":\"q\",\"datacenterManagementServerName\":\"fb\",\"megabytesOfMemory\":12.2989235,\"numberOfCores\":206526961,\"confidenceRatingInPercentage\":41.858093,\"percentageCoresUtilization\":84.57474,\"percentageMemoryUtilization\":48.314285,\"suitability\":\"Unknown\",\"sizingCriterion\":\"PerformanceBased\"},\"id\":\"ypi\",\"name\":\"dbkp\",\"type\":\"jtaqhsmqazpdg\"}]}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        MigrationAssessmentManager manager = MigrationAssessmentManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        PagedIterable<AssessedSqlMachine> response = manager.assessedSqlMachinesOperations()
            .listBySqlAssessmentV2("wxqouoxudnmc", "aprhknqiijgencdg", "oqueqihkkyowltj", "uwhldxwhieproqks",
                "fxmcvprstvk", 1258845736, "b", 540536815, com.azure.core.util.Context.NONE);

        Assertions.assertEquals(37.48664F, response.iterator().next().properties().costComponents().get(0).value());
        Assertions.assertEquals("ybz", response.iterator().next().properties().costComponents().get(0).description());
    }
}
