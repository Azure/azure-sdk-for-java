variables:
  - group: KeyVault Test Secrets
  - name: ARM_CLIENTID
    value: $(java-keyvault-test-arm-client-id)
  - name: ARM_CLIENTKEY
    value: $(java-keyvault-test-arm-client-key)
  - name: AZURE_TEST_MODE
    value: RECORD
  - name: KEYVAULT_VAULTURI
    value: https://azure-keyvault-1.vault.azure.net
  - name: KEYVAULT_VAULTURI_ALT 
    value: https://azure-keyvault-2.vault.azure.net
    
queue:
  name: Hosted VS2017
steps:

- task: Maven@3
  displayName: 'Run Live Tests'
  inputs:
    mavenPomFile: $(pomFile)
    options: '--batch-mode'  #hides dependencies download progress from CI output
    mavenOptions: '-Xmx3072m -Dhttp.keepAlive=false -Dsurefire.rerunFailingTestsCount=3 -Dorg.slf4j.simpleLogger.defaultLogLevel=error -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=warn'
    javaHomeOption: 'JDKVersion'
    jdkVersionOption: '1.8'
    jdkArchitectureOption: 'x64'
    publishJUnitResults: true
    testResultsFiles: '**/TEST-*.xml'
    goals: 'test'


