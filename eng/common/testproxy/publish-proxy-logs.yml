parameters:
  rootFolder: '$(Build.SourcesDirectory)'

steps:
  - pwsh: |
      Get-ChildItem "${{ parameters.rootFolder }}" | % { $_.Name }
    displayName: Copy Log File
    condition: succeededOrFailed()

  - template: ../pipelines/templates/steps/publish-artifact.yml
    parameters:
      ArtifactName: "$(System.StageName)-$(System.JobName)-$(System.JobAttempt)-proxy-logs"
      ArtifactPath: "${{ parameters.rootFolder }}/proxylogs"

  - pwsh: |
      Remove-Item -Recurse -Force ${{ parameters.rootFolder }}/proxylogs
    displayName: Cleanup Copied Log File
    condition: succeededOrFailed()
