parameters:
- name: TestName
  type: string
  default: 'LiveTest'
- name: AdditionalPlatforms
  type: object
  default: {}
- name: Clouds
  type: string
  default: 'Public'
- name: SupportedClouds
  type: string
  default: 'Public'
- name: UnsupportedClouds
  type: string
  default: ''
- name: Artifacts
  type: object
  default: []
- name: AdditionalModules
  type: object
  default: []
- name: TestResultsFiles
  type: object
  default: ''
- name: DisableAzureResourceCreation
  type: boolean
  default: false
- name: PreSteps
  type: object
  default: []
- name: PostSteps
  type: object
  default: []
- name: EnvVars
  type: object
  default: {}
- name: MaxParallel
  type: number
  default: 0
- name: BuildInParallel
  type: boolean
  default: true
- name: TimeoutInMinutes
  type: number
  default: 60
- name: Location
  type: string
  default: ''
- name: ServiceDirectory
  type: string
  default: not-specified
- name: TestResourceDirectories
  type: object
  default:
- name: TestSetupSteps
  type: stepList
  default: []
- name: TestMode
  type: string
  default: 'LIVE'
- name: TestVersionSupport
  type: boolean
  default: false
- name: CloudConfig
  type: object
  default:
    Public:
      SubscriptionConfiguration: $(sub-config-azure-cloud-test-resources)
    Preview:
      SubscriptionConfiguration: $(sub-config-azure-cloud-test-resources-preview)
    Canary:
      SubscriptionConfiguration: $(sub-config-azure-cloud-test-resources)
      Location: 'centraluseuap'
    UsGov:
      SubscriptionConfiguration: $(sub-config-gov-test-resources)
    China:
      SubscriptionConfiguration: $(sub-config-cn-test-resources)
- name: MatrixConfigs
  type: object
  default:
    - Name: Java_live_test_base
      Path: eng/pipelines/templates/stages/platform-matrix.json
      Selection: sparse
      GenerateVMJobs: true
- name: AdditionalMatrixConfigs
  type: object
  default: []
- name: MatrixFilters
  type: object
  default: []
- name: MatrixReplace
  type: object
  default: []
- name: PlatformPreSteps
  type: object
  default: []
- name: PlatformPostSteps
  type: object
  default: []
- name: TestGoals
  type: string
  default: $(TestGoals)
- name: TestOptions
  type: string
  default: $(TestOptions)
- name: UseHttpFaultInjector
  type: boolean
  default: false

stages:
  - template: /eng/pipelines/stages/archetype-sdk-tests-isolated.yml@self
    parameters:
      TestName: ${{ parameters.TestName }}
      AdditionalPlatforms: ${{ parameters.AdditionalPlatforms }}
      Clouds: ${{ parameters.Clouds }}
      SupportedClouds: ${{ parameters.SupportedClouds }}
      UnsupportedClouds: ${{ parameters.UnsupportedClouds }}
      Artifacts:
        - ${{ each artifact in parameters.Artifacts }}:
          - ${{ artifact }}
      AdditionalModules:
        - ${{ each module in parameters.AdditionalModules }}:
          - ${{ module }}
      TestResultsFiles: ${{ parameters.TestResultsFiles }}
      DisableAzureResourceCreation: ${{ parameters.DisableAzureResourceCreation }}
      PreSteps:
        - ${{ parameters.PreSteps }}
      PostSteps:
        - ${{ parameters.PostSteps }}
      EnvVars:
        - ${{ parameters.EnvVars }}
      MaxParallel: ${{ parameters.MaxParallel }}
      BuildInParallel: ${{ parameters.BuildInParallel }}
      TimeoutInMinutes: ${{ parameters.TimeoutInMinutes }}
      Location: ${{ parameters.Location }}
      ServiceDirectory: ${{ parameters.ServiceDirectory }}
      TestResourceDirectories: ${{ parameters.TestResourceDirectories }}
      TestSetupSteps:
        - ${{ parameters.TestSetupSteps}}
      TestMode: ${{ parameters.TestMode }}
      TestVersionSupport: ${{ parameters.TestVersionSupport }}
      CloudConfig: ${{ parameters.CloudConfig }}
      MatrixConfigs:
        - ${{ each config in parameters.MatrixConfigs }}:
          - ${{ config }}
      AdditionalMatrixConfigs:
        - ${{ each config in parameters.AdditionalMatrixConfigs }}:
          - ${{ config }}
      MatrixFilters:
        - ${{ each config in parameters.MatrixFilters }}:
          - ${{ config }}
      MatrixReplace:
        - ${{ each config in parameters.MatrixReplace }}:
          - ${{ config }}
      PlatformPreSteps:
        - ${{ parameters.PlatformPreSteps }}
      PlatformPostSteps:
        - ${{ parameters.PlatformPostSteps }}
      TestGoals: ${{ parameters.TestGoals }}
      TestOptions: ${{ parameters.TestOptions }}
      UseHttpFaultInjector: ${{ parameters.UseHttpFaultInjector }}
