steps:
  - template: /eng/common/pipelines/templates/steps/publish-artifact.yml
    parameters:
      ArtifactPath: '$(System.DefaultWorkingDirectory)'
      ArtifactName: 'repository-$(System.JobName)'
      CustomCondition: or(eq(variables['CaptureRepositoryOnFailure'], 'true'), and(failed(), eq(variables['Build.Reason'],'Schedule')))

  - task: PowerShell@2
    displayName: Clean up maven local cache
    inputs:
      pwsh: true
      filePath: $(Build.SourcesDirectory)/eng/scripts/Remove-Azure-Artifacts-From-Cache.ps1
      arguments: >
        -MavenCacheFolder $(MAVEN_CACHE_FOLDER)
    continueOnError: true
