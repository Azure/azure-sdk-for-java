steps:
  - pwsh: |
      if (Test-Path -Path "$(Build.SourcesDirectory)/http-fault-injector.log") {
        Write-Host "##vso[task.setvariable variable=HAS_HTTP_FAULT_INJECTOR_LOGS]true"
      } else {
        Write-Host "##vso[task.setvariable variable=HAS_HTTP_FAULT_INJECTOR_LOGS]false"
      }
    displayName: 'Check if http-fault-injector log file exists'
    condition: failed()

  - pwsh: |
      Copy-Item -Path "$(Build.SourcesDirectory)/http-fault-injector.log" -Destination "$(Build.SourcesDirectory)/fault-$(System.JobName).log"
    condition: and(failed(), eq(variables['HAS_HTTP_FAULT_INJECTOR_LOGS'], 'true'))
