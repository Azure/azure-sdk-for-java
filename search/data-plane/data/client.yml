# External variables Settable at queue time:
# "pomFile" : "pom.client.xml".   This is the project object model file for Maven.

variables:
    LoggingOptions: '-Dorg.slf4j.simpleLogger.defaultLogLevel=warn -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=warn'

jobs:
- job: 'Package'

  pool:
      vmImage: 'ubuntu-16.04'

  strategy:
      matrix:
          Java 8:
              ArtifactName: 'packages'
              JavaVersion: '1.8'
  steps:
  - task: Maven@3
    displayName: 'Install code quality tools'
    inputs:
        mavenPomFile: './eng/code-quality-reports/pom.xml'
        goals: 'install'
        options: '-Dmaven.test.skip=true'
        publishJUnitResults: false
        javaHomeOption: 'JDKVersion'
        jdkVersionOption: $(JavaVersion)
        jdkArchitectureOption: 'x64'
        mavenVersionOption: 'Default'

  - task: Maven@3
    displayName: 'Install Azure Core'
    inputs:
        mavenPomFile: './sdk/core/azure-core/pom.xml'
        goals: 'install'
        options: '-Dmaven.test.skip=true -Dgpg.skip'
        publishJUnitResults: false
        javaHomeOption: 'JDKVersion'
        jdkVersionOption: $(JavaVersion)
        jdkArchitectureOption: 'x64'
        mavenVersionOption: 'Default'
        
  - task: Maven@3
    displayName: 'Package'
    inputs:
        mavenPomFile: ./search/data-plane/data/pom.xml
        goals: 'package'
        mavenOptions: '$(LoggingOptions)'
        javaHomeOption: 'JDKVersion'
        jdkVersionOption: $(JavaVersion)
        jdkArchitectureOption: 'x64'
        publishJUnitResults: false
